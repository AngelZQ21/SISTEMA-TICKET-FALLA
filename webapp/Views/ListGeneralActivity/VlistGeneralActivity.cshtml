<script src="~/Scripts/util/jsUtilCambioGuardia.js"></script>
@*<script src="~/Scripts/util/ColoresPersonalizados.js"></script>
    <script src="~/Scripts/plugin/dygraphs/dygraph-combined.min.js"></script>*@

<!--LIBRERIA PARA DATEPICKER-->
@*<link href="~/Content/plugin/datapicker/datepicker3.css" rel="stylesheet" />*@
<script src="~/Scripts/plugin/datapicker/bootstrap-datepicker.js"></script>
@*<script src="~/Scripts/plugin/bootstrap-duallistbox/jquery.bootstrap-duallistbox.min.js"></script>*@
<!--LIBRERIA PARA CARGA DE ARCHIVOS-->
<script src="~/Scripts/bootstrap-filestyle.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script type="text/javascript">
    function anular(e) {

        tecla = (document.all) ? e.keyCode : e.which;
        return (tecla != 13);
    }
</script>

<style>

    .panel-group {
        margin-bottom: 0;
    }

        .panel-group .panel {
            border-radius: 0;
            box-shadow: none;
        }

            .panel-group .panel .panel-heading {
                padding: 0;
            }

                .panel-group .panel .panel-heading h4 a {
                    background: #D7F2DF;
                    display: block;
                    font-size: 12px;
                    font-weight: bold;
                    padding: 15px;
                    text-decoration: none;
                    transition: 0.15s all ease-in-out;
                }

                    .panel-group .panel .panel-heading h4 a:hover, .panel-group .panel .panel-heading h4 a:not(.collapsed) {
                        background: #fff;
                        transition: 0.15s all ease-in-out;
                    }

                        .panel-group .panel .panel-heading h4 a:not(.collapsed) i:before {
                            content: "‾";
                        }

                    .panel-group .panel .panel-heading h4 a i {
                        color: #999;
                    }

            .panel-group .panel .panel-body {
                padding-top: 0;
            }

            .panel-group .panel .panel-heading + .panel-collapse > .list-group,
            .panel-group .panel .panel-heading + .panel-collapse > .panel-body {
                border-top: none;
            }

            .panel-group .panel + .panel {
                border-top: none;
                margin-top: 0;
            }


    .colorAzul {
        background-color: #C2E1F8 !important;
        font-weight: bold !important;
    }

    .colorVerde {
        background-color: #ced !important;
    }

    .colorRojo {
        background-color: #FE8475;
    }

    .colorAmarillo {
        background-color: #FFDF6A;
    }

    .swal2-popup {
        font-size: 1em !important;
    }

    .BtnDetalle:hover {
        box-shadow: 5px 5px 5px 1px rgba(0,0,0,0.6);
    }

    /* BUTTON 8 */

    #button-8 {
        /* background-color: #34495e;*/
        overflow: hidden;
        -webkit-transition: all 0.3s ease-in-out;
        -o-transition: all 0.3s ease-in-out;
        transition: all 0.3s ease-in-out;
        width: 120px;
        height: 50px;
        margin-left: 25px;
        margin-top: 15px;
        background: #fff;
        /*        color:#fff;*/
    }

    #button-8:hover {
        -webkit-box-shadow: 0px 0px 10px #34495e;
        box-shadow: 0px 0px 10px #34495e;
    }

    .custom-table {
        border-color: white !important;
    }

    .custom-table td, .custom-table th {
        background-color: #f2f2f2;
    }
</style>

<div id="content">

    <div class="well" style="padding:0px 30px 10px 30px; background-color:white;">
        <div class="row wrapper">
            <div style="width: 100%;
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            justify-content: space-between;
            text-align: center;
            align-items: center;
            ">
                @*<h2 title="Cambio del Responsable de Ticket"><i class="fa fa-table"></i> [Tabla General de Tickets]</h2>*@
                @*<button class="btn btn-primary" type="button" id="btnNuevoCambioDeGuardia" disabled title="Registrar nueva Acta de Reunión"><i class="fa fa-plus"></i> Nueva Acta de Reunión</button>*@
            </div>
        </div>

        <div class="row" style="margin-top: 10px;">
            <form id="FrmListaGeneralActividades" onsubmit="return false" onkeypress="return anular(event)">

                <div class="row" style="margin-top:5px">

                    <section class="col-xs-12 col-sm-12 col-md-5 col-lg-3">
                        <label style="color: #2F4050"><strong>Estado Ticket :</strong></label>
                        <div style="width: 100%;">
                            <input tabindex="7" type="radio" name="rdoRadioFilterStatusTicket" id="rdoPendiente" checked="checked">
                            <label style="color: #2F4050;"><strong>Pendiente </strong></label>
                            <input tabindex="7" type="radio" name="rdoRadioFilterStatusTicket" id="rdoCompletado" style="margin-left:30px">
                            <label style="color: #2F4050"><strong>Completado </strong></label>
                            <input tabindex="7" type="radio" name="rdoRadioFilterStatusTicket" id="rdoAmbos" style="margin-left:30px">
                            <label style="color: #2F4050"><strong>Ambos </strong></label>
                        </div>
                    </section>

                    <section class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                        <label style="color: #2F4050"><strong>Responsable : </strong></label>
                        <div class="form-group">
                            <select id="selectorResponsible" class="selectpicker" multiple data-selected-text-format="count > 3" data-live-search="true" data-width="100%" title="Selección múltiple" data-actions-box="true"></select>
                        </div>
                    </section>

                    <section class="col-xs-4 col-sm-4 col-md-1 col-lg-1">
                        <div style="margin-top:25px">
                            <button style="margin:0px;" tabindex="9" disabled class="btn btn-primary pull-right" type="submit" id="btnBuscar"><i class="fa fa-search"></i> Buscar</button>
                        </div>
                    </section>

                    @*<section class="col-xs-4 col-sm-4 col-md-1 col-lg-1" style="margin-left:0px; padding-left:0px; margin-right:0px; padding-right:0px;">
                        <div style="margin-top:25px">
                            <button class="btn btn-success pull-right" type="button" id="BtnExportarExcel" disabled title="Exportar listado a Excel"><i class="fa fa-file-excel-o"></i> Excel</button>
                        </div>
                    </section>*@
                </div>

            </form>
        </div>
    </div>

    <div id="widget-grid" class="Contenedor1">
        <div class="row">
            <article class="col-xs-12 ContenedoresReportes hidden">

                <div class="jarviswidget jarviswidget-color-blue" id="wid-id-rga1" data-widget-editbutton="false" data-widget-custombutton="false" style="border: 2px solid #2F4050">
                    <header>
                        <span class="widget-icon"> <i class="fa fa-list"></i> </span>
                        <h2>Listado de General Actividades</h2>
                    </header>
                    <div style="border:none;">
                        <div class="jarviswidget-editbox">
                            <!-- This area used as dropdown edit box -->
                        </div>
                        <div class="widget-body no-padding" id="ContenedorgrCreateTicket">
                            <div id="LstGeneralActivity" class="hidden"></div>
                            <div class="spiner-example" id="imgCargaLstGeneralActivity">
                                @Html.Partial("../MensajesParciales/_MensajeCargando")
                            </div>

                            <div class="hidden" id="msjErrorLstGeneralActivity" style="margin:30px;">
                                @Html.Partial("../MensajesParciales/_MensajeError")
                            </div>

                            <div class="hidden" id="msjVacioLstGeneralActivity" style="margin:30px;">
                                @Html.Partial("../MensajesParciales/_MensajeVacio")
                            </div>

                            <div class="hidden" id="msjErrorListarLstGeneralActivity" style="margin:30px;">
                                @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                            </div>
                            <div class="hidden" id="msjSuperaLimiteLstGeneralActivity" style="margin:30px;">
                                @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                            </div>
                        </div>
                    </div>
                </div>
            </article>

            <article class="col-xs-12 col-sm-12 col-md-6 col-lg-12  sortable-grid hidden">
                <div class="jarviswidget jarviswidget-color-white" id="wid-id-rga7" style="border: 2px solid #2F4050;">
                    <header>
                        <span class="widget-icon" style="width:50px;">
                            <img width="50" src="../Content/img/gifs/gif05.gif" />
                        </span>
                        <h2>Grafico de Tickets y Responsable<i class="icon-append fa fa-info-circle" style="color:blue; cursor:pointer; width:15px; height:15px;" id="btnInfoGrafico11"></i></h2>
                    </header>
                    <div style="border:none;  padding-bottom:10px;">

                        <div class="widget-body no-padding">

                            <div class="col-xs-12 clearfix no-padding">
                                @*<div class="chartWrapper">
                                    <div id="chartAreaWrapper" style="overflow: hidden; width: 100%;">*@
                                <div id="grGraficaTicketAndResponsible" class="hidden" style="width:100%;height:600px;"></div>
                                @*</div>
                                    </div>*@
                                <div class="spiner-example" id="imgCargaGraficaTicketAndResponsible">
                                    @Html.Partial("../MensajesParciales/_MensajeCargandoDashboard")
                                </div>
                                <div class="hidden" id="msjErrorGraficaTicketAndResponsible" style="margin: 30px;">
                                    @Html.Partial("../MensajesParciales/_MensajeError")
                                </div>
                                <div class="hidden" id="msjVacioGraficaTicketAndResponsible" style="margin: 30px;">
                                    @Html.Partial("../MensajesParciales/_MensajeVacio")
                                </div>
                                <div class="hidden" id="msjErrorListarGraficaTicketAndResponsible" style="margin: 30px;">
                                    @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                                </div>
                                <div class="hidden" id="msjSuperaLimiteGraficaTicketAndResponsible" style="margin:30px;">
                                    @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                                </div>
                            </div>
                        </div>
                        <div style="margin-left:5px; margin-right:5px; margin-bottom:30px; padding-bottom:15px; padding-top:5px;" id="ContenedorExGrafica1" class="hidden clearfix">
                            <button tabindex="9" class="btn btn-info pull-right" type="button" id="btnExGrafica1" name="btnExGrafica1"><i class="fa fa-file-pdf-o"></i> Exportar</button>
                        </div>
                    </div>
                </div>
            </article>

            <article class="col-xs-12 col-sm-12 col-md-6 col-lg-12  sortable-grid">
                <div class="well" style="padding:30px 30px 10px 30px; background-color:white;">
                    @*<div class="col-xs-12 clearfix no-padding">*@

                    <div id="ContainerticketAndResponsible" class="hidden"></div>

                    <div class="spiner-example" id="imgCargaContainerTicketAndResponsible">
                        @Html.Partial("../MensajesParciales/_MensajeCargandoDashboard")
                    </div>
                    <div class="hidden" id="msjErrorContainerTicketAndResponsible" style="margin: 30px;">
                        @Html.Partial("../MensajesParciales/_MensajeError")
                    </div>
                    <div class="hidden" id="msjVacioContainerTicketAndResponsible" style="margin: 30px;">
                        @Html.Partial("../MensajesParciales/_MensajeVacio")
                    </div>
                    <div class="hidden" id="msjErrorListarContainerTicketAndResponsible" style="margin: 30px;">
                        @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                    </div>
                    <div class="hidden" id="msjSuperaLimiteContainerTicketAndResponsible" style="margin:30px;">
                        @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                    </div>
                    @*</div>*@
                </div>
            </article>
        </div>
    </div>
</div>

<div id="ModalDayTicketNow" class="modal inmodal fade" tabindex="-1" role="dialog" aria-hidden="true" style="overflow-y:scroll;">
    <div class="modal-dialog" style="width:90%;">

        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title"><strong>¡Tickets del Dia de Hoy!</strong></h4>
            </div>
            <div class="modal-body clearfix" style="padding-left:10px; padding-right:10px;">

                <div id="widget-grid">
                    <div class="row">
                        <article class="col-xs-12 ContenedoresReportes">

                            <div class="jarviswidget jarviswidget-color-blue" data-widget-editbutton="false" data-widget-custombutton="false" style="border: 2px solid #2F4050">
                                <header>
                                    <span class="widget-icon"> <i class="fa fa-list"></i> </span>
                                    <h2>Listado de Tickets del Dia de hoy</h2>
                                </header>
                                <div style="border:none;">
                                    <div class="jarviswidget-editbox">
                                        <!-- This area used as dropdown edit box -->
                                    </div>
                                    <div class="widget-body no-padding" id="ContenedorgrCotizacion">
                                        <div id="LstTicketsDayOfNow" class="hidden"></div>
                                        <div class="spiner-example" id="imgCargaLstTicketsDayOfNow">
                                            @Html.Partial("../MensajesParciales/_MensajeCargando")
                                        </div>
                                        <div class="hidden" id="msjErrorLstTicketsDayOfNow" style="margin:30px;">
                                            @Html.Partial("../MensajesParciales/_MensajeError")
                                        </div>
                                        <div class="hidden" id="msjVacioLstTicketsDayOfNow" style="margin:30px;">
                                            @Html.Partial("../MensajesParciales/_MensajeVacio")
                                        </div>
                                        <div class="hidden" id="msjErrorListarLstTicketsDayOfNow" style="margin:30px;">
                                            @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                                        </div>
                                        <div class="hidden" id="msjSuperaLimiteLstTicketsDayOfNow" style="margin:30px;">
                                            @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="ModalTicketEdit" class="modal inmodal fade" tabindex="-1" role="dialog" aria-hidden="true" style="overflow-y:scroll;">

    <div class="modal-dialog" style="width:90%;">
        <div class="modal-content animated">
            <div class="modal-header col-xs-12 col-sm-12 col-md-3 col-lg-12">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">
                    <label><strong>Nro Ticket: <label id="lblModelTicketEditAlertas" style="color:red;font-weight:bold"> </label></strong></label>
                    <label style="float:right;margin-right:15px;font-weight:bold;color:red"> FECHA INICIO : <span id="lblFechaInicioAlertas">00/00/0000</span>  -- FECHA FIN : <span id="lblFechaFinAlertas">00/00/0000</span> </label>
                </h4>
            </div>
            <form id="FrmTicketCreado" onsubmit="return false">

                <div class="modal-body" style="overflow:auto;padding-top:5px">

                    <div class="content" style="padding:0px 30px 10px 40px">

                        <div class="row form-group">

                            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-6" style="float:left">
                                <div class="row">
                                    <h2 class="modal-title">
                                        <label style="color:dodgerblue;text-decoration-line: underline"><strong>Detalle de Ticket</strong></label>
                                        <button style="margin:3px;margin-right:50px" tabindex="9" title="Enviar Correo" class="btn btn-success pull-right" type="submit" id="btnInvitadosPanel"><i class="fa fa-share"></i> </button>
                                        <button style="margin:3px;margin-right:10px" tabindex="9" title="Adjuntar Archivo Ticket" class="btn btn-success pull-right hidden" type="submit" id="btnPanelArchivo"><i class="fa fa-file-archive-o"></i> </button>
                                    </h2>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Operación: </strong><span id="lblOperationTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Quien Llama: </strong><span id="lblWhoCallTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Razon: </strong><span id="lblReasonTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Quien Registra: </strong><span id="lblWhoRegisterTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Responsable: </strong><span id="lblResponsibleTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row" style="">
                                    <label style="color: #2F4050"><strong>Criticidad: </strong><span id="lblCritiziedTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row" style="">
                                    <label style="color: #2F4050"><strong>Fecha Inicio: </strong><span id="lblEndDateTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Locación: </strong><span id="lblLocationTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>
                                <div class="row">
                                    <label style="color: #2F4050"><strong>Titulo: </strong><span id="lblTitleTicket" style="font-family: 'Roboto', sans-serif;"> </span></label>
                                </div>


                                <div class="row">
                                    <div style="width: 90%; display:flex; flex-flow:row nowrap;">
                                        <textarea style="font-family: 'Roboto', sans-serif;min-width: 100%" class="form-control" id="lblDetallerTicket" name="lblDetallerTicket" disabled rows="3"></textarea>
                                    </div>
                                </div>

                            </div>

                            <div class="row col-xs-12 col-sm-12 col-md-3 col-lg-6">

                                <div class="row" style="margin-top:13px">
                                    <div style="display:flex; flex-flow:row nowrap;">
                                        <textarea style="min-width: 100%" class="form-control" id="txtDetalleActivity" name="txtDetalleActivity" disabled rows="13"></textarea>
                                    </div>
                                </div>
                                <div class="row" style="margin-top:5px">
                                    <div style="display:flex; flex-flow:row nowrap;">
                                        <textarea class="form-control" id="txtVitacoraTextSend" name="txtVitacoraTextSend" rows="3"></textarea>
                                        <button style="margin-top:0px;float:right;height:70px;width:80px" tabindex="9" class="btn btn-success" type="submit" id="btnSaveVitacora"><i class="fa fa-play" style="width:20px"></i></button>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <div class="row form-group">

                            <div class="row">
                                <h2 class="modal-title">
                                    <label style="color:dodgerblue;text-decoration-line: underline;margin-left:15px"><strong>Archivo de Ticket</strong></label>
                                </h2>
                            </div>

                            <section class="col col-xs-12 col-sm-6">
                                <label style="color: #2F4050"><strong>D. Adjunto (Doc. de 5MB): </strong></label>
                                <div class="form-group">
                                    <input style="width:100%;" class="filestyle" type="file" name="flArchivoSubirAdjuntoTicket2" id="flArchivoSubirAdjuntoTicket2"
                                           accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, image/jpeg, application/pdf, application/vnd.openxmlformats-officedocument.wordprocessingml.document, text/plain"
                                           data-buttontext="Examinar" data-buttonname="btn btn-primary">
                                </div>
                            </section>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-2" style="margin-top:25px">
                                <div style="width: 100%;display: flex;flex-flow: row nowrap;">
                                    <button style="margin-top:0px; width:100px" tabindex="9" class="btn btn-info" type="button" id="btnSubirFormatoTicket2"><i class="fa fa-cloud-upload"></i> Subir</button>
                                </div>
                            </section>

                            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-12" style="margin-top:10px">

                                <div id="widget-grid">
                                    <div class="row">
                                        <article class="col-xs-12 ContenedoresReportes">
                                            <div class="jarviswidget jarviswidget-color-blue" id="wid-id-rga1" data-widget-editbutton="false" data-widget-custombutton="false" style="border: 2px solid #2F4050">
                                                <header>
                                                    <span class="widget-icon"> <i class="fa fa-list"></i> </span>
                                                    <h2>Listado de Archivos en Ticket</h2>
                                                    @*<button class="btn btn-success pull-right" type="button" id="BtnExportarExcelActividades" disabled title="Exportar listado a Excel"><i class="fa fa-file-excel-o"></i> Excel</button>*@
                                                </header>
                                                <div style="border:none;">
                                                    <div class="jarviswidget-editbox">
                                                        <!-- This area used as dropdown edit box -->
                                                    </div>
                                                    <div class="widget-body no-padding" id="ContenedorgrPuntosATratarArchivos">
                                                        <div id="GrillaLstArchivoTicket" class="hidden"></div>
                                                        <div class="spiner-example" id="imgCargaLstArchivoTicket">
                                                            @Html.Partial("../MensajesParciales/_MensajeCargando")
                                                        </div>

                                                        <div class="hidden" id="msjErrorLstArchivoTicket" style="margin:30px;">
                                                            @Html.Partial("../MensajesParciales/_MensajeError")
                                                        </div>

                                                        <div class="hidden" id="msjVacioLstArchivoTicket" style="margin:30px;">
                                                            @Html.Partial("../MensajesParciales/_MensajeVacio")
                                                        </div>

                                                        <div class="hidden" id="msjErrorListarLstArchivoTicket" style="margin:30px;">
                                                            @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                                                        </div>
                                                        <div class="hidden" id="msjSuperaLimiteLstArchivoTicket" style="margin:30px;">
                                                            @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div style="padding: 0px 50px 10px 30px;">

                        <div class="row form-group">

                            <div class="row" style="margin-left:10px">
                                <h2 class="modal-title">
                                    <label style="color:dodgerblue;text-decoration-line:underline"><strong>Registro de Eventos : </strong></label><strong> 3Ws</strong>
                                </h2>
                            </div>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
                                <label style="color: #2F4050"><strong>Actividad : </strong><strong class="CampoRequerido">*</strong></label>
                                <div style="margin-top:3px">
                                    <textarea style="width:100%;display:flex; flex-flow:row nowrap;" class="form-control" id="txtActivityTicket" name="txtActivityTicket" rows="1"></textarea>
                                </div>
                            </section>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                                <label style="color: #2F4050"><strong>Responsable: </strong><strong class="CampoRequerido">*</strong></label>
                                <div style="width: 100%;margin-top:3px ;display:flex; flex-flow:row nowrap;">
                                    <select id="selectorResponsableActivity" class="selectpicker" multiple data-selected-text-format="count > 3" data-live-search="true" data-width="100%" title="Seleccionar Responsable" data-size="5" data-max-options="1" data-actions-box="false" data-style="btn-info">
                                    </select>
                                </div>
                            </section>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                                <label style="color: #2F4050"><strong>Fecha de Cierre: </strong><strong class="CampoRequerido">*</strong></label>
                                <div class="input-group date">
                                    @*<input type="text" class="form-control hasDatepicker" id="txtActivityDateEnd" name="txtActivityDateEnd" value="" data-dateformat="dd/mm/yy">*@
                                    <input type="text" tabindex="8" class="k-input" name="txtActivityDateEnd" id="txtActivityDateEnd" maxlength="19" style="width: 100%;" data-role="datetimepicker" role="combobox" aria-expanded="false" aria-disabled="false">
                                    @*<span class="input-group-addon"><i class="fa fa-calendar"></i></span>*@
                                </div>
                            </section>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-1" style="margin-top:23px">
                                <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                    <button style="margin:3px;" tabindex="9" class="btn btn-primary" type="submit" id="btnAgregarActivity"><i class="fa fa-plus"></i> Agregar</button>
                                    <button style="margin:3px;" tabindex="9" class="btn btn-primary hidden" type="submit" id="btnAgregarEditar"><i class="fa fa-edit"></i> Editar</button>
                                </div>
                            </section>

                        </div>

                    </div>

                    <hr />

                    <div class="content" style="padding:0px 30px 10px 30px;margin-top:20px">

                        <div id="widget-grid">
                            <div class="row">
                                <article class="col-xs-12 ContenedoresReportes">

                                    <div class="jarviswidget jarviswidget-color-blue" id="wid-id-rga1" data-widget-editbutton="false" data-widget-custombutton="false" style="border: 2px solid #2F4050">
                                        <header>
                                            <span class="widget-icon"> <i class="fa fa-list"></i> </span>
                                            <h2>Listado de Actividades Agregadas</h2>

                                            <button style="margin-left:10px" class="btn btn-success pull-right" type="button" id="BtnExportarExcelActividades" disabled title="Exportar listado a Excel"><i class="fa fa-file-excel-o"></i> Excel</button>
                                            @*<button tabindex="9" class="btn btn-primary pull-right" type="submit" id="btnAgregarActivity"><i class="fa fa-plus"></i> Agregar</button>*@
                                        </header>
                                        <div style="border:none;">
                                            <div class="jarviswidget-editbox">
                                                <!-- This area used as dropdown edit box -->
                                            </div>
                                            <div class="widget-body no-padding" id="ContenedorgrPuntosATratarArchivos">
                                                <div id="GrillaLstActivityAddAlertas" class="hidden"></div>
                                                <div class="spiner-example" id="imgCargaLstActivityAddAlertas">
                                                    @Html.Partial("../MensajesParciales/_MensajeCargando")
                                                </div>

                                                <div class="hidden" id="msjErrorLstActivityAddAlertas" style="margin:30px;">
                                                    @Html.Partial("../MensajesParciales/_MensajeError")
                                                </div>

                                                <div class="hidden" id="msjVacioLstActivityAddAlertas" style="margin:30px;">
                                                    @Html.Partial("../MensajesParciales/_MensajeVacio")
                                                </div>

                                                <div class="hidden" id="msjErrorListarLstActivityAddAlertas" style="margin:30px;">
                                                    @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                                                </div>
                                                <div class="hidden" id="msjSuperaLimiteLstActivityAddAlertas" style="margin:30px;">
                                                    @Html.Partial("../MensajesParciales/_MensajeLimiteGraficas")
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div style="margin-top:10px; display:flex; flex-direction:row; flex-wrap:wrap; justify-content:flex-start">
                        @Html.Partial("../MensajesParciales/_MensajeLeyendaCampoRequerido")
                    </div>

                    <button style="margin:3px;" tabindex="8" class="btn btn-danger" type="button" id="btnCerrarTicket"><i class="fa fa-times-circle"></i> Cerrar Ticket</button>
                    @*<button style="margin:3px;" tabindex="9" class="btn btn-primary" type="submit" id="btnGrabar"><i class="fa fa-save"></i> Grabar</button>*@
                    @*<button style="margin:3px;" tabindex="9" class="btn btn-success" type="button" id="BtnAbrirModalPDF" title="Exportar PDF Acta de Reunión"><i class="fa fa-file-pdf-o"></i> Imprimir PDF</button>*@
                </div>

            </form>

        </div>
    </div>
</div>

<div id="ModalInvitados" class="modal inmodal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="width:40%;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Reenviar Ticket</h4>
            </div>
            <div class="modal-body clearfix" style="padding-left:10px; padding-right:10px;">
                <form id="FrmAreaInvitadoTicket">

                    <section class="col-xs-12">
                        <label style="color: #2F4050"><strong>Invitados: </strong><strong class="CampoRequerido">*</strong></label>
                        <div class="form-group">
                            <select id="selectorInvitados2" class="selectpicker" multiple data-selected-text-format="count < 3" data-live-search="true" data-width="100%" data-size="5" title="Selección múltiple" data-actions-box="true"></select>
                        </div>
                    </section>

                    <section class="col-xs-12">
                        <label style="color: #2F4050"><strong>Comentario : </strong><strong class="CampoRequerido">*</strong></label>
                        <div class="form-group">
                            <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                <textarea style="font-family: 'Roboto', sans-serif;min-width: 100%" class="form-control" id="lblDetalleCorreo" name="lblDetalleCorreo" rows="4"></textarea>
                            </div>
                        </div>
                    </section>

                    <section class="col-xs-12" style="display:flex; flex-direction:row; flex-wrap:wrap; justify-content:space-between">
                        <div style="margin-top:10px; display:flex; flex-direction:row; flex-wrap:wrap; justify-content:flex-start">
                            @Html.Partial("../MensajesParciales/_MensajeLeyendaCampoRequerido")
                        </div>
                        <div style="margin-top:10px; display:flex; flex-direction:row; flex-wrap:wrap; justify-content:flex-end">
                            <button style="margin:3px;" tabindex="8" class="btn btn-danger" type="button" id="btnCancelarcorreoTicket"><i class="fa fa-times-circle"></i> Cancelar</button>
                            <button style="margin:3px;" tabindex="9" class="btn btn-primary" type="button" id="btnEnviarCorreoTicket"><i class="fa fa-save"></i> Enviar</button>
                        </div>
                    </section>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="ModalActivityDetail" class="modal inmodal fade" tabindex="-1" role="dialog" aria-hidden="true" style="overflow-y:scroll;">
    <div class="modal-dialog" style="width: 90%;">
        <div class="modal-content animated">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">
                    <label><strong>Nombre de Actividad: <span id="lblNameActivityText" style="color:#569fdb"></span></strong></label>
                </h4>
            </div>
            <div class="modal-body clearfix" style="padding-left:30px; padding-right:30px;">
                <form id="FrmActivityDetail" onsubmit="return false">

                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" style="float:right;margin-bottom:10px">

                        <div style="background-color: #e0e0e0;height:140px;margin-bottom:10px">

                            <h4 class="col-xs-12 col-sm-12 col-md-3 col-lg-6" style="margin-top:10px;margin-bottom:5px">
                                <label style="color:#999;text-decoration-line: underline"><strong>Porcentaje de Actividad :</strong></label>
                            </h4>

                            <section class="col-xs-12 col-sm-12 col-md-6 col-lg-4" style="margin-top:10px">
                                @*<label style="color: #2F4050">Porcentaje Avanzado:  <strong class="CampoRequerido"></strong></label>*@
                                <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                    <input type="text" tabindex="1" class="form-control" name="txtPorcentajeIngresado" id="txtPorcentajeIngresado" maxlength="25" style="padding-left:5px;" />
                                    @*<span class="input-group-addon"><i class="icon-prev fa fa-edit"></i></span>*@
                                    <button style="width:50px;" class="btn btn-primary" type="submit" id="btnRegisterPercentage"><i class="icon-append fa fa-save"></i></button>
                                </div>
                            </section>

                            <div class="progress col-xs-12 col-sm-12 col-md-3 col-lg-12" style="margin: 20px 20px 0px 0px">
                                <div class="progress-bar progress-bar-striped" id="IdBarPercentage" role="progressbar" style="background-color:#7bb4f1" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><span id="TxtValuePercentage">0%</span></div>
                            </div>
                        </div>


                        <div style="background-color: #f6f6f6;height:310px;margin:0px 0px 0px 0px;margin-bottom:10px">

                            <h4 class="col-xs-12 col-sm-12 col-md-3 col-lg-6" style="margin-top:10px">
                                <label style="color:#999;text-decoration-line: underline"><strong>Foro</strong></label>
                            </h4>

                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12">
                                <div class="" style="margin-top:13px;margin-left:0px">
                                    <div style="display:flex; flex-flow:row nowrap;">
                                        <textarea style="min-width: 100%;resize: none;" class="form-control" id="txtDetalleActivityDetail" name="txtDetalleActivityDetail" disabled rows="8"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12" style="margin-top:10px;margin-left:0px">
                                <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                    <textarea style="resize: none;" class="form-control" id="txtVitacoraTextSendActivityDetail" name="txtVitacoraTextSendActivityDetail" rows="2"></textarea>
                                    <button style="margin-top:0px;float:right;height:51px;margin-right:0px" tabindex="9" class="btn btn-success" type="submit" id="btnSaveVitacoraActivityDetail"><i class="fa fa-play" style="width:20px"></i></button>
                                </div>
                            </div>

                        </div>


                        <div style="background-color: #e0e0e0;height:100px;margin:0px 0px 0px 0px;margin-bottom:10px">

                            <h4 class="col-xs-12 col-sm-12 col-md-3 col-lg-6" style="margin-top:10px">
                                <label style="color:#999;text-decoration-line: underline"><strong>Adjutar Archivo</strong></label>
                            </h4>

                            <div class="row">

                                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-12" style="margin-top:10px;margin-left:14px">
                                    @*<label class="control-label"><strong>D. Adjunto - Documento <span><i>(Max 1 Doc. de 5MB) </i></span></strong><strong class="CampoRequerido">*</strong></label>*@
                                    <section class="col col-xs-12 col-sm-7 contenedorSubirArchivo">
                                        <div class="form-group">
                                            <input style="width:100%;" class="filestyle" type="file" name="flArchivoSubirAdjunto" id="flArchivoSubirAdjunto"
                                                   accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, image/jpeg, application/pdf, application/vnd.openxmlformats-officedocument.wordprocessingml.document, text/plain"
                                                   data-buttontext="Examinar" data-buttonname="btn btn-primary">
                                        </div>
                                    </section>

                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-2">
                                        <div style="width: 100%;display: flex;flex-flow: row nowrap;">
                                            <button style="margin-top:0px; width:100px" tabindex="9" class="btn btn-info" type="button" id="btnSubirFormato"><i class="fa fa-cloud-upload"></i> Subir</button>
                                        </div>
                                    </section>

                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">

                        <div style="padding:0px 20px 20px 0px">

                            <section class="col-xs-12">
                                <div style="width: 100%; display:flex; flex-flow:row nowrap;margin-top:0px">
                                    @*<label style="color: #2F4050;margin-top:5px;width:70px"><strong>Titulo Informe : </strong></label>*@
                                    <input type="text" tabindex="1" class="form-control" name="txtTitleInforme" id="txtTitleInforme" placeholder="Titulo de Informe" maxlength="500" style="padding-left:5px;font-size:20px;text-align:center" />
                                </div>
                            </section>

                            <div class="row">
                                <section class="col-xs-12">
                                    <div style="width: 100%; display:flex; flex-flow:row nowrap;margin-top:10px">
                                        <label style="color: #2F4050;margin-right:15px;margin-top:5px"><strong>De : </strong><span id="lblDeQuienFormato"></span></label>
                                        @*<textarea style="min-width: 100%" class="form-control" id="txtDeQuienFormato" name="txtDeQuienFormato" rows="2"></textarea>*@
                                        @*<input type="text" tabindex="1" class="form-control" name="txtDeQuienFormato" id="txtDeQuienFormato" maxlength="500" style="padding-left:5px;" />*@
                                    </div>
                                </section>

                                <section class="col-xs-12">
                                    <div style="width: 100%;margin-top:3px ;display:flex; flex-flow:row nowrap;margin-top:10px">
                                        <label style="color: #2F4050;margin-top:5px;width:50px"><strong>Para : </strong></label>
                                        @*<select id="txtParaQuienFormato" class="selectpicker" multiple data-selected-text-format="count > 3" data-live-search="true" data-width="100%" title="Seleccionar Destinatario" data-size="5" data-max-options="1" data-actions-box="false" data-style="btn-info"></select>*@
                                        <select id="txtParaQuienFormato" class="selectpicker" multiple data-selected-text-format="count < 3" data-live-search="true" data-width="100%" data-size="5" title="Selección múltiple" data-max-options="1" data-actions-box="true"></select>
                                    </div>
                                </section>

                                <section class="col-xs-12">
                                    <div style="width: 100%; display:flex; flex-flow:row nowrap;margin-top:20px">
                                        <label style="color: #2F4050;margin-top:5px;width:70px"><strong>Asunto : </strong></label>
                                        <input type="text" tabindex="1" class="form-control" name="txtAsuntoInforme" id="txtAsuntoInforme" maxlength="500" style="padding-left:5px;" />
                                    </div>
                                </section>

                                <section class="col-xs-12">
                                    <div style="width: 100%; display:flex; flex-flow:row nowrap;margin-top:10px">
                                        <label style="color: #2F4050;margin-right:15px;margin-top:5px"><strong>Operación : </strong><span id="lblOperacionFormato"></span></label>
                                    </div>
                                </section>

                                <section class="col-xs-12">
                                    <div class="input-group date" style="width: 100%; display:flex; flex-flow:row nowrap;margin-top:10px">
                                        <label style="color: #2F4050;margin-top:5px;width:70px"><strong>Fecha : </strong></label>
                                        <input type="text" class="form-control hasDatepicker" id="txtFechaActividad" name="txtFechaActividad" value="" data-dateformat="dd/mm/yy">
                                        @*<span class="input-group-addon"><i class="fa fa-calendar"></i></span>*@
                                    </div>
                                </section>

                            </div>

                            <div class="content" style="margin-top:20px;margin-bottom:50px">
                                <!--accordion 1 -- Documentos Generados en el Sistema del cliente -->
                                <div class="panel-group" id="accordionFacturacion1" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading" id="headingFacturacionOne" role="tab">
                                            <h4 class="panel-title"><a id="acordeonFacturación1" role="button" class="collapsed no-collapsable" data-toggle="collapse" data-parent="#accordionFacturacion1" href="#collapseFacturacionOne" aria-expanded="false" aria-controls="collapseFacturacionOne" style="font-size:22px;">Antecedentes<i class="pull-right fa fa-plus"></i></a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapseFacturacionOne" role="tabpanel" aria-labelledby="headingFacturacionOne">
                                            <div class="panel-body" id="divFacturacionArchivos">
                                                <div class="row form-group">

                                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-12 form-group">
                                                        <label style="color: #2F4050"><strong>Antecedentes: </strong></label>
                                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                                            <textarea style="min-width: 100%" class="form-control" id="txtAntecedentesActividad" name="txtAntecedentesActividad" rows="5"></textarea>
                                                        </div>
                                                    </section>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="panel-group" id="accordionFacturacion2" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading" id="headingFacturacionTwo" role="tab">
                                            <h4 class="panel-title"><a id="acordeonFacturacion2" class="collapsed no-collapsable" role="button" data-toggle="collapse" data-parent="#accordionFacturacion2" href="#collapseFacturacionTwo" aria-expanded="false" aria-controls="collapseFacturacionTwo" style="font-size:22px;">Desarrollo de Actividades<i class="pull-right fa fa-plus"></i></a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapseFacturacionTwo" role="tabpanel" aria-labelledby="headingFacturacionTwo">
                                            <div class="panel-body">
                                                <div class="row form-group">

                                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-12 form-group">
                                                        <label style="color: #2F4050"><strong>Desarrollo de Actividades: </strong></label>
                                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                                            <textarea style="min-width: 100%" class="form-control" id="txtActivityDevelop" name="txtActivityDevelop" rows="5"></textarea>
                                                        </div>
                                                    </section>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--accordion 2 -- Documentos Generados Por el Cliente-->
                                <div class="panel-group" id="accordionFacturacion3" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading" id="headingFacturacionThree" role="tab">
                                            <h4 class="panel-title"><a id="acordeonFacturacion3" class="collapsed no-collapsable" role="button" data-toggle="collapse" data-parent="#accordionFacturacion3" href="#collapseFacturacionThree" aria-expanded="false" aria-controls="collapseFacturacionThree" style="font-size:22px;">Conclusiones<i class="pull-right fa fa-plus"></i></a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapseFacturacionThree" role="tabpanel" aria-labelledby="headingFacturacionThree">
                                            <div class="panel-body">
                                                <div class="row form-group">

                                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-12 form-group">
                                                        <label style="color: #2F4050"><strong>Conclusiones: </strong></label>
                                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                                            <textarea style="min-width: 100%" class="form-control" id="txtConclusionesActividad" name="txtConclusionesActividad" rows="5"></textarea>
                                                        </div>
                                                    </section>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--accordion 2 -- Documentos Generados Por el Cliente-->
                                <div class="panel-group" id="accordionFacturacion4" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading" id="headingFacturacionFourth" role="tab">
                                            <h4 class="panel-title"><a id="acordeonFacturacion4" class="collapsed no-collapsable" role="button" data-toggle="collapse" data-parent="#accordionFacturacion4" href="#collapseFacturacionFourth" aria-expanded="false" aria-controls="collapseFacturacionFourth" style="font-size:22px;">Recomendaciones<i class="pull-right fa fa-plus"></i></a></h4>
                                        </div>
                                        <div class="panel-collapse collapse" id="collapseFacturacionFourth" role="tabpanel" aria-labelledby="headingFacturacionFourth">
                                            <div class="panel-body">
                                                <div class="row form-group">

                                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-12 form-group">
                                                        <label style="color: #2F4050"><strong>Recomendaciones: </strong></label>
                                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                                            <textarea style="min-width: 100%" class="form-control" id="txtRecomendacionesActividad" name="txtRecomendacionesActividad" rows="5"></textarea>
                                                        </div>
                                                    </section>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row pull-right">
                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-5 hidden" style="margin-top:18px">
                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                            <button style="margin:3px;" tabindex="9" class="btn btn-success" type="submit" id="btnPDFinforme"><i class="fa fa-file-pdf-o"></i> PDF</button>
                                        </div>
                                    </section>

                                    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-5" style="margin-top:18px">
                                        <div style="width: 100%; display:flex; flex-flow:row nowrap;">
                                            <button style="margin:3px;" tabindex="9" class="btn btn-primary" type="submit" id="btnSaveInforme"><i class="fa fa-save"></i> Guardar</button>
                                            <button style="margin:3px;" tabindex="9" class="btn btn-primary hidden" type="submit" id="btnEditarInforme"><i class="fa fa-upload"></i> Editar</button>
                                        </div>
                                    </section>

                                </div>

                            </div>
                        </div>

                    </div>


                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12" style="height:1px;background:#f6f6f6"></div>

                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12" style="padding:0px 0px 10px 12px;background:#f1f3f4;margin-top:30px">

                        <div class="row form-group">

                            <div class="row" style="margin-left:10px">

                                <h2 class="modal-title">
                                    <label style="color:dodgerblue;text-decoration-line:underline"><strong>Documentos Adjuntos : </strong></label>
                                </h2>

                                <section class="col col-xs-12 col-md-11">
                                    <div id="GrillaArchivos" class="hidden"></div>
                                    <section class="spiner-example" id="ImagenCargaListArchivo">
                                        @Html.Partial("../MensajesParciales/_MensajeCargando")
                                    </section>

                                    <section class="hidden" id="MensajeErrorListArchivo" style="margin:20px;">
                                        @Html.Partial("../MensajesParciales/_MensajeError")
                                    </section>

                                    <section class="hidden" id="MensajeVacioListArchivo" style="margin:20px;">
                                        @Html.Partial("../MensajesParciales/_MensajeVacio")
                                    </section>

                                    <section class="hidden" id="MensajeErrorListarListArchivo" style="margin:20px;">
                                        @Html.Partial("../MensajesParciales/_MensajeErrorListar")
                                    </section>

                                </section>

                            </div>
                        </div>
                    </div>


                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12" style="background:#c3c4c5;border-radius:1em;margin-bottom:30px;margin-top:40px">
                        <div class="row form-group" style="border: 80px;">

                            <div class="row" style="margin-left:10px">
                                <h2 class="modal-title">
                                    <label style="color:dodgerblue;text-decoration-line:underline"><strong>Validacion : </strong></label>

                                </h2>

                                <div class="row pull-right" style="margin:3px;margin-top:20px;margin-right:60px">
                                    <button style="margin:3px;" tabindex="9" disabled class="btn btn-primary" type="submit" id="btValidationResponsible"><i class="fa fa-save"></i> Grabar</button>
                                </div>

                                <div class="row pull-left">

                                    <div class="form-check" style="margin-left:20px;margin-top:10px">

                                        <label class="form-check-label" for="defaultCheck1">
                                            Validacion del Responsable del Ticket
                                        </label>
                                        <input class="form-check-input" disabled type="checkbox" value="" id="chkValidationResponsible" style="margin-left:10px">
                                        <br />
                                        <label class="form-check-label" for="defaultCheck2">
                                            Validacion del Jefe de Area
                                        </label>
                                        <input class="form-check-input" disabled type="checkbox" value="" id="chkValidationJefeArea" style="margin-left:75px">

                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                    @*<div class="modal-footer col-xs-12 col-sm-12 col-md-6 col-lg-12">
                            <div style="margin-top:10px; display:flex; flex-direction:row; flex-wrap:wrap; justify-content:flex-start">
                                @Html.Partial("../MensajesParciales/_MensajeLeyendaCampoRequerido")
                            </div>

                            <button style="margin:3px;" tabindex="8" class="btn btn-danger" type="button" id="btnCancelar"><i class="fa fa-times-circle"></i> Cancelar</button>
                            <button style="margin:3px;" tabindex="9" class="btn btn-primary" type="submit" id="btnGrabarActividad"><i class="fa fa-save"></i> Grabar</button>
                            <button style="margin:3px;border-radius:10px;width:130px;height:45px;font-size:18px" tabindex="9" disabled class="btn btn-danger" type="submit" id="btnFinalizar"><i class="fa fa-close"></i> Finalizar</button>
                            <button style="margin:3px;" tabindex="9" class="btn btn-success" type="button" id="BtnAbrirModalPDF" title="Exportar PDF Acta de Reunión"><i class="fa fa-file-pdf-o"></i> Imprimir PDF</button>
                        </div>*@
                </form>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).ready(function () {

        function ocultarMenu() {
            // $.root_.toggleClass("hidden-menu"); //OCULTA EL NAVIGATION DE MANERA TOTAL
            $.root_.toggleClass("minified"); // OCULTA EL NAVIGATION DE MANERA PARCIAL MOSTRANDO LOS ICONOS
        }

        var x = window.matchMedia("(min-width: 700px)");
        ocultarMenu();
        x.addListener(ocultarMenu);
    });
        /* ------------------- VALUES ----------------- */
    var StatusTicketRadio = 'P';
    var Valor = 1;
    var NroTicketActivity = 0;

    var SelectorInvitadosActividad = "";

    /* - VARIABLES - GRAFICO -*/

    var dataGroupGrafico;
    var resultadojson;
    var ImageURI = "";

    var pchartG;
    var widthG;
    var heightG = 300;
    var estadoCargarGrafico;
    var contadorGrafica = 0;
    var tamanoAnchoPantalla = 0;

    /* -- TABLAS - TICKET - REPONSABLE -- */

    let divContainerTicketAndResponsible;
    divContainerTicketAndResponsible = document.getElementById('ContainerticketAndResponsible');

    var usuarioRegistrador = "@User.Identity.Name.ToUpper().ToString()";
    usuarioRegistrador = usuarioRegistrador.split(',')[4];
    var UserResponsibleId = 0;

    var IdTicketLst = 0;
    var NroTicket = 0;
    var FechaRegistroTicket = "";
    var CallTicket = "";
    var RegisterTicket = "";
    var ResponsibleTicket = "";
    var OperacionTicket = "";
    var RazonTicket = "";
    var LocationTicket = "";
    var CriticidadTicket = "";
    var DetalleTicket = "";
    var IdActivityDetail = 0;
   

    var Valor = 1;
    var IdTicketSelect = "0";
    var IdCriticidadSelect = "0";
    var IdTicketDelete = 0;
    var NroTicketActivity = 0;
    var SelectorInvitadosActividad = "";
    var ValorFiltroGid = "0";

    let ImagenUser = "../Content/img/avatars/Icon-Person.png";
    let ImagenUser2 = "../Content/img/avatars/profile.png";
    let ImagenBotonDetalle = "../Content/img/Icon-Detalle.png";
    let ImagenBotonDetalle2 = "../Content/img/Icon-Detalle2.png";

    var idsPathFileTicketDocTicket = [];
    var idsPathFileTicketDoc = [];
    var arrayArchivosHistoricos = [];

    /* -------------------- FUNCIONES ---------------*/

    function FormatoFechas() {

            var FechaHoy = new Date();
            var FechaActual = new Date(FechaHoy.getFullYear(), FechaHoy.getMonth(), FechaHoy.getDate());

            $('#txtFechaInicioTicket').datepicker({
                keyboardNavigation: false,
                forceParse: false,
                autoclose: true,
                format: 'dd/mm/yyyy',
                endDate: FechaActual,
            });
            $('#txtFechaFinalTicket').datepicker({
                keyboardNavigation: false,
                forceParse: false,
                autoclose: true,
                format: 'dd/mm/yyyy',
                endDate: FechaActual,
            });

            $('#txtActivityDateEnd').kendoDateTimePicker({
                value: new Date(),
                dateInput: true,
                format: "dd/MM/yyyy HH:mm:ss",
                min: new Date(),
                //endDate: new Date(),
            });

            $("#txtFechaInicioTicket").datepicker("setDate", primerDiaMes);
            $("#txtFechaFinalTicket").datepicker("setDate", FechaFinalReporte);
            //$("#txtCambioDeGuardiaFecha").datepicker("setDate", FechaFinalReporte);
            //$("#txtActivityDateEnd").datepicker("setDate", FechaFinalReporte);
            /*ComboTicket();*/      
    }

    function LimpiarEtiquetas() {

        /*------------------------------- TB_ACTIVITY ----------------------------------*/

        $("#selectorResponsableActivity").selectpicker('val', "");
        document.getElementById('selectorResponsableActivity').disabled = false;
        $("#selectorResponsableActivity").selectpicker('refresh');

        document.getElementById("txtActivityTicket").value = "";

        /*----------*/
        EstadoArchivo = "0";

        $("#flArchivoSubirAdjunto").filestyle('clear');
        $("#flArchivoSubirAdjuntoTicket").filestyle('clear');

        document.getElementById('btnSubirFormatoTicket').disabled = false;
        document.getElementById('flArchivoSubirAdjuntoTicket').disabled = false;

        $("#txtCommentaryActivity").val("");

        idsPathFileTicketDoc = [];
        arrayArchivosHistoricos = [];

        $("#ImagenCargaListArchivo").addClass("hidden");
        $("#GrillaArchivos").addClass("hidden");
        $("#MensajeErrorListArchivo").addClass("hidden");
        $("#MensajeErrorListarListArchivo").addClass("hidden");
        $("#MensajeVacioListArchivo").removeClass("hidden");

    }

    function ComboTicket() {
            $.ajax({
                type: "GET", /*Puede ser post*/
                url: tRutaServidor + "/Ticket/ListarTicketCombo", /* es importante poner los .. delante*/
                contentType: "application/json; charset=utf-8",
                //data: "yearMonthNumber=" + yearMonthIds1,
                dataType: "json",
                success: function (resultado) {

                    var opcionesTicket = "";

                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/

                        if (resultado[0].ValorConsulta == "1") {

                            /**Llenar el combo con todo las compañías**/
                            for (i = 0; i < resultado.length; i++) {

                                opcionesTicket += "<option value='" + resultado[i].IdTicket + "'>" + resultado[i].NroTicket + "</option>";
                            }

                            $("#selectorTicket").empty();
                            $("#selectorTicket").append(opcionesTicket);
                            $("#selectorTicket").selectpicker('refresh');

                        }
                        else {
                            /*Error al listar*/

                        }

                    } else {
                        /*Vacio*/
                        $("#selectorTicket").empty();

                    }

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*Fallo al llamar funcion ajax*/

                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function ComboResponsable() {

        $.ajax({
            type: "GET", /*Puede ser post*/
            url: tRutaServidor + "/Person/ListarPersonaTicket", /* es importante poner los .. delante*/
            contentType: "application/json; charset=utf-8",
            data:
                "IdOperation=" + 0,
            dataType: "json",
            success: function (resultado) {

                var opcionesResponsible = "";

                /*exitosamente*/
                if (resultado.length > 0) {
                    /* proceso exitoso con datos*/

                    if (resultado[0].ValorConsulta == "1") {

                        /**Llenar el combo con todo las compañías**/
                        for (i = 0; i < resultado.length; i++) {

                            opcionesResponsible += "<option value='" + resultado[i].IdPerson + "'>" + resultado[i].FullNameOperation + "</option>";
                        }


                        $("#selectorResponsible").empty();
                        $("#selectorResponsible").append(opcionesResponsible);
                        $("#selectorResponsible").selectpicker('refresh');

                    }
                    else {
                        /*Error al listar*/

                    }

                } else {

                }

            },
            error: function (xhr, ajaxOptions, thrownError) {
                /*Fallo al llamar funcion ajax*/

                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });
    }

    function GrillaListado() {

            //var IdTicket = "0";

            //if ($("#selectorTicket").val() == "" || $("#selectorTicket").val() == null) {

            //    IdTicket = "0";

            //} else {

            //    IdTicket = $("#selectorTicket").val().toString();

            //}

            var dataSource = new kendo.data.DataSource({
                transport: {
                    read: function (options) {
                        $.ajax({
                            type: "GET",
                            url: tRutaServidor + "/ListGeneralActivity/ListarGeneralActivity", /* es importante poner los .. delante*/
                            //data: {
                            //    StartDate: $("#txtFechaInicioTicket").val(),
                            //    EndDate: $("#txtFechaFinalTicket").val(),
                            //    IdsTicket: IdTicket,
                            //},
                            dataType: "json",
                            /*async: false,*/
                            success: function (resultado) {
                                /*exitosamente*/
                                if (resultado.length > 0) {
                                    /* proceso exitoso con datos*/
                                    if (resultado[0].ValorConsulta == "1") {

                                        $("#LstGeneralActivity").removeClass("hidden");
                                        $("#imgCargaLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorLstGeneralActivity").addClass("hidden");
                                        $("#msjVacioLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorListarLstGeneralActivity").addClass("hidden");
                                        $("#msjSuperaLimiteLstGeneralActivity").addClass("hidden");

                                        $("#btnBuscar").prop('disabled', false);
                                        $("#BtnExportarExcel").prop('disabled', false);

                                    } else if (resultado[0].ValorConsulta == "-1") {

                                        $("#LstGeneralActivity").addClass("hidden");
                                        $("#imgCargaLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorLstGeneralActivity").addClass("hidden");
                                        $("#msjVacioLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorListarLstGeneralActivity").addClass("hidden");
                                        $("#msjSuperaLimiteLstGeneralActivity").removeClass("hidden");

                                        $("#btnBuscar").prop('disabled', false);
                                        $("#BtnExportarExcel").prop('disabled', true);
                                    }
                                    else {
                                        /* proceso fallido catch listado datos*/
                                        $("#LstGeneralActivity").addClass("hidden");
                                        $("#imgCargaLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorLstGeneralActivity").addClass("hidden");
                                        $("#msjVacioLstGeneralActivity").addClass("hidden");
                                        $("#msjErrorListarLstGeneralActivity").removeClass("hidden");
                                        $("#msjSuperaLimiteLstGeneralActivity").addClass("hidden");

                                        $("#btnBuscar").prop('disabled', true);
                                        $("#BtnExportarExcel").prop('disabled', true);
                                        console.log(resultado);
                                    }

                                } else {
                                    $("#LstGeneralActivity").addClass("hidden");
                                    $("#imgCargaLstGeneralActivity").addClass("hidden");
                                    $("#msjErrorLstGeneralActivity").addClass("hidden");
                                    $("#msjVacioLstGeneralActivity").removeClass("hidden");
                                    $("#msjErrorListarLstGeneralActivity").addClass("hidden");
                                    $("#msjSuperaLimiteLstGeneralActivity").addClass("hidden");

                                    $("#btnBuscar").prop('disabled', false);
                                    $("#BtnExportarExcel").prop('disabled', true);
                                }

                                options.success(resultado);
                                var grid = $("#LstGeneralActivity").data("kendoGrid");
                                if (grid.dataSource.total() > 0) {
                                    grid.setDataSource(dataSource);
                                }

                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                /*fallo al llamar a la funcion ajax*/
                                $("#LstGeneralActivity").addClass("hidden");
                                $("#imgCargaLstGeneralActivity").addClass("hidden");
                                $("#msjErrorLstGeneralActivity").removeClass("hidden");
                                $("#msjVacioLstGeneralActivity").addClass("hidden");
                                $("#msjErrorListarLstGeneralActivity").addClass("hidden");
                                $("#msjSuperaLimiteLstGeneralActivity").addClass("hidden");

                                $("#btnBuscar").prop('disabled', true);
                                $("#BtnExportarExcel").prop('disabled', true);
                                console.log("ERROR AJAX : " + ajaxOptions);
                                console.log("ERROR AJAX : " + thrownError);
                                console.log(xhr.responseText);
                                console.log(xhr);

                            }
                        });
                    },
                    parameterMap: function (data, operation) {
                        if (operation !== "read" && data.models) {
                            return JSON.stringify({ JSONparam: data.models });
                        }
                    }
                },
                error: function (e) {
                    alert("Status: " + e.status + "; Error message: " + e.errorThrown);
                },
                batch: false,
                pageSize: PaginationKendoGrid,
                schema: {
                    model: {
                        fields: {
                            NroTicket: { type: "string" },
                            StartDate: { type: "string" },
                            UsuarioNameTicket: { type: "string" },
                            ResponsibleNameTicket: { type: "string" },
                            FullNameTicket: { type: "string" },
                            OperationName: { type: "string" },
                            ReasonName: { type: "string" },
                            LocationNameTicket: { type: "string" },
                            CriticalityName: { type: "string" },
                            TitleDescription: { type: "string" },
                            DetalleText: { type: "string" },
                            ResponsibleId: { type: "number" },
                            MigrationStatus: { type: "string" },
                            StatusTicket: { type: "string" },
                            /*--------------*/
                            IdActivity: { type: "number" },
                            //NroTicket: { type: "string" },
                            //TitleDescription: { type: "string" },
                            ActivityText: { type: "string" },
                            FullNameActivity: { type: "string" },
                            DescripcionActivity: { type: "string" },
                            FechaCierre: { type: "string" },
                            Estado: { type: "string" },
                            OperationName: { type: "string" },
                            ResponsibleId: { type: "number" },
                            ValidationButton: { type: "string" },
                            PercentageNumber: { type: "string" },

                        }
                    }
                },
                //aggregate: [
                //    {
                //        field: "TicketNumber",
                //        aggregate: "count"
                //    },
                //    {
                //        field: "FuelQuantity",
                //        aggregate: "sum"
                //    }
                //]
                group: {
                    field: "NroTicket",
                }
            });

            $("#LstGeneralActivity").kendoGrid({
                dataSource: dataSource,
                sortable: true,
                pageable: true,
                columnMenu: true,
                columnMenu: {
                    sortable: true,
                    filterable: true,
                    columns: true,
                    messages: {
                        columns: KendoMsjColumnMenuColumns,
                        filter: KendoMsjColumnMenuFilter,
                        sortAscending: KendoMsjColumnMenuSortAscending,
                        sortDescending: KendoMsjColumnMenuSortDescending,
                        settings: KendoMsjSettings
                    }
                },
                columnMenuInit: function (e) {
                    var menu = e.container.find(".k-menu").data("kendoMenu");
                    menu.bind("select", function (e) {
                        var EtiquetaInput = $(".k-animation-container > .k-menu-group > .k-item > .k-content > .k-filter-menu > .k-textbox :input");
                        EtiquetaInput.focus();
                    });
                },
                groupable: true,
                reorderable: true,
                selectable: "row",
                scrollable: true,
                resizable: true,
                filterable: {
                    multi: true,
                    checkAll: true,
                    search: true,
                    messages: {
                        clear: KendoMsjClear,
                        filter: KendoMsjFilter,
                        selectedItemsFormat: KendoMsjSelectedItemsFormat,
                        checkAll: KendoMsjCheckAll,
                        search: KendoMsjSearch
                    }
                },
                groupable: {
                    messages: {
                        empty: "<b style='font-style:italic';>Arrastre una cabecera aquí para agrupar su información por esa columna</b>"
                    },

                },
                pageable: {
                    messages: {
                        empty: KendoMsjEmpty,
                        page: kendoMsjPage,
                        of: KendoMsjOf,
                        itemsPerPage: KendoMsjItemsPerPage,
                        first: KendoMsjFirst,
                        last: KendoMsjLast,
                        next: KendoMsjNext,
                        previous: KendoMsjPrevious,
                        refresh: KendoMsjRefresh,
                        morePages: KendoMsjMorePages,
                        display: KendoMsjDisplay
                    },
                    refresh: false,
                    pageSizes: true,
                    pageSizes: [5, 10, 15],
                    /*para la cantidad de paginas se sugieren 5*/
                    buttonCount: 5,
                    /*Posicion de la pagina*/
                    pageSize: 5
                },
                excel: { fileName: "Listado General de Actividades.xlsx", filterable: true, allPages: true },
                columns: [
                    {
                        width: 70,
                        command: {
                            template:
                                "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>"
                            //+ " " + "<button class='btn-grid btn-xs BtnAnular' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-ban'></i></button>"
                        },
                        attributes: { "class": "text-center" },
                        title: ""
                    },
                    { field: "NroTicket", title: "Nro. Ticket", width: 100,  attributes: { "class": "text-center" } },
                    { field: "StatusTicket", title: "Tipo Evento", width: 100, attributes: { "class": "text-center" } },
                    { field: "TitleDescription", title: "Titulo Detalle", width: 120, attributes: { "class": "text-center" } },
                    /**/
                    { field: "ActivityText", title: "Nombre Actividad", width: 150, attributes: { "class": "text-center" } },
                    { field: "FullNameActivity", title: "Responsable Actividad", width: 150, attributes: { "class": "text-center" } },
                    { field: "FechaCierre", title: "Fecha Cierre", width: 150, attributes: { "class": "text-center" } },
                    { field: "Estado", title: "Estado Actividad", width: 120, attributes: { "class": "text-center" } },
                    { field: "PercentageNumber", title: "Porcentaje Avance", width: 120, attributes: { "class": "text-center" } }
                ],
                dataBound: function () {

                    //var Grilla = this;

                    //for (i = 0; i < Grilla.dataSource._view.length; i++) {
                    //    var estadoActual = Grilla.tbody.children()[i].children[7].textContent;
                    //    if (estadoActual == 'COMPLETADO') {
                    //        $($("#LstGeneralActivity").data("kendoGrid").tbody.children()[i]).addClass('colorVerde');
                    //    }
                    //    else if (estadoActual == 'PENDIENTE') {
                    //        $($("#LstGeneralActivity").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                    //    }
                    //    else {
                    //        $($("#LstGeneralActivity").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                    //    }
                    //}

                }
            });


        }

    function ExportarExcel(Etiqueta) {
            var Grilla = $("#" + Etiqueta).data("kendoGrid");
            var count = Grilla.dataSource.total();

            if (count > CantidadRegistrosExportar) {

                new swal({
                    title: tTituloConfirmacionExportarExcel,
                    text: tMensajeConfirmacionExportarExcel,
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: tColorBoton,
                    confirmButtonText: tNombreBotonSi,
                    cancelButtonText: tNombreBotonNo,
                    closeOnConfirm: true
                }, function () {

                    setTimeout(function () {
                        swal({
                            title: tTituloExportarExcel,
                            text: tMensajeExportarExcel,
                            type: "warning"
                        });
                    }, 500);

                    setTimeout(function () {
                        Grilla.saveAsExcel();
                    }, 2000)

                });

            } else {
                new swal({
                    title: tTituloExportarExcel,
                    text: tMensajeExportarExcel,
                    type: "warning"
                });

                setTimeout(function () {

                    Grilla.saveAsExcel();
                }, 2000)
            }
        };

    function ActualizarRegistrarVitacora() {

            $("#CargaTemporal").removeClass("hidden");

            $.ajax({
                type: "POST",
                url: tRutaServidor + "/Activity/ActualizarRegistrarVitacora",
                dataType: "json",
                data: {
                    NroTicket: NroTicketActivity,
                    DescriptionBoard: $("#txtVitacoraTextSend").val(),
                },
                success: function (resultado) {

                    if (resultado.length > 0) {

                        if (resultado[0].ValorConsulta == "1") {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                            var ValorContenidoVitacora = "";

                            //var TxtDescriptionVitacora;
                            //TxtDescriptionVitacora = document.getElementById("txtDetalleActivity");
                            //TxtDescriptionVitacora.innerHTML = resultado;
                            for (i = 0; i < resultado.length; i++) {

                                ValorContenidoVitacora += "---- " + resultado[i].RegistrationDateString + " -- " + resultado[i].NameUser + " ----" + '\r\n' + resultado[i].DescriptionBoard + '\r\n' + '\r\n';

                            }

                            document.getElementById('txtDetalleActivity').value = ValorContenidoVitacora;
                            document.getElementById('txtVitacoraTextSend').value = "";
                            //document.getElementById('txtDetalleActivity').value = resultado;

                            //LimpiarEtiquetas();

                            $("#CargaTemporal").addClass("hidden");
                            //GrillaListadoActividad();

                        } else if (resultado == '2') {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["success"]("Hubo un error al mostrar la Vitacora", tTituloExito); $toastlast = $toast;
                            return;
                        }

                    } else {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"]("Hubo un error al generar la Vitacora", tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado);
                    }

                    $("#CargaTemporal").addClass("hidden");

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    toastr.options.timeOut = nTiempoLargo;
                    toastr.options.extendedTimeOut = nTiempoLargo;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        };

    function ReenviarDescripcionTicket() {

            $("#CargaTemporal").removeClass("hidden");

            $.ajax({
                type: "POST",
                url: tRutaServidor + "/Ticket/ReenviarTicket",
                //contentType: "application/json; charset=utf-8",
                //dataType: "json",
                data: {
                    //bE_Vehicle_Type: {
                    //    IdVehicleType : ListadoActividadesGenerales,
                    //},
                    NroTicket: NroTicket,
                    //OperationName: OperacionTicket,
                    //FullNameTicket: CallTicket,
                    //WhoRegister: RegisterTicket,
                    //ResponsibleNameTicket: ResponsibleTicket,
                    //ReasonName: RazonTicket,
                    //LocationNameTicket: LocationTicket,
                    //CriticalityName: CriticidadTicket,
                    //StartDate: FechaRegistroTicket,
                    InvitadoTicket: SelectorInvitadosActividad,
                    ArrayListadoActividades: ListadoActividadesGenerales,
                    DetalleCorreo: $("#lblDetalleCorreo").val().trim(),
                },
                success: function (resultado) {
                    //console.log(resultado);
                    //if (resultado.length > 0) {

                    if (resultado == "1") {

                        //if (resultado[0].CriticalityName == 'ALTA') {

                        //    GrillaListadoAltaTicket();

                        //} else if (resultado[0].CriticalityName == 'MEDIA') {

                        //    GrillaListadoMediaTicket();

                        //} else {

                        //    GrillaListadoBajaTicket();
                        //}

                        //ComboTicket();
                        //GrillaListadoBusqueda();

                        //toastr.options.timeOut = nTiempoMedio;
                        //toastr.options.extendedTimeOut = nTiempoMedio;
                        ///*success - info - warning - error*/
                        //var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                        //$("#CargaTemporal").addClass("hidden");
                        //ComboEncargado('1');
                        //$("#PanelActivityFather").removeClass("hidden");
                        $('#ModalInvitados').modal('hide');

                        Swal.fire({
                            title: '<strong>Nro Ticket:<span style="color:red"> ' + NroTicket + '</span></strong>',
                            icon: 'info',
                            html:
                                '<div style="text-align:left;font-size:18px;margin-left:50px">' +
                                '<b>Operacion :</b> ' + OperacionTicket + '</br>' +
                                '<b>Quien Llama :</b> ' + CallTicket + '</br>' +
                                '<b>Quien Registra :</b> ' + RegisterTicket + '</br>' +
                                '<b>Responsable :</b> ' + ResponsibleTicket + '</br>' +
                                //'<b>Encargado :</b> ' + resultado[0].FullNameTicket + ' </br>' +
                                '<b>Fecha Inicio :</b> ' + FechaRegistroTicket + ' </br>' +
                                '<b>Razon : </b> ' + RazonTicket + '  </br>' +
                                '<b>Criticidad : </b> ' + CriticidadTicket + '  </br></br>' +
                                'Se ha enviado un correo sobre los detalles del ticket, puedes visualizarlo ' +
                                '<a href="http://webmail.assac.com.pe/" target="_blank">aquí</a>' +
                                '</div>',
                            showCloseButton: true,
                            showCancelButton: false,
                            focusConfirm: false,
                            confirmButtonText:
                                'OK <i class="fa-regular fa-circle-check"></i>',
                            confirmButtonAriaLabel: 'great!',
                        });

                        //} else {

                        //    toastr.options.timeOut = nTiempoMedio;
                        //    toastr.options.extendedTimeOut = nTiempoMedio;
                        //    /*success - info - warning - error*/
                        //    var $toast = toastr["warning"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        //    return;
                        //}

                    } else if (resultado == 2) {
                        //toastr.options.timeOut = nTiempoMedio;
                        //toastr.options.extendedTimeOut = nTiempoMedio;
                        ///*success - info - warning - error*/
                        //var $toast = toastr["error"]("No se a podido registrar el Ticket", tTituloError); $toastlast = $toast;
                        //document.getElementById('btnGrabar').disabled = false;

                    } else if (resultado == 4) {
                        //toastr.options.timeOut = nTiempoMedio;
                        //toastr.options.extendedTimeOut = nTiempoMedio;
                        ///*success - info - warning - error*/
                        //var $toast = toastr["error"]("No se a podido enviar el correo al responsable", tTituloError); $toastlast = $toast;
                        //document.getElementById('btnGrabar').disabled = false;
                    } else {
                        //toastr.options.timeOut = nTiempoMedio;
                        //toastr.options.extendedTimeOut = nTiempoMedio;
                        ///*success - info - warning - error*/
                        //var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        //console.log("Mensaje del error : " + resultado);
                    }
                    $("#CargaTemporal").addClass("hidden");

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    ///*fallo al llamar a la funcion ajax*/
                    //toastr.options.timeOut = nTiempoLargo;
                    //toastr.options.extendedTimeOut = nTiempoLargo;
                    ///*success - info - warning - error*/
                    //var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                    //console.log("ERROR AJAX : " + ajaxOptions);
                    //console.log("ERROR AJAX : " + thrownError);
                    //console.log(xhr.responseText);
                    //console.log(xhr);

                }
            });

        };

    function ComboEncargadoAll2() {

            $.ajax({
                type: "GET", /*Puede ser post*/
                url: tRutaServidor + "/Person/ListarPersonaTicketTodos", /* es importante poner los .. delante*/
                contentType: "application/json; charset=utf-8",
                //data:
                //     "IdOperation=" + IdOperatorTicket,
                dataType: "json",
                success: function (resultado) {

                    var opcionesPersonTicket = "";

                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/

                        if (resultado[0].ValorConsulta == "1") {

                            /**Llenar el combo con todo las compañías**/
                            for (i = 0; i < resultado.length; i++) {

                                opcionesPersonTicket += "<option value='" + resultado[i].PersonMail + "'>" + resultado[i].FullNameOperation + "</option>";
                            }

                            //$("#selectorResponsableActivity").empty();
                            //$("#selectorResponsableActivity").append(opcionesPersonTicket);
                            //$("#selectorResponsableActivity").selectpicker('refresh');

                            $("#selectorInvitados2").empty();
                            $("#selectorInvitados2").append(opcionesPersonTicket);
                            $("#selectorInvitados2").selectpicker('refresh');

                        }
                        else {
                            /*Error al listar*/

                        }

                    } else {

                    }

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*Fallo al llamar funcion ajax*/

                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function ListadoDescripcionVitacora(NroTicketValor) {

            $.ajax({
                type: "GET",
                url: tRutaServidor + "/Activity/ListarDescriptionVitacora", /* es importante poner los .. delante*/
                data: {
                    NroTicket: NroTicketValor,
                },
                dataType: "json",
                /*async: false,*/
                success: function (resultado) {
                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/
                        if (resultado[0].ValorConsulta == "1") {

                            //document.getElementById("txtDetalleActivity").value = resultado[0].DescriptionBoard;

                            var ValorContenidoVitacora = "";

                            //var TxtDescriptionVitacora;
                            //TxtDescriptionVitacora = document.getElementById("txtDetalleActivity");
                            //TxtDescriptionVitacora.innerHTML = resultado;
                            for (i = 0; i < resultado.length; i++) {

                                ValorContenidoVitacora += "---- " + resultado[i].RegistrationDateString + " -- " + resultado[i].NameUser + " ----" + '\r\n' + resultado[i].DescriptionBoard + '\r\n' + '\r\n';

                            }

                            document.getElementById('txtDetalleActivity').value = ValorContenidoVitacora;


                        } else if (resultado[0].ValorConsulta == "-1") {



                            //$("#btnBuscar").prop('disabled', false);
                            //$("#BtnExportarExcel").prop('disabled', true);
                        }
                        else {
                            /* proceso fallido catch listado datos*/


                            //$("#btnBuscar").prop('disabled', true);
                            //$("#BtnExportarExcel").prop('disabled', true);
                            console.log(resultado);
                        }

                    } else {

                        document.getElementById("txtDetalleActivity").value = "";
                        //$("#btnBuscar").prop('disabled', false);
                        //$("#BtnExportarExcelActividades").prop('disabled', true);
                    }


                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    //$("#btnBuscar").prop('disabled', true);
                    //$("#BtnExportarExcel").prop('disabled', true);
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function GrillaListadoActividadAlertas() {

            ListadoActividadesGenerales = [];

            var dataSource = new kendo.data.DataSource({
                transport: {
                    read: function (options) {
                        $.ajax({
                            type: "GET",
                            url: tRutaServidor + "/Activity/ListarActivityCreado", /* es importante poner los .. delante*/
                            data: {
                                NroTicket: NroTicketActivity,
                            },
                            dataType: "json",
                            /*async: false,*/
                            success: function (resultado) {
                                /*exitosamente*/
                                if (resultado.length > 0) {

                                    let FechaFinModificado;

                                    /* proceso exitoso con datos*/
                                    if (resultado[0].ValorConsulta == "1") {

                                        ListadoActividadesGenerales = resultado;

                                        //var dates = [];

                                        //for (i = 0; i < resultado.length; i++) {

                                        //    var fechita = "";

                                        //    fechita = resultado[i].FechaCierre;

                                        //    fechita = fechita.split("/").reverse().join("/");

                                        //    dates.push(new Date(fechita));

                                        //}

                                        //var max = new Date(Math.max.apply(null,dates));

                                        ////var max = new Date(Math.max(dates));
                                        //function pad(s) { return (s < 10) ? '0' + s : s; }

                                        //var fechaFinReal = [pad(max.getDate()), pad(max.getMonth() + 1), max.getFullYear()].join('/');

                                        var CantidadArray = resultado.length;

                                        var fechaUltima = resultado[CantidadArray - 1].FechaCierre;

                                        let fechaFinReal = fechaUltima.substring(0, fechaUltima.length - 9);

                                        FechaFinModificado = document.querySelector("#lblFechaFinAlertas");
                                        FechaFinModificado.innerHTML = "";
                                        FechaFinModificado.innerHTML = fechaFinReal.toString();

                                        $("#GrillaLstActivityAddAlertas").removeClass("hidden");
                                        $("#imgCargaLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorLstActivityAddAlertas").addClass("hidden");
                                        $("#msjVacioLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorListarLstActivityAddAlertas").addClass("hidden");
                                        $("#msjSuperaLimiteLstActivityAddAlertas").addClass("hidden");

                                        //$("#btnBuscar").prop('disabled', false);
                                        $("#BtnExportarExcelActividades").prop('disabled', false);

                                    } else if (resultado[0].ValorConsulta == "-1") {

                                        $("#GrillaLstActivityAddAlertas").addClass("hidden");
                                        $("#imgCargaLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorLstActivityAddAlertas").addClass("hidden");
                                        $("#msjVacioLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorListarLstActivityAddAlertas").addClass("hidden");
                                        $("#msjSuperaLimiteLstActivityAddAlertas").removeClass("hidden");

                                        //$("#btnBuscar").prop('disabled', false);
                                        //$("#BtnExportarExcel").prop('disabled', true);
                                    }
                                    else {
                                        /* proceso fallido catch listado datos*/
                                        $("#GrillaLstActivityAddAlertas").addClass("hidden");
                                        $("#imgCargaLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorLstActivityAddAlertas").addClass("hidden");
                                        $("#msjVacioLstActivityAddAlertas").addClass("hidden");
                                        $("#msjErrorListarLstActivityAddAlertas").removeClass("hidden");
                                        $("#msjSuperaLimiteLstActivityAddAlertas").addClass("hidden");

                                        //$("#btnBuscar").prop('disabled', true);
                                        //$("#BtnExportarExcel").prop('disabled', true);
                                        console.log(resultado);
                                    }

                                } else {

                                    FechaFinModificado = document.querySelector("#lblFechaFinAlertas");
                                    FechaFinModificado.innerHTML = "";
                                    FechaFinModificado.innerHTML = "00/00/0000";

                                    $("#GrillaLstActivityAddAlertas").addClass("hidden");
                                    $("#imgCargaLstActivityAddAlertas").addClass("hidden");
                                    $("#msjErrorLstActivityAddAlertas").addClass("hidden");
                                    $("#msjVacioLstActivityAddAlertas").removeClass("hidden");
                                    $("#msjErrorListarLstActivityAddAlertas").addClass("hidden");
                                    //$("#msjSuperaLimiteLstActivityAddAlertas").addClass("hidden");

                                    ////$("#btnBuscar").prop('disabled', false);
                                    //$("#BtnExportarExcelActividades").prop('disabled', true);
                                }

                                options.success(resultado);
                                var grid = $("#GrillaLstActivityAddAlertas").data("kendoGrid");
                                if (grid.dataSource.total() > 0) {
                                    grid.setDataSource(dataSource);
                                }

                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                /*fallo al llamar a la funcion ajax*/
                                $("#GrillaLstActivityAddAlertas").addClass("hidden");
                                $("#imgCargaLstActivityAddAlertas").addClass("hidden");
                                $("#msjErrorLstActivityAddAlertas").removeClass("hidden");
                                $("#msjVacioLstActivityAddAlertas").addClass("hidden");
                                $("#msjErrorListarLstActivityAddAlertas").addClass("hidden");
                                $("#msjSuperaLimiteLstActivityAddAlertas").addClass("hidden");


                                //$("#btnBuscar").prop('disabled', true);
                                //$("#BtnExportarExcel").prop('disabled', true);
                                console.log("ERROR AJAX : " + ajaxOptions);
                                console.log("ERROR AJAX : " + thrownError);
                                console.log(xhr.responseText);
                                console.log(xhr);

                            }
                        });
                    },
                    parameterMap: function (data, operation) {
                        if (operation !== "read" && data.models) {
                            return JSON.stringify({ JSONparam: data.models });
                        }
                    }
                },
                error: function (e) {
                    alert("Status: " + e.status + "; Error message: " + e.errorThrown);
                },
                batch: false,
                pageSize: PaginationKendoGrid,
                schema: {
                    model: {
                        fields: {
                            IdActivity: { type: "number" },
                            ActivityText: { type: "string" },
                            FullNameActivity: { type: "string" },
                            //DescripcionActivity: { type: "string" },
                            FechaCierre: { type: "string" },
                            Estado: { type: "string" },
                            ValidationButton: { type: "string" },
                            IdResponsible: { type: "number" },
                            IdResponsibleActivity: { type: "number" },
                            PercentageNumber: { type: "string" }
                        }
                    }
                },
                //aggregate: [
                //    {
                //        field: "TicketNumber",
                //        aggregate: "count"
                //    },
                //    {
                //        field: "FuelQuantity",
                //        aggregate: "sum"
                //    }
                //]
            });

            $("#GrillaLstActivityAddAlertas").kendoGrid({
                dataSource: dataSource,
                sortable: true,
                pageable: true,
                columnMenu: true,
                columnMenu: {
                    sortable: true,
                    filterable: true,
                    columns: true,
                    messages: {
                        columns: KendoMsjColumnMenuColumns,
                        filter: KendoMsjColumnMenuFilter,
                        sortAscending: KendoMsjColumnMenuSortAscending,
                        sortDescending: KendoMsjColumnMenuSortDescending,
                        settings: KendoMsjSettings
                    }
                },
                columnMenuInit: function (e) {
                    var menu = e.container.find(".k-menu").data("kendoMenu");
                    menu.bind("select", function (e) {
                        var EtiquetaInput = $(".k-animation-container > .k-menu-group > .k-item > .k-content > .k-filter-menu > .k-textbox :input");
                        EtiquetaInput.focus();
                    });
                },
                groupable: false,
                reorderable: true,
                selectable: "row",
                scrollable: true,
                resizable: true,
                filterable: {
                    multi: true,
                    checkAll: true,
                    search: true,
                    messages: {
                        clear: KendoMsjClear,
                        filter: KendoMsjFilter,
                        selectedItemsFormat: KendoMsjSelectedItemsFormat,
                        checkAll: KendoMsjCheckAll,
                        search: KendoMsjSearch
                    }
                },
                //groupable: {
                //    info: true,
                //    messages: {
                //        empty: "<b style='font-style:italic';>Arrastre una cabecera aquí para agrupar su información por esa columna</b>"
                //    }
                //},
                pageable: {
                    messages: {
                        empty: KendoMsjEmpty,
                        page: kendoMsjPage,
                        of: KendoMsjOf,
                        itemsPerPage: KendoMsjItemsPerPage,
                        first: KendoMsjFirst,
                        last: KendoMsjLast,
                        next: KendoMsjNext,
                        previous: KendoMsjPrevious,
                        refresh: KendoMsjRefresh,
                        morePages: KendoMsjMorePages,
                        display: KendoMsjDisplay
                    },
                    refresh: false,
                    pageSizes: true,
                    pageSizes: [5, 10, 15],
                    /*para la cantidad de paginas se sugieren 5*/
                    buttonCount: 5,
                    /*Posicion de la pagina*/
                    pageSize: 5
                },
                excel: { fileName: "Listado de Actividades.xlsx", filterable: true, allPages: true },
                columns: [
                    {
                        width: 100,
                        command: {
                            template:
                                ButtonsGridActivity
                        },
                        attributes: { "class": "text-center" },
                        title: ""
                    },
                    { field: "ActivityText", title: "Nombre Actividad", width: 120, attributes: { "class": "text-center" } },
                    { field: "FullNameActivity", title: "Responsable", width: 120, attributes: { "class": "text-center" } },
                    //{ field: "DescripcionActivity", title: "Descripcion", width: 120, attributes: { "class": "text-center" } },
                    { field: "FechaCierre", title: "Fecha Cierre", width: 120, attributes: { "class": "text-center" } },
                    { field: "Estado", title: "Estado", width: 120, attributes: { "class": "text-center" } },
                    { field: "PercentageNumber", title: "Porcentaje Avance", width: 120, attributes: { "class": "text-center" } },
                ],
                dataBound: function () {
                    var Grilla = this;

                    //Grilla.tbody.find("tr[role='row']").each(function () {
                    //    var model = Grilla.dataItem(this);
                    //    //var estadoOrden = model.bE_Purchase_Order.PurchaseOrderStatus;

                    //    //if (estadoOrden == 'Z') {
                    //    //    $(this).find("td > button.BtnRegistrar").remove();
                    //    //}

                    //    //if (model.BillingCompleted == 'Z') {
                    //    //    $(this).find("td > button.BtnRegistrar").remove();
                    //    //}
                    //});


                    for (i = 0; i < Grilla.dataSource._view.length; i++) {
                        var estadoActual = Grilla.tbody.children()[i].children[4].textContent;
                        if (estadoActual == 'COMPLETADO') {
                            $($("#GrillaLstActivityAddAlertas").data("kendoGrid").tbody.children()[i]).addClass('colorVerde');
                        }
                        else if (estadoActual == 'PENDIENTE') {
                            $($("#GrillaLstActivityAddAlertas").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                        }
                        else {
                            $($("#GrillaLstActivityAddAlertas").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                        }
                    }

                    //    for (i = 0; i < $("#LstCotizacion").data("kendoGrid").dataSource._view.length; i++) {
                    //        var diasRestantes = $("#LstCotizacion").data("kendoGrid").tbody.children()[i].children[2].textContent;

                    //        if (diasRestantes < 11) {
                    //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                    //        }
                    //        else if (diasRestantes > 10 && diasRestantes < 21) {
                    //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                    //        }
                    //        else if (diasRestantes > 20) {
                    //          $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                    //        }
                    //        else {
                    //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                    //        }
                    //    }

                    //    var Grilla = this;
                    //    Grilla.tbody.find("tr[role='row']").each(function () {
                    //        var model = Grilla.dataItem(this);
                    //        if (model.QuotationStatus != "C") {
                    //            $(this).find("td > button.BtnVerInfo").remove();
                    //        }

                    //    });

                }
            });
        }

    function ComboEncargadoInforme(tipoConsulta) {

            $.ajax({
                type: "GET", /*Puede ser post*/
                url: tRutaServidor + "/Person/ListarPersonaTicketTodos", /* es importante poner los .. delante*/
                contentType: "application/json; charset=utf-8",
                //data:
                //     "IdOperation=" + 0,
                dataType: "json",
                success: function (resultado) {

                    var opcionesPersonTicket = "";

                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/

                        if (resultado[0].ValorConsulta == "1") {

                            /**Llenar el combo con todo las compañías**/
                            for (i = 0; i < resultado.length; i++) {

                                opcionesPersonTicket += "<option value='" + resultado[i].IdPerson + "'>" + resultado[i].FullNameOperation + "</option>";
                            }

                            if (tipoConsulta == "1") {

                                $("#selectorResponsableActivity").empty();
                                $("#selectorResponsableActivity").append(opcionesPersonTicket);
                                $("#selectorResponsableActivity").selectpicker('refresh');


                                $("#txtParaQuienFormato").empty();
                                $("#txtParaQuienFormato").append(opcionesPersonTicket);
                                $("#txtParaQuienFormato").selectpicker('refresh');

                            }

                        }
                        else {
                            /*Error al listar*/

                        }

                    } else {

                    }

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*Fallo al llamar funcion ajax*/

                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function RegistrarActivity() {

            $("#CargaTemporal").removeClass("hidden");

            $.ajax({
                type: "POST",
                url: tRutaServidor + "/Activity/CrearActivity",
                dataType: "json",
                data: {
                    NroTicket: NroTicketActivity,
                    IdResponsible: IdResponsibleActivity,
                    ActivityText: TextActivity,
                    //DescripcionActivity: "",
                    FechaCierre: FechaEndActivity,
                    //Invitado: SelectorInvitadosActividad
                },
                success: function (resultado) {

                    if (resultado.length > 0) {

                        if (resultado[0].ValorConsulta = '1') {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                            var UserRegister = "@User.Identity.Name.ToUpper().ToString()";
                            //console.log(UserRegister);
                            UserRegister = UserRegister.split(',')[2];

                            if (UserRegister == 1 || UserRegister == 2) {


                                ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>" + " " +
                                                      "<button class='btn-grid btn-xs BtnEdit' type='button' title='Editar'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>";


                            } else {


                                 ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                            }

                            LimpiarEtiquetas();

                            GrillaListadoActividad();

                            $("#CargaTemporal").addClass("hidden");

                            Swal.fire({
                                title: '<strong><span style="color:red">Actividad Generada</span></strong>',
                                icon: 'info',
                                html:
                                    '<div style="text-align:left;font-size:18px;margin-left:50px">' +
                                    '<b>Nro Ticket :</b> ' + resultado[0].NroTicket + '</br>' +
                                    '<b>Actividad :</b> "' + resultado[0].ActivityText + '" </br>' +
                                    '<b>Responsable :</b> ' + resultado[0].FullNameActivity + ' </br>' +
                                    '<b>Fecha Cierre : </b> ' + resultado[0].FechaCierre + '  </br>' +
                                    //'<b>Estado : </b> ' + resultado[0].CriticalityName + '  </br></br>'+
                                    'Se ha enviado un correo sobre los detalles de la Actividad, puedes visualizarlo' +
                                    '<a href="http://webmail.assac.com.pe/" target="_blank"> aquí</a>' +
                                    '</div>',
                                showCloseButton: true,
                                showCancelButton: false,
                                focusConfirm: false,
                                confirmButtonText:
                                    'OK <i class="fa-regular fa-circle-check"></i>',
                                confirmButtonAriaLabel: 'great!',
                            });

                        } else if (resultado[0].ValorConsulta == '2') {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["warning"]("No se pudo registrar la actividad", tTituloError); $toastlast = $toast;
                            return;
                        }

                    } else {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"]("El ticket consultado no existe actualmente", tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado);
                    }

                    $("#CargaTemporal").addClass("hidden");

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    toastr.options.timeOut = nTiempoLargo;
                    toastr.options.extendedTimeOut = nTiempoLargo;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });

        };

    function EditarActivity() {

            $("#CargaTemporal").removeClass("hidden");

            $.ajax({
                type: "POST",
                url: tRutaServidor + "/Activity/EditarActivity",
                dataType: "json",
                data: {
                    IdActivity: idActivity,
                    IdResponsible: IdResponsibleActivity,
                    ActivityText: TextActivity,
                    //DescripcionActivity: "",
                    FechaCierre: FechaEndActivity,
                    //Invitado: SelectorInvitadosActividad
                },
                success: function (resultado) {

                    if (resultado.length > 0) {

                        if (resultado[0].ValorConsulta = '1') {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                            LimpiarEtiquetas();

                            GrillaListadoActividadAlertas();

                            $("#CargaTemporal").addClass("hidden");

                            $("#btnAgregarActivity").removeClass("hidden");
                            $("#btnAgregarEditar").addClass("hidden");

                            Swal.fire({
                                title: '<strong><span style="color:red">Actividad Editada</span></strong>',
                                icon: 'info',
                                html:
                                    '<div style="text-align:left;font-size:18px;margin-left:50px">' +
                                    '<b>Nro Ticket :</b> ' + resultado[0].NroTicket + '</br>' +
                                    '<b>Actividad :</b> "' + resultado[0].ActivityText + '" </br>' +
                                    '<b>Responsable :</b> ' + resultado[0].FullNameActivity + ' </br>' +
                                    '<b>Fecha Cierre : </b> ' + resultado[0].FechaCierre + '  </br>' +
                                    //'<b>Estado : </b> ' + resultado[0].CriticalityName + '  </br></br>'+
                                    'Se ha enviado un correo sobre los detalles de la Actividad, puedes visualizarlo' +
                                    '<a href="http://webmail.assac.com.pe/" target="_blank"> aquí</a>' +
                                    '</div>',
                                showCloseButton: true,
                                showCancelButton: false,
                                focusConfirm: false,
                                confirmButtonText:
                                    'OK <i class="fa-regular fa-circle-check"></i>',
                                confirmButtonAriaLabel: 'great!',
                            });


                        } else if (resultado[0].ValorConsulta == '2') {

                            toastr.options.timeOut = nTiempoMedio;
                            toastr.options.extendedTimeOut = nTiempoMedio;
                            /*success - info - warning - error*/
                            var $toast = toastr["warning"]("No se pudo editar la actividad", tTituloError); $toastlast = $toast;
                            return;
                        }

                    } else {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"]("El ticket consultado no existe actualmente", tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado);
                    }

                    $("#CargaTemporal").addClass("hidden");

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    toastr.options.timeOut = nTiempoLargo;
                    toastr.options.extendedTimeOut = nTiempoLargo;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });

        };

    function LimpiarEtiquetasActivityInform() {

            document.getElementById("txtTitleInforme").value = "";
            document.getElementById("txtAsuntoInforme").value = "";
            document.getElementById("txtAntecedentesActividad").value = "";
            document.getElementById("txtConclusionesActividad").value = "";
            document.getElementById("txtRecomendacionesActividad").value = "";
            document.getElementById("txtActivityDevelop").value = "";

            $("#txtParaQuienFormato").selectpicker('val', "");
            $("#txtParaQuienFormato").selectpicker('refresh');

            $("#txtFechaActividad").datepicker("setDate", FechaFinalReporte);


            //document.getElementById("txtActivityTicket").value = "";
            //document.getElementById("txtDetalleActivity").value = "";

            //$("#txtActivityDateEnd").datepicker("setDate", FechaFinalReporte);
        }

    function ListadoDescripcionVitacoraActivityDetail(IdActivityValor) {

            $.ajax({
                type: "GET",
                url: tRutaServidor + "/Activity/ListarDescriptionVitacoraActivityDetail", /* es importante poner los .. delante*/
                data: {
                    IdActivity: IdActivityValor,
                },
                dataType: "json",
                /*async: false,*/
                success: function (resultado) {
                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/
                        if (resultado[0].ValorConsulta == "1") {

                            //document.getElementById("txtDetalleActivity").value = resultado[0].DescriptionBoard;

                            var ValorContenidoVitacora = "";

                            //var TxtDescriptionVitacora;
                            //TxtDescriptionVitacora = document.getElementById("txtDetalleActivity");
                            //TxtDescriptionVitacora.innerHTML = resultado;
                            for (i = 0; i < resultado.length; i++) {

                                ValorContenidoVitacora += "---- " + resultado[i].RegistrationDateString + " ----" + '\r\n' + resultado[i].DescriptionBoard + '\r\n' + '\r\n';

                            }

                            document.getElementById('txtDetalleActivityDetail').value = ValorContenidoVitacora;


                        } else if (resultado[0].ValorConsulta == "-1") {



                            //$("#btnBuscar").prop('disabled', false);
                            //$("#BtnExportarExcel").prop('disabled', true);
                        }
                        else {
                            /* proceso fallido catch listado datos*/


                            //$("#btnBuscar").prop('disabled', true);
                            //$("#BtnExportarExcel").prop('disabled', true);
                            console.log(resultado);
                        }

                    } else {

                        document.getElementById("txtDetalleActivityDetail").value = "";
                        //$("#btnBuscar").prop('disabled', false);
                        //$("#BtnExportarExcelActividades").prop('disabled', true);
                    }


                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    //$("#btnBuscar").prop('disabled', true);
                    //$("#BtnExportarExcel").prop('disabled', true);
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function EditarPercentage() {

        //$("#CargaTemporal").removeClass("hidden");

        $.ajax({
            type: "POST",
            url: tRutaServidor + "/Activity/EditPercentageActivity",
            dataType: "json",
            data: {
                IdActivity: idActivity,
                NumberPercentage: $('#txtPorcentajeIngresado').val(),
            },
            success: function (resultado) {

                //if (resultado.length > 0) {

                if (resultado != '0') {

                    if ($('#txtPorcentajeIngresado').val() == "") {


                        document.getElementById("IdBarPercentage").style.width = resultado.trim() + "%";

                        var ValuePercentage;
                        ValuePercentage = document.getElementById("TxtValuePercentage");
                        ValuePercentage.innerHTML = resultado.trim() + "%";

                        document.getElementById("txtPorcentajeIngresado").value = "";

                        $("#GrillaLstActivityAddAlertas").addClass("hidden");
                        $("#imgCargaLstActivityAddAlertas").removeClass("hidden");
                        $("#msjErrorLstActivityAddAlertas").addClass("hidden");
                        $("#msjVacioLstActivityAddAlertas").addClass("hidden");
                        $("#msjErrorListarLstActivityAddAlertas").addClass("hidden");
                        $("#msjSuperaLimiteLstActivityAddAlertas").addClass("hidden");

                        //GrillaListadoActividadAlertas();
                        //GrillaListadoActividad();

                        $("#GrillaLstActivityAddAlertas").data("kendoGrid").dataSource.read();

                    } else {

                        console.log(resultado);
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["success"](tMensajeEliminadoExito, tTituloExito); $toastlast = $toast;

                        $("#CargaTemporal").addClass("hidden");

                        document.getElementById("IdBarPercentage").style.width = resultado.trim() + "%";

                        var ValuePercentage;
                        ValuePercentage = document.getElementById("TxtValuePercentage");
                        ValuePercentage.innerHTML = resultado.trim() + "%";

                        document.getElementById("txtPorcentajeIngresado").value = "";

                        //GrillaListadoActividadAlertas();
                        //GrillaListadoActividad();

                        $("#GrillaLstActivityAddAlertas").data("kendoGrid").dataSource.read();

                    }

                } else {

                    document.getElementById("IdBarPercentage").style.width = "0%";

                    var ValuePercentage;
                    ValuePercentage = document.getElementById("TxtValuePercentage");
                    ValuePercentage.innerHTML = "0%";

                }

                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });


    };

    function TicketFinish() {

            $("#CargaTemporal").removeClass("hidden");

            $.ajax({
                type: "POST",
                url: tRutaServidor + "/Ticket/TicketClose",
                dataType: "json",
                data: {
                    IdTicket: IdTicketLst,
                },
                success: function (resultado) {

                    //if (resultado.length > 0) {

                    if (resultado != '0') {

                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["success"]("Se ha cerrado el Ticket con exito", tTituloExito); $toastlast = $toast;

                        $('#ModalTicketEdit').modal('hide');

                        //$("#selectorTicket").selectpicker('val', "");
                        //document.getElementById('selectorTicket').disabled = false;
                        //$("#selectorTicket").selectpicker('refresh');

                        //$("#selectorOperacion").selectpicker('val', "");
                        //document.getElementById('selectorOperacion').disabled = false;
                        //$("#selectorOperacion").selectpicker('refresh');

                        //IdOperacionTicket = "0";
                        //Valor = 1;
                        //IdCriticidadSelect = "0";

                        GrillaListado();

                    } else {

                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado);

                    }

                    $("#CargaTemporal").addClass("hidden");

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    /*fallo al llamar a la funcion ajax*/
                    toastr.options.timeOut = nTiempoLargo;
                    toastr.options.extendedTimeOut = nTiempoLargo;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });

        };

    function ValidarStatusActividades() {

        $.ajax({
            type: "GET",
            url: tRutaServidor + "/Activity/StatusActivities",
            dataType: "json",
            data: {
                IdTicket: IdTicketLst,
            },
            success: function (resultado) {

                if (resultado.length > 0) {

                    if (resultado == '1') {

                        $("#btnCerrarTicket").prop('disabled', false);

                    } else {

                        $("#btnCerrarTicket").prop('disabled', true);
                    }

                } else if (resultado == 2) {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tValidacionNroCotizacionExiste, tTituloError); $toastlast = $toast;
                    document.getElementById('btnGrabar').disabled = false;

                } else if (resultado == 3) {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorActualizarRutas, tTituloError); $toastlast = $toast;
                    document.getElementById('btnGrabar').disabled = false;
                } else {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                    console.log("Mensaje del error : " + resultado);
                }
                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    }

    function GrillaListadoActividad() {

        ListadoActividadesGenerales = [];

        var dataSource = new kendo.data.DataSource({
            transport: {
                read: function (options) {
                    $.ajax({
                        type: "GET",
                        url: tRutaServidor + "/Activity/ListarActivityCreado", /* es importante poner los .. delante*/
                        data: {
                            NroTicket: NroTicketActivity,
                        },
                        dataType: "json",
                        /*async: false,*/
                        success: function (resultado) {
                            /*exitosamente*/
                            if (resultado.length > 0) {
                                /* proceso exitoso con datos*/
                                if (resultado[0].ValorConsulta == "1") {

                                    //ListadoActividadesGenerales = resultado;

                                    //var dates = [];

                                    //for (i = 0; i < resultado.length; i++) {

                                    //    var fechita = "";

                                    //    fechita = resultado[i].FechaCierre;

                                    //    fechita = fechita.split("/").reverse().join("/");

                                    //    dates.push(new Date(fechita));

                                    //}

                                    //var max = new Date(Math.max.apply(null,dates));

                                    ////var max = new Date(Math.max(dates));
                                    //function pad(s) { return (s < 10) ? '0' + s : s; }

                                    //var fechaFinReal = [pad(max.getDate()), pad(max.getMonth() + 1), max.getFullYear()].join('/');

                                    //FechaFinModificado = document.querySelector("#lblFechaFin");
                                    //FechaFinModificado.innerHTML = "";
                                    //FechaFinModificado.innerHTML = fechaFinReal.toString();

                                    var CantidadArray = resultado.length;

                                    var fechaUltima = resultado[CantidadArray - 1].FechaCierre;

                                    let fechaFinReal = fechaUltima.substring(0, fechaUltima.length - 9);

                                    FechaFinModificado = document.querySelector("#lblFechaFinAlertas");
                                    FechaFinModificado.innerHTML = "";
                                    FechaFinModificado.innerHTML = fechaFinReal.toString();

                                    $("#GrillaLstActivityAdd").removeClass("hidden");
                                    $("#imgCargaLstActivityAdd").addClass("hidden");
                                    $("#msjErrorLstActivityAdd").addClass("hidden");
                                    $("#msjVacioLstActivityAdd").addClass("hidden");
                                    $("#msjErrorListarLstActivityAdd").addClass("hidden");
                                    $("#msjSuperaLimiteLstActivityAdd").addClass("hidden");

                                    //$("#btnBuscar").prop('disabled', false);
                                    $("#BtnExportarExcelActividades").prop('disabled', false);

                                } else if (resultado[0].ValorConsulta == "-1") {

                                    $("#GrillaLstActivityAdd").addClass("hidden");
                                    $("#imgCargaLstActivityAdd").addClass("hidden");
                                    $("#msjErrorLstActivityAdd").addClass("hidden");
                                    $("#msjVacioLstActivityAdd").addClass("hidden");
                                    $("#msjErrorListarLstActivityAdd").addClass("hidden");
                                    $("#msjSuperaLimiteLstActivityAdd").removeClass("hidden");

                                    //$("#btnBuscar").prop('disabled', false);
                                    //$("#BtnExportarExcel").prop('disabled', true);
                                }
                                else {
                                    /* proceso fallido catch listado datos*/
                                    $("#GrillaLstActivityAdd").addClass("hidden");
                                    $("#imgCargaLstActivityAdd").addClass("hidden");
                                    $("#msjErrorLstActivityAdd").addClass("hidden");
                                    $("#msjVacioLstActivityAdd").addClass("hidden");
                                    $("#msjErrorListarLstActivityAdd").removeClass("hidden");
                                    $("#msjSuperaLimiteLstActivityAdd").addClass("hidden");

                                    //$("#btnBuscar").prop('disabled', true);
                                    //$("#BtnExportarExcel").prop('disabled', true);
                                    console.log(resultado);
                                }

                            } else {

                                FechaFinModificado = document.querySelector("#lblFechaFinAlertas");
                                FechaFinModificado.innerHTML = "";
                                FechaFinModificado.innerHTML = "00/00/0000";

                                $("#GrillaLstActivityAdd").addClass("hidden");
                                $("#imgCargaLstActivityAdd").addClass("hidden");
                                $("#msjErrorLstActivityAdd").addClass("hidden");
                                $("#msjVacioLstActivityAdd").removeClass("hidden");
                                $("#msjErrorListarLstActivityAdd").addClass("hidden");
                                $("#msjSuperaLimiteLstActivityAdd").addClass("hidden");

                                //$("#btnBuscar").prop('disabled', false);
                                $("#BtnExportarExcelActividades").prop('disabled', true);
                            }

                            options.success(resultado);
                            var grid = $("#GrillaLstActivityAdd").data("kendoGrid");
                            if (grid.dataSource.total() > 0) {
                                grid.setDataSource(dataSource);
                            }

                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            /*fallo al llamar a la funcion ajax*/
                            $("#GrillaLstActivityAdd").addClass("hidden");
                            $("#imgCargaLstActivityAdd").addClass("hidden");
                            $("#msjErrorLstActivityAdd").removeClass("hidden");
                            $("#msjVacioLstActivityAdd").addClass("hidden");
                            $("#msjErrorListarLstActivityAdd").addClass("hidden");
                            $("#msjSuperaLimiteLstActivityAdd").addClass("hidden");

                            //$("#btnBuscar").prop('disabled', true);
                            //$("#BtnExportarExcel").prop('disabled', true);
                            console.log("ERROR AJAX : " + ajaxOptions);
                            console.log("ERROR AJAX : " + thrownError);
                            console.log(xhr.responseText);
                            console.log(xhr);

                        }
                    });
                },
                parameterMap: function (data, operation) {
                    if (operation !== "read" && data.models) {
                        return JSON.stringify({ JSONparam: data.models });
                    }
                }
            },
            error: function (e) {
                alert("Status: " + e.status + "; Error message: " + e.errorThrown);
            },
            batch: false,
            pageSize: PaginationKendoGrid,
            schema: {
                model: {
                    fields: {
                        IdActivity: { type: "number" },
                        ActivityText: { type: "string" },
                        FullNameActivity: { type: "string" },
                        //DescripcionActivity: { type: "string" },
                        FechaCierre: { type: "string" },
                        Estado: { type: "string" },
                        ValidationButton: { type: "string" },
                        IdResponsible: { type: "number" },
                        IdResponsibleActivity: { type: "number" },
                        PercentageNumber: { type: "string" }
                    }
                }
            },
            //aggregate: [
            //    {
            //        field: "TicketNumber",
            //        aggregate: "count"
            //    },
            //    {
            //        field: "FuelQuantity",
            //        aggregate: "sum"
            //    }
            //]
        });

        $("#GrillaLstActivityAdd").kendoGrid({
            dataSource: dataSource,
            sortable: true,
            pageable: true,
            columnMenu: true,
            columnMenu: {
                sortable: true,
                filterable: true,
                columns: true,
                messages: {
                    columns: KendoMsjColumnMenuColumns,
                    filter: KendoMsjColumnMenuFilter,
                    sortAscending: KendoMsjColumnMenuSortAscending,
                    sortDescending: KendoMsjColumnMenuSortDescending,
                    settings: KendoMsjSettings
                }
            },
            columnMenuInit: function (e) {
                var menu = e.container.find(".k-menu").data("kendoMenu");
                menu.bind("select", function (e) {
                    var EtiquetaInput = $(".k-animation-container > .k-menu-group > .k-item > .k-content > .k-filter-menu > .k-textbox :input");
                    EtiquetaInput.focus();
                });
            },
            groupable: false,
            reorderable: true,
            selectable: "row",
            scrollable: true,
            resizable: true,
            filterable: {
                multi: true,
                checkAll: true,
                search: true,
                messages: {
                    clear: KendoMsjClear,
                    filter: KendoMsjFilter,
                    selectedItemsFormat: KendoMsjSelectedItemsFormat,
                    checkAll: KendoMsjCheckAll,
                    search: KendoMsjSearch
                }
            },
            //groupable: {
            //    info: true,
            //    messages: {
            //        empty: "<b style='font-style:italic';>Arrastre una cabecera aquí para agrupar su información por esa columna</b>"
            //    }
            //},
            pageable: {
                messages: {
                    empty: KendoMsjEmpty,
                    page: kendoMsjPage,
                    of: KendoMsjOf,
                    itemsPerPage: KendoMsjItemsPerPage,
                    first: KendoMsjFirst,
                    last: KendoMsjLast,
                    next: KendoMsjNext,
                    previous: KendoMsjPrevious,
                    refresh: KendoMsjRefresh,
                    morePages: KendoMsjMorePages,
                    display: KendoMsjDisplay
                },
                refresh: false,
                pageSizes: true,
                pageSizes: [5, 10, 15],
                /*para la cantidad de paginas se sugieren 5*/
                buttonCount: 5,
                /*Posicion de la pagina*/
                pageSize: 5
            },
            excel: { fileName: "Listado de Actividades.xlsx", filterable: true, allPages: true },
            columns: [
                {
                    width: 100,
                    command: {
                        template:
                            ButtonsGridActivity
                    },
                    attributes: { "class": "text-center" },
                    title: ""
                },
                { field: "ActivityText", title: "Nombre Actividad", width: 120, attributes: { "class": "text-center" } },
                { field: "FullNameActivity", title: "Responsable", width: 120, attributes: { "class": "text-center" } },
                //{ field: "DescripcionActivity", title: "Descripcion", width: 120, attributes: { "class": "text-center" } },
                { field: "FechaCierre", title: "Fecha Cierre", width: 120, attributes: { "class": "text-center" } },
                { field: "Estado", title: "Estado", width: 120, attributes: { "class": "text-center" } },
                { field: "PercentageNumber", title: "Porcentaje Avance", width: 120, attributes: { "class": "text-center" } },
            ],
            dataBound: function () {
                var Grilla = this;

                //Grilla.tbody.find("tr[role='row']").each(function () {
                //    var model = Grilla.dataItem(this);
                //    //var estadoOrden = model.bE_Purchase_Order.PurchaseOrderStatus;

                //    //if (estadoOrden == 'Z') {
                //    //    $(this).find("td > button.BtnRegistrar").remove();
                //    //}

                //    //if (model.BillingCompleted == 'Z') {
                //    //    $(this).find("td > button.BtnRegistrar").remove();
                //    //}
                //});


                for (i = 0; i < Grilla.dataSource._view.length; i++) {
                    var estadoActual = Grilla.tbody.children()[i].children[4].textContent;
                    if (estadoActual == 'COMPLETADO') {
                        $($("#GrillaLstActivityAdd").data("kendoGrid").tbody.children()[i]).addClass('colorVerde');
                    }
                    else if (estadoActual == 'PENDIENTE') {
                        $($("#GrillaLstActivityAdd").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                    }
                    else {
                        $($("#GrillaLstActivityAdd").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                    }
                }

                //    for (i = 0; i < $("#LstCotizacion").data("kendoGrid").dataSource._view.length; i++) {
                //        var diasRestantes = $("#LstCotizacion").data("kendoGrid").tbody.children()[i].children[2].textContent;

                //        if (diasRestantes < 11) {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                //        }
                //        else if (diasRestantes > 10 && diasRestantes < 21) {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                //        }
                //        else if (diasRestantes > 20) {
                //          $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                //        }
                //        else {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                //        }
                //    }

                //    var Grilla = this;
                //    Grilla.tbody.find("tr[role='row']").each(function () {
                //        var model = Grilla.dataItem(this);
                //        if (model.QuotationStatus != "C") {
                //            $(this).find("td > button.BtnVerInfo").remove();
                //        }

                //    });

            }
        });
    }

    /* -------------------- GRAFICO DE BARRA  ----------------------- */

    function listadoTicketYResponsable(estado) {

            //var ValueIdTicket;

            //if ($("#selectorTicketGrafico").val() == null || $("#selectorTicketGrafico").val() == "") {

            //    ValueIdTicket = 1;

            //} else {

            //    $("#grGraficaTicketXActividad").addClass("hidden");
            //    $("#imgCargaGraficaTicketXActividad").removeClass("hidden");
            //    $("#msjErrorGraficaTicketXActividad").addClass("hidden");
            //    $("#msjVacioGraficaTicketXActividad").addClass("hidden");
            //    $("#msjErrorListarGraficaTicketXActividad").addClass("hidden");
            //    $("#msjSuperaLimiteGraficaTicketXActividad").addClass("hidden");

            //    ValueIdTicket = $("#selectorTicketGrafico").val()[0];

            //}

            //console.log($("#selectorTicketGrafico").val());

            $.ajax({
                type: "GET", /*Puede ser post*/
                url: tRutaServidor + "/ListGeneralActivity/ListarTicketYResponsableGraphic", /* es importante poner los .. delante*/
                contentType: "application/json; charset=utf-8",
                //data: {
                //    IdTicket: ValueIdTicket,
                //    StatusCategory: ValueFilterTicket
                //},
                dataType: "json",
                success: function (resultado) {

                    /*exitosamente*/
                    if (resultado.length > 0) {
                        /* proceso exitoso con datos*/
                        if (resultado[0].ValorConsulta == "1") {

                            $("#ContenedorExGrafica").removeClass("hidden");
                            $("#btnExGrafica").prop('disabled', false);

                            estadoCargarGrafico = "1";
                            //estadoCargarGrafico11 = "1";

                            resultadojson = resultado;
                            //listadoEstadosCotizaciones(resultado, estado);

                            llamadaTicketYResponsable(estado);

                        }
                        else {
                            //estadoCargarGrafico11 = "0";
                            //estadoCargarGrafico11 = "0";

                            /*Grafico 1*/
                            $("#grGraficaTicketAndResponsible").addClass("hidden");
                            $("#imgCargaGraficaTicketAndResponsible").addClass("hidden");
                            $("#msjErrorGraficaTicketAndResponsible").addClass("hidden");
                            $("#msjVacioGraficaTicketAndResponsible").addClass("hidden");
                            $("#msjErrorListarGraficaTicketAndResponsible").removeClass("hidden");
                            $("#msjSuperaLimiteGraficaTicketAndResponsible").addClass("hidden");

                        }

                    } else {

                        //$("#btnBuscarReporteCotizaciones").prop('disabled', false);
                        //estadoCargarGrafico11 = "0";
                        //estadoCargarGrafico11 = "0";
                        /*Grafico 1*/
                        $("#grGraficaTicketAndResponsible").addClass("hidden");
                        $("#imgCargaGraficaTicketAndResponsible").addClass("hidden");
                        $("#msjErrorGraficaTicketAndResponsible").addClass("hidden");
                        $("#msjVacioGraficaTicketAndResponsible").removeClass("hidden");
                        $("#msjErrorListarGraficaTicketAndResponsible").addClass("hidden");
                        $("#msjSuperaLimiteGraficaTicketAndResponsible").addClass("hidden");

                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //estadoCargarGrafico10 = "0";
                    //estadoCargarGrafico11 = "0";
                    /*fallo al llamar a la funcion ajax*/
                    /*Grafico 1*/
                    $("#grGraficaTicketAndResponsible").addClass("hidden");
                    $("#imgCargaGraficaTicketAndResponsible").addClass("hidden");
                    $("#msjErrorGraficaTicketAndResponsible").removeClass("hidden");
                    $("#msjVacioGraficaTicketAndResponsible").addClass("hidden");
                    $("#msjErrorListarGraficaTicketAndResponsible").addClass("hidden");
                    $("#msjSuperaLimiteGraficaTicketAndResponsible").addClass("hidden");


                    console.log("ERROR AJAX : " + ajaxOptions);
                    console.log("ERROR AJAX : " + thrownError);
                    console.log(xhr.responseText);
                    console.log(xhr);

                }
            });
        }

    function llamadaTicketYResponsable(estado) {

            if (estado == "1") {

                /**Llamar a la funcion que dibuja el grafico, y en caso se mueva la pantalla redibujar*/
                google.charts.load('visualization', '1.0', { 'packages': ['corechart', 'bar'] });
                google.charts.setOnLoadCallback(DibujarTicketYResponsable);

            } else {
                ConvertirDataTicketYResponsable(estado);
            }
        }

    function DibujarTicketYResponsable() {
            ConvertirDataTicketYResponsable("1");
        }

    function ConvertirDataTicketYResponsable(estado) {

            var dataTableData = new google.visualization.DataTable();
            dataTableData.addColumn('string', 'Numero Ticket'); // Implicit domain label col.
            dataTableData.addColumn('number', 'Cantidad Porcentual');
            dataTableData.addColumn({ type: 'string', role: 'annotation' });
            /*dataTableData.addColumn({ type: 'string', role: 'tooltip', 'p': { 'html': true } });*/
            //dataTableData.addColumn('number', 'NoProgramado');
            //dataTableData.addColumn({ type: 'string', role: 'tooltip', 'p': { 'html': true } });

            //for (i = 0; i < resultadojson10.length; i++) {

            //if (resultadojson10[i].Latitud == 0 && resultadojson10[i].Latitud == 0) {
            //    EstadoCuatro += 1;
            //} else if (resultadojson10[i].StatusRegister == 1) {
            //    EstadoUno += 1;
            //} else if (resultadojson10[i].StatusRegister == 2) {
            //    EstadoDos += 1;
            //} else if (resultadojson10[i].StatusRegister == 3) {
            //    EstadoTres += 1;
            //}
            //ValoGoogleChart = [
            //    { Name: 'P', Estado: resultadojson10[0].Programado},
            //    { Name: 'NP', Estado: resultadojson10[0].NoProgramado},
            //    //{ Name: 'Superior a 48 Horas', Estado: EstadoTres },
            //    //{ Name: 'No existe registros', Estado: EstadoCuatro },
            //];
            //}
            //if (resultadojson3.length < 59) {

            //    var containerGrafico = document.getElementById('grGraficaActividadesXUsuarioASSAC');
            //    containerGrafico.style.width = '100%';

            //    var ScrollContenedor = document.getElementById('chartAreaWrapper');
            //    ScrollContenedor.style.overflowX = 'hidden';
            //    ScrollContenedor.style.overflowY = 'hidden';
            //    ScrollContenedor.style.width = '100%'
            // }
            // else {

            //     var containerGrafico = document.getElementById('grGraficaActividadesXUsuarioASSAC');
            //     containerGrafico.style.width = '3500px';
            //     containerGrafico.style.height = '500px';

            //     var ScrollContenedor = document.getElementById('chartAreaWrapper');
            //     ScrollContenedor.style.overflowX = 'scroll';
            //     ScrollContenedor.style.overflowY = 'hidden';
            //     ScrollContenedor.style.width = '100%'

            //}

/*            var CantidadAtencionesSumada;*/

            var NumeroTicketI = "";
            var NumeroTicketGraphic = "";
            var NumeroTicketX = "T00";
            var CantidadDeActividadCompletada = 0;
            var CantidadDeActividad = 0;
            var ResultadoPorcentaje = 0;
            var PersonaResponsableTicket = "";

            for (i = 0; i < resultadojson.length; i++) { //recorro todas las fechas únicas

                NumeroTicketI = resultadojson[i].NroTicket;

                if (NumeroTicketI != NumeroTicketX) {

                    for (x = 0; x < resultadojson.length; x++) {

                        if (NumeroTicketI == resultadojson[x].NroTicket) {

                            CantidadDeActividad = CantidadDeActividad + 1;

                            NumeroTicketGraphic = resultadojson[x].NroTicket;
                            PersonaResponsableTicket = resultadojson[x].ResponsibleNameTicket;

                            if (resultadojson[x].MigrationStatus == 'C') {

                                CantidadDeActividadCompletada = CantidadDeActividadCompletada + 1;

                            }

                            NumeroTicketX = resultadojson[x].NroTicket;

                        }


                    }

                    ResultadoPorcentaje = Math.round((CantidadDeActividadCompletada / CantidadDeActividad) * 100);

                    dataTableData.addRow([NumeroTicketGraphic, ResultadoPorcentaje, PersonaResponsableTicket]);

                    CantidadDeActividadCompletada = 0;
                    CantidadDeActividad = 0;
                    ResultadoPorcentaje = 0;
                    NumeroTicketGraphic = "";
                }

            }

            dataGroupGrafico = dataTableData;
            GraficaTicketYResponsable(estado);
        }

    function CreandoHtml1(NroTicket, PorcentajeTicket, color) {

            return "<div style='padding:5px; width: 350px; display:flex; flex-flow: row nowrap; align-items:center'>" +
                      "<div style='width:15px;'><div style='width:12px; height:12px; background-color:" + color + "; border: 1px solid black; margin:5px 2px 0px 0px;' ></div></div>" +
                         "<div style='width:240px; font-weight: bold; font-family: Arial, Helvetica, sans-serif; margin:10px 3px 0px 3px; font-size:14px; display:flex; flex-flow: row wrap;'><p style='word-break: break-all; text-align:justify;'>Nro Ticket : " + NroTicket + " - Porcentaje :" + PorcentajeTicket + ".</p></div>" +
                      "<div style='width:50px;'><button class='btn btn-success' onclick=\"ClickGrillaDetalle10('" + NroTicket + "')\" style='color:white; padding:3px; font-size:12px;' value=''><i class='fa fa-list'></i> Ver detalle</button></div>" +
                   "</div>";

        }

    function GraficaTicketYResponsable(estado) {

            var optionsGrafico = {
                title: 'Grafico de Avance Porcentual de cada Responsable',
                width: 1250,
                isStacked: true,
                titleTextStyle: {
                    //color: '#0288d1',
                    color: 'black',
                    fontName: 'Arial',
                    fontSize: 20,
                    bold: true,
                    italic: true,
                },
                slices: {
                    0: { color: '#3366CC' }, //azul
                    1: { color: '#FF8000' },
                    //1: { color: '#DC3912' }, //rojo
                    //2: { color: '#FF9900' }, //amarillo
                    //3: { color: '#109618' }, //verde
                    //4: { color: '#990099' }, //Morado
                    //5: { color: '#0099C6' }, //Celeste
                    //6: { color: '#DD4477' }, //Rosado
                },
                // focusTarget: 'category',
                chartArea: {
                    top: 108,
                    height: '40%'
                },
                legend: { position: 'top' },
                vAxis: {
                    title: 'Nroº TICKETS',
                    titleTextStyle: {
                        fontSize: '15px',
                        color: "#439889",
                        bold: true,
                        italic: true,
                    },
                    //format: '#,### gal',
                    format: '0',
                    //viewWindowMode: 'explicit',
                    // viewWindow: {   // De que rango a que rango se podra visualizar
                    //    max: dataGroupGrafico1.getColumnRange(0).max,
                    //    min: 0
                    //},
                    gridlines: {
                        count: 12   // Lineas grises que se desprenderan del eje y de manera horizonatal.
                    },
                    textStyle: {
                        color: "#0288d1",
                        fontName: 'Arial',
                        fontSize: '15px',
                        bold: true,
                        italic: true
                    },
                },
                hAxis: {
                    showTextEvery: 1,
                    slantedText: true,
                    slantedTextAngle: 90,
                    titleTextStyle: {
                        fontSize: '15px',
                        color: "#439889",
                        bold: true,
                        italic: true,
                    },
                    textStyle: {
                        color: "#0288d1",
                        fontName: 'Arial',
                        fontSize: '15px',
                        bold: true,
                        italic: true,

                    },
                    count: -1,
                    viewWindowMode: 'pretty',
                    format: '0',
                },
                animation: {
                    duration: 600,
                    easing: 'linear', //Constant speed.
                    //easing: 'in', // Ease in - Start slow and speed up.
                    //easing: 'out', // Ease out - Start fast and slow down.
                    //easing: 'inAndOut', // Ease in and out - Start slow, speed up, then slow down.
                    startup: true,
                },

                /**Opciones para quitar los margenes y padding por defecto*/
                //chartArea: {
                //    width: "100%",
                //    height: "80%",
                //    left: 60,
                //    right: 20,
                //    //top: 40,
                //    //bottom: 20,
                //},
                lineWidth: 2,
                pointShape: 'point',
                pointSize: 5,
                legend: {
                    position: 'bottom',
                    textStyle: {
                        bold: true,
                        italic: true,
                    },
                },
                crosshair: { trigger: 'both' },
                //crosshair: { trigger: 'focus' }
                //crosshair: { trigger: 'selection' }
                //crosshair: { orientation: 'both' }
                //crosshair: { orientation: 'horizontal' }
                //crosshair: { orientation: 'vertical' }
                //crosshair: { color: "red" } //'red' or '#f00'
                //crosshair: { opacity: opacity_number }
                //crosshair: { focused: { color: color_string } }
                //crosshair: { focused: { opacity: opacity_number } }
                //crosshair: { selected: { color: color_string } }
                //crosshair: { selected: { opacity: opacity_number } }
                tooltip: {
                    isHtml: false,
                    showColorCode: true,
                    textStyle: {
                        //color:  "red",//<string>,
                        //fontName: "",//<string>,
                        fontSize: 14,//<number>,
                        bold: true,//<boolean>,
                        //italic: false//<boolean>

                    },
                    //trigger: 'focus',// - The tooltip will be displayed when the user hovers over the element.
                    //trigger: 'none', //- The tooltip will not be displayed.
                    trigger: 'selection',// - The tooltip will be displayed when the user selects the element.
                }

            };

            if (estado == "1") {
                var chartDiv = document.getElementById('grGraficaTicketAndResponsible');
                pchartG = new google.visualization.BarChart(chartDiv);
            }

            $("#grGraficaTicketAndResponsible").removeClass("hidden");
            $("#imgCargaGraficaTicketAndResponsible").addClass("hidden");
            $("#msjErrorGraficaTicketAndResponsible").addClass("hidden");
            $("#msjVacioGraficaTicketAndResponsible").addClass("hidden");
            $("#msjErrorListarGraficaTicketAndResponsible").addClass("hidden");
            $("#msjSuperaLimiteGraficaTicketAndResponsible").addClass("hidden");

            //$("#ContenedorExGrafica12").removeClass("hidden");
            //$("#btnExGrafica12").prop('disabled', false);
            //$("#btnBuscar").prop('disabled', false);

            if (estado == "1") {
                /********************************EVENTO ***READY****************************************/
                google.visualization.events.addListener(pchartG, 'ready', function () {
                    //alert(1);
                    try {
                        /*Centrar el titulo del grafico */
                        var $container = $('#grGraficaTicketAndResponsible');
                        widthG = $container.find('svg').width();
                        //heightG10 = $container.find('svg').height();
                        //var $titleElem = $container.find("text:contains(" + optionsGrafico12.title + ")");
                        //var titleWidth = $titleElem.html().length * ($titleElem.attr('font-size') / 2);
                        //var xAxisAlign = (widthG12 - titleWidth) / 2;
                        //$titleElem.attr('x', xAxisAlign);

                    } catch (e) {
                        console.log(e);
                    }
                    /*Setear valor para el exportar*/
                    ImageURI = pchartG.getImageURI();

                    /*Redibujar la grafica al cambiar del tamaño de pantalla*/
                  /*  reDibujarGrafica();*/

                });

                /******************************EVENTO ****ERROR*****************************************/
                google.visualization.events.addListener(pchartG, 'error', function (error) {
                    /**Para remover el mensaje de error de google del grafico (Tambien hay un atributo para remover todos los errores)*/
                    console.log(error);
                    google.visualization.errors.removeError(error.id);
                });
            }

            pchartG.draw(dataGroupGrafico, optionsGrafico);


            var columns = [];
            var series = {};
            for (var i = 0; i < dataGroupGrafico.getNumberOfColumns(); i++) {
                columns.push(i);

                if (i > 0) {
                    series[i - 1] = {};

                }
            }

            if (estado == "1") {
                /***********************************EVENTO-SELECT********************************************/
                google.visualization.events.addListener(pchartG, 'select', function () {


                    //var selectedItem = pchartG.getSelection()[0];

                    //if (selectedItem) {

                    //     //var category = data.getValue(selectedItem.row, 0);
                    //     //var value = data.getValue(selectedItem.row, 1);

                    //     var button = document.createElement('button');

                    //     button.innerHTML = 'Haz clic aquí';

                    //      button.addEventListener('click', function () {
                    //          alert('Haz hecho clic en la categoría: ');
                    //      });

                    //    document.getElementById('grGraficaTicketAndResponsible').appendChild(button);
                    //}

                    var selection = pchartG.getSelection();

                    if (selection.length === 1) {

                        $("#ModalTicketResponsible").modal("show");

                    }

                });

                /**********************************EVENTO-ONMOUSEOVER*********************************************************************/
                google.visualization.events.addListener(pchartG, 'onmouseover', function () { document.getElementById('grGraficaTicketAndResponsible').style.cursor = 'pointer'; });

                /**********************************EVENTO-ONMOUSEOUT**********************************************************************/
                google.visualization.events.addListener(pchartG, 'onmouseout', function () { document.getElementById('grGraficaTicketAndResponsible').style.cursor = 'default'; });
            }

        }

    /* ------------------- GRAFICA TABLA ---------------------------*/

    function ListadoTablaTicketYResponsable(ValueStatus,ValueResponsable) {

        //var IdsReponsibleTable = "";

        // /*  IdsReponsibleTable*/

        //if ($("#selectorResponsible").val() != '' && $("#selectorResponsible").val() != null) {

        //    IdsReponsibleTable = $("#selectorResponsible").val();
        //    IdsReponsibleTable = IdsReponsibleTable.toString();

        //} else {

        //    IdsReponsibleTable = '0';

        //}

        //console.log(IdsReponsibleTable);
/*        console.log(StatusTicketRadio);*/

        $("#ContainerticketAndResponsible").addClass("hidden");
        $("#imgCargaContainerTicketAndResponsible").removeClass("hidden");
        $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
        $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
        $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
        $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

        $.ajax({
            type: "GET", /*Puede ser post*/
            url: tRutaServidor + "/ListGeneralActivity/ListarTicketYResponsableGraphic", /* es importante poner los .. delante*/
            contentType: "application/json; charset=utf-8",
            data: {
                StatusTicket0: ValueStatus,
                ResponsibleId0: ValueResponsable
            },
            dataType: "json",
            success: function (resultado) {

                /*exitosamente*/
                if (resultado.length > 0) {
                    /* proceso exitoso con datos*/
                    if (resultado[0].ValorConsulta == "1") {

/*                        for (i = 0; i < resultadojson.length; i++) {*/

                      divContainerTicketAndResponsible.innerHTML = "";

                      let ContenedorTexto = "";
                      var NumeroTicketI = "";
                      var NumeroTicketGraphic = "";
                      var NumeroTicketX = "T00";
                      var CantidadDeActividadCompletada = 0;
                      var CantidadDeActividad = 0;
                      var ResultadoPorcentaje = 0;
                      var PersonaResponsableTicket = "";
                      var TitleTicketDescription = "";

                        ContenedorTexto = "<table class='table table-bordered'>" +
                                "<thead>" +
                                "<tr>" +
                                "<th scope='col' style='width: 120px; font-size: 18px; text-align: center;border: 6px solid white;background:#b5b5b5'>Nro. Ticket</th>" +
                                "<th scope='col' style='font-size: 18px; text-align: center; width:600px;border: 6px solid white;background:#b5b5b5'>Titulo Ticket</th>" +
                                "<th  scope='col' style='font-size: 18px; text-align: center; width:250px;border: 6px solid white;background:#b5b5b5'>Barra de Progreso</th>" +
                               /* "<th style='font-size: 18px; text-align: center' scope='col'>Foto</th>" +*/
                                "<th scope='col' style='font-size: 18px; text-align: center;border: 6px solid white;background:#b5b5b5'>Responsable</th>" +
                                "<th scope='col' style='font-size: 18px; text-align: center;border: 6px solid white;background:#b5b5b5'>Detalle Ticket</th>" +
                                "</tr>" +
                                "</thead>" +
                                "<tbody>";

                       for (i = 0; i < resultado.length; i++) { //recorro todas las fechas únicas

                           NumeroTicketI = resultado[i].NroTicket;

                             if (NumeroTicketI != NumeroTicketX) {

                                for (x = 0; x < resultado.length; x++) {

                                    if (NumeroTicketI == resultado[x].NroTicket) {

                                        CantidadDeActividad = CantidadDeActividad + 1;

                                        NumeroTicketGraphic = resultado[x].NroTicket;
                                        PersonaResponsableTicket = resultado[x].ResponsibleNameTicket;
                                        TitleTicketDescription = resultado[x].TitleDescription;

                                        if (resultado[x].MigrationStatus == 'C') {

                                            CantidadDeActividadCompletada = CantidadDeActividadCompletada + 1;

                                        }

                                        NumeroTicketX = resultado[x].NroTicket;

                                 }


                               }

                             ResultadoPorcentaje = Math.round((CantidadDeActividadCompletada / CantidadDeActividad) * 100);


                             ContenedorTexto += "<tr>" +
                                 "<td style='width: 120px; text-align:center;border: 6px solid white;background:#ebebeb'>" +
                                 "<label style='margin-top: 22px; font-weight: bold; font-size: 20px;'>" + NumeroTicketGraphic + "</label>" +
                                 "</td>" +
                                 "<td style='border: 6px solid white;background:#ebebeb'>" +
                                 "<label style='font-size:16px;margin-top:22px;font-weight: bold;'>" + TitleTicketDescription + "</label>" +
                                 "</td>" +
                                 "<td style='width:250px;border: 6px solid white;background:#ebebeb'>" +
                                 "<div class='progress' style='margin: 15px 0px 20px 0px;border-radius:10px;border: 3px solid black;'>" +
                                 "<div class='progress-bar progress-bar-striped progress-bar-animated active' id='IdBarPercentageTicketResponsible' role='progressbar' style='background-color:#e6dc09;width:" + ResultadoPorcentaje + "%;' aria-valuenow='25' aria-valuemin='0' aria-valuemax='100'><span id='TxtValuePercentageTicketResponsible'>" + ResultadoPorcentaje + "%</span></div>" +
                                 "</div>" +
                                 "</td>" +
                                 //"<td style='width:120px;'>" +
                                 //"<span class='widget-icon' style='width:60px;margin-left:15px'>" +
                                 //"<img width='70' style='margin-top:5px' src='" + ImagenUser2 + "' />" +
                                 //"</span>" +
                                 //"</td>" +
                                 "<td style='border: 6px solid white;background:#ebebeb'>" +
                                 "<label style='font-size:16px;margin-top:22px;font-family:system-ui'>" + PersonaResponsableTicket + "</label>" +
                                 "</td>" +
                                 "<td style='border: 6px solid white;background:#ebebeb'>" +
                                 "<button id='button-8' style='height:40px;width:170px;background:#4ba1f4;margin-left:35px;border: 3px solid black' onClick='functionListarTicketResponsable(\"" + NumeroTicketGraphic +"\")'>" +
                                 "<img width='25' src='" + ImagenBotonDetalle2 + "' />" +
                                 "<span style='font-size:14px;color:#fff'> Detalle</span>" +
                                 "</button>" +
                                 "</td>" +
                                 "</tr>";


                                    CantidadDeActividadCompletada = 0;
                                    CantidadDeActividad = 0;
                                    ResultadoPorcentaje = 0;
                                    NumeroTicketGraphic = "";
                             }

                        }


                        ContenedorTexto += "</tbody></table>";

                        divContainerTicketAndResponsible.innerHTML = ContenedorTexto;

                        $("#ContainerticketAndResponsible").removeClass("hidden");
                        $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
                        $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
                        $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");


                        $("#btnBuscar").prop('disabled', false);
                       /* $("#BtnExportarExcel").prop('disabled', false);*/
                        //}

                    }
                    else {
                        //estadoCargarGrafico11 = "0";
                        //estadoCargarGrafico11 = "0";

                        /*Grafico 1*/
                        $("#ContainerticketAndResponsible").addClass("hidden");
                        $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
                        $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorListarContainerTicketAndResponsible").removeClass("hidden");
                        $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

                        $("#btnBuscar").prop('disabled', true);
                      /*  $("#BtnExportarExcel").prop('disabled', true);*/

                    }

                } else {

                    //$("#btnBuscarReporteCotizaciones").prop('disabled', false);
                    //estadoCargarGrafico11 = "0";
                    //estadoCargarGrafico11 = "0";
                    /*Grafico 1*/
                    $("#ContainerticketAndResponsible").addClass("hidden");
                    $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                    $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
                    $("#msjVacioContainerTicketAndResponsible").removeClass("hidden");
                    $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
                    $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

                    $("#btnBuscar").prop('disabled', false);
                    //$("#BtnExportarExcel").prop('disabled', false);

                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                //estadoCargarGrafico10 = "0";
                //estadoCargarGrafico11 = "0";
                /*fallo al llamar a la funcion ajax*/
                /*Grafico 1*/
                $("#ContainerticketAndResponsible").addClass("hidden");
                $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                $("#msjErrorContainerTicketAndResponsible").removeClass("hidden");
                $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
                $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
                $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

                $("#btnBuscar").prop('disabled', true);
              /*  $("#BtnExportarExcel").prop('disabled', true);*/

                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });
    }

    function functionListarTicketResponsable(NroTicketValue0) {

        $.ajax({
            type: "GET", /*Puede ser post*/
            url: tRutaServidor + "/ListGeneralActivity/ListDetalleTicketResponsible", /* es importante poner los .. delante*/
            contentType: "application/json; charset=utf-8",
            data: {
                TicketNumber: NroTicketValue0,
            },
            dataType: "json",
            success: function (resultado) {

                /*exitosamente*/
                if (resultado.length > 0) {
                    /* proceso exitoso con datos*/
                    if (resultado[0].ValorConsulta == "1") {

                         var UserRegister = "@User.Identity.Name.ToUpper().ToString()";
                         //console.log(UserRegister);
                         UserRegister = UserRegister.split(',')[2];

                         var UserRegister2 = "@User.Identity.Name.ToUpper().ToString()";
                         //console.log(UserRegister);
                         UserRegister2 = UserRegister2.split(',')[0];

                        IdTicketLst = resultado[0].IdTicket;

                         if (UserRegister == "1" || UserRegister == "2") {

                             //console.log('Responsable o Tiassac');

                             ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>" + " " +
                                                   "<button class='btn-grid btn-xs BtnEdit' type='button' title='Editar'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>";

                             //$("#btnAgregarActivity").prop('disabled', false);

                         } else {

                             //console.log('Usuario normal');
                              //$("#btnAgregarActivity").prop('disabled', true);
                              ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                         }

                         NroTicket = 0;
                         FechaRegistroTicket = "";
                         CallTicket = "";
                         RegisterTicket = "";
                         ResponsibleTicket = "";
                         OperacionTicket = "";
                         RazonTicket = "";
                         LocationTicket = "";
                         CriticidadTicket = "";
                         DetalleTicket = "";

                         NroTicketActivity = resultado[0].NroTicket;
                         NroTicket = resultado[0].NroTicket;
                         FechaRegistroTicket = resultado[0].StartDate;
                         CallTicket = resultado[0].FullNameTicket;
                         RegisterTicket = resultado[0].UsuarioNameTicket;
                         ResponsibleTicket = resultado[0].ResponsibleNameTicket;
                         OperacionTicket = resultado[0].OperationName;
                         RazonTicket = resultado[0].ReasonName;
                         LocationTicket = resultado[0].LocationNameTicket;
                         CriticidadTicket = resultado[0].CriticalityName;
                         DetalleTicket = resultado[0].DetalleText;

                        UserResponsibleId = resultado[0].ResponsibleId;

                         var lblOperacion;
                         lblOperacion = document.getElementById("lblOperationTicket");
                         lblOperacion.innerHTML = OperacionTicket;

                         var lblQuienLlama;
                         lblQuienLlama = document.getElementById("lblWhoCallTicket");
                         lblQuienLlama.innerHTML = CallTicket;

                         var lblQuienRegistra;
                         lblQuienRegistra = document.getElementById("lblWhoRegisterTicket");
                         lblQuienRegistra.innerHTML = RegisterTicket;

                         var lblResponsable;
                         lblResponsable = document.getElementById("lblResponsibleTicket");
                         lblResponsable.innerHTML = ResponsibleTicket;

                         var lblRason;
                         lblRason = document.getElementById("lblReasonTicket");
                         lblRason.innerHTML = RazonTicket;

                         var lblCriticidad;
                         lblCriticidad = document.getElementById("lblCritiziedTicket");
                         lblCriticidad.innerHTML = CriticidadTicket;

                         var lblLocacion;
                         lblLocacion = document.getElementById("lblLocationTicket");
                         lblLocacion.innerHTML = LocationTicket;

                         var lblFechaFin;
                         lblFechaFin = document.getElementById("lblEndDateTicket");
                         lblFechaFin.innerHTML = FechaRegistroTicket;

                         var lblTitleTicket;
                         lblTitleTicket = document.getElementById("lblTitleTicket");
                         lblTitleTicket.innerHTML = resultado[0].TitleDescription;

                         var lblDescripcion;
                         lblDescripcion = document.getElementById("lblDetallerTicket");
                         lblDescripcion.innerHTML = DetalleTicket;

                         //document.getElementById("txtNroTicket").value = NroTicket;
                         //document.getElementById("txtOperacionTicket").value = OperacionTicket;
                         //document.getElementById("txtWhoCall").value = CallTicket;
                         //document.getElementById("txtWhoRegister").value = RegisterTicket;
                         //document.getElementById("txtWhoResponsible").value = ResponsibleTicket;
                         //document.getElementById("txtTicketDate").value = FechaRegistroTicket;
                         //document.getElementById("txtRazonTicket").value = RazonTicket;
                         //document.getElementById("txtLocationTicket").value = LocationTicket;
                         //document.getElementById("lblDetallerTicket").value = DetalleTicket;

                         //if (CriticidadTicket == 'ALTA') {

                         //    document.getElementById("rdoAltaCriticidad").checked = true;
                         //    document.getElementById("rdoMedioCriticidad").checked = false;
                         //    document.getElementById("rdoBajaCriticidad").checked = false;

                         //} else if (CriticidadTicket == 'MEDIA') {

                         //    document.getElementById("rdoAltaCriticidad").checked = false;
                         //    document.getElementById("rdoMedioCriticidad").checked = true;
                         //    document.getElementById("rdoBajaCriticidad").checked = false;


                         //} else if (CriticidadTicket == 'BAJA') {

                         //    document.getElementById("rdoAltaCriticidad").checked = false;
                         //    document.getElementById("rdoMedioCriticidad").checked = false;
                         //    document.getElementById("rdoBajaCriticidad").checked = true;

                         //}

                         let FechaInicioModificado = document.querySelector("#lblFechaInicioAlertas");
                         FechaInicioModificado.innerHTML = "";
                         FechaInicioModificado.innerHTML = FechaRegistroTicket;

                         var titulo;
                         titulo = document.getElementById("lblModelTicketEditAlertas");

                        if (resultado[0].MigrationStatus == 'C') {

                             titulo.innerHTML = NroTicket + " - " + "<span style='color:green'>COMPLETADO</span>";

                         } else {

                             titulo.innerHTML = NroTicket + " - " + "<span style='color:#dada27f7'>PENDIENTE</span>";

                         }

                         //console.log(NroTicket);
                         //console.log(FechaRegistroTicket);
                         //console.log(EncargadoTicket);
                         //console.log(OperacionTicket);
                         //console.log(RazonTicket);
                         //console.log(CriticidadTicket);
                         //console.log(DetalleTicket);

                         if (UserRegister2 == UserResponsibleId) {

                             if (resultado[0].MigrationStatus == 'C') {

                                  $("#btnCerrarTicket").prop('disabled', true);
                                  $("#btnSubirFormatoTicket").prop('disabled', true);
                                  $("#btnSaveVitacora").prop('disabled', true);
                                  $("#btnAgregarActivity").prop('disabled', true);

                                  ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                             } else {

                                 ValidarStatusActividades();

                             }

                         } else {

                             $("#btnCerrarTicket").prop('disabled', true);

                             var UserRegister3 = "@User.Identity.Name.ToUpper().ToString()";
                             //console.log(UserRegister);
                             UserRegister3 = UserRegister3.split(',')[2];

                             if (resultado[0].MigrationStatus == 'C') {

                                  $("#btnCerrarTicket").prop('disabled', true);
                                  $("#btnSubirFormatoTicket").prop('disabled', true);
                                  $("#btnSaveVitacora").prop('disabled', true);
                                  $("#btnAgregarActivity").prop('disabled', true);

                                  if (UserRegister3 == 1 || UserRegister3 == 2) {

                                      ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                                      //$("#btnAgregarActivity").prop('disabled', false);

                                  } else {

                                       ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                                       //$("#btnAgregarActivity").prop('disabled', true);

                                  }


                             } else {

                                  $("#btnCerrarTicket").prop('disabled', true);
                                  $("#btnSubirFormatoTicket").prop('disabled', false);
                                  $("#btnSaveVitacora").prop('disabled', false);
                                  $("#btnAgregarActivity").prop('disabled', false);

                                  if (UserRegister3 == 1 || UserRegister3 == 2) {

                                      ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>" + " " +
                                      "<button class='btn-grid btn-xs BtnEdit' type='button' title='Editar'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>";

                                      //$("#btnAgregarActivity").prop('disabled', false);

                                  } else {

                                      //$("#btnAgregarActivity").prop('disabled', true);

                                       ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                                  }

                             }

                         }

                         ListadoDescripcionVitacora(NroTicketActivity);
                         GrillaListadoActividadAlertas();
                         GrillaListadoArchivoTicket();

                         $('#ModalTicketEdit').modal('show');
                    }
                    else {
                        //estadoCargarGrafico11 = "0";
                        //estadoCargarGrafico11 = "0";

                        /*Grafico 1*/
                        $("#ContainerticketAndResponsible").addClass("hidden");
                        $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
                        $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
                        $("#msjErrorListarContainerTicketAndResponsible").removeClass("hidden");
                        $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

                    }

                } else {

                    //$("#btnBuscarReporteCotizaciones").prop('disabled', false);
                    //estadoCargarGrafico11 = "0";
                    //estadoCargarGrafico11 = "0";
                    /*Grafico 1*/
                    $("#ContainerticketAndResponsible").addClass("hidden");
                    $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                    $("#msjErrorContainerTicketAndResponsible").addClass("hidden");
                    $("#msjVacioContainerTicketAndResponsible").removeClass("hidden");
                    $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
                    $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");

                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                //estadoCargarGrafico10 = "0";
                //estadoCargarGrafico11 = "0";
                /*fallo al llamar a la funcion ajax*/
                /*Grafico 1*/
                $("#ContainerticketAndResponsible").addClass("hidden");
                $("#imgCargaContainerTicketAndResponsible").addClass("hidden");
                $("#msjErrorContainerTicketAndResponsible").removeClass("hidden");
                $("#msjVacioContainerTicketAndResponsible").addClass("hidden");
                $("#msjErrorListarContainerTicketAndResponsible").addClass("hidden");
                $("#msjSuperaLimiteContainerTicketAndResponsible").addClass("hidden");


                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    }
    /* ------------------- EVENTOS -----------------*/

    $("#btnCerrarTicket").click(function () {

            Swal.fire({
                title: 'Estas seguro de cerrar este Ticket?',
                text: "Ya no podras revertirlo!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Si, deseo cerrar!'
            }).then((result) => {
                if (result.isConfirmed) {

                    TicketFinish();

                }

            });

        });

    $("#btnAgregarEditar").click(function () {

            if ($("#txtActivityTicket").val() == "" || $("#txtActivityTicket").val() == null || $("#txtActivityTicket").val() == undefined) {
                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar la Actividad", tTituloError); $toastlast = $toast;
                return;
            }

            if ($("#selectorResponsableActivity").val() == "" || $("#selectorResponsableActivity").val() == null || $("#selectorResponsableActivity").val() == undefined) {
                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar el Responsable de la ctividad", tTituloError); $toastlast = $toast;
                return;
            }

            if ($("#txtActivityDateEnd").val() == "" || $("#txtActivityDateEnd").val() == null || $("#txtActivityDateEnd").val() == undefined) {
                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar la Fecha de Cierre", tTituloError); $toastlast = $toast;
                return;
            }


            Swal.fire({
                title: 'Estas seguro de editar esta actividad?',
                text: "Consultar antes de editar para no generar inconvenientes",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Si, estoy seguro!'
            }).then((result) => {
                if (result.isConfirmed) {

                    TextActivity = $("#txtActivityTicket").val();
                    //TextDetalleActivity = $("#txtDetalleActivity").val();
                    IdResponsibleActivity = $('#selectorResponsableActivity').val()[0];
                    FechaEndActivity = $("#txtActivityDateEnd").val();

                    EditarActivity();

                } else {



                }
            });
        });

    $("#btnAgregarActivity").click(function () {

         if ($("#txtActivityTicket").val() == "" || $("#txtActivityTicket").val() == null || $("#txtActivityTicket").val() == undefined) {
             toastr.options.timeOut = nTiempoCorto;
             toastr.options.extendedTimeOut = nTiempoCorto;
             /*success - info - warning - error*/
             var $toast = toastr["error"]("Es necesario ingresar la Actividad", tTituloError); $toastlast = $toast;
             return;
         }

         if ($("#selectorResponsableActivity").val() == "" || $("#selectorResponsableActivity").val() == null || $("#selectorResponsableActivity").val() == undefined) {
             toastr.options.timeOut = nTiempoCorto;
             toastr.options.extendedTimeOut = nTiempoCorto;
             /*success - info - warning - error*/
             var $toast = toastr["error"]("Es necesario ingresar el Responsable de la ctividad", tTituloError); $toastlast = $toast;
             return;
         }

         if ($("#txtActivityDateEnd").val() == "" || $("#txtActivityDateEnd").val() == null || $("#txtActivityDateEnd").val() == undefined) {
             toastr.options.timeOut = nTiempoCorto;
             toastr.options.extendedTimeOut = nTiempoCorto;
             /*success - info - warning - error*/
             var $toast = toastr["error"]("Es necesario ingresar la Fecha de Cierre", tTituloError); $toastlast = $toast;
             return;

         } else {

             var ValorFechaEnd = "";

             ValorFechaEnd = $("#txtActivityDateEnd").val();

             ValorFechaEnd = ValorFechaEnd.length;

             if ( ValorFechaEnd != 19 || ValorFechaEnd != 19) {
                 toastr.options.timeOut = nTiempoCorto;
                 toastr.options.extendedTimeOut = nTiempoCorto;
                 /*success - info - warning - error*/
                 var $toast = toastr["error"]("Es necesario ingresar una hora correspondiente", tTituloError); $toastlast = $toast;
                 return;
             }

         }

         var UserRegister = "@User.Identity.Name.ToUpper().ToString()";
         UserRegister = UserRegister.split(',')[2];

         if (UserRegister == "1" || UserRegister == "2") {

             Swal.fire({
                 title: 'Estas seguro de generar esta actividad?',
                 text: "Ya no podras revertirla!",
                 icon: 'warning',
                 showCancelButton: true,
                 confirmButtonColor: '#3085d6',
                 cancelButtonColor: '#d33',
                 confirmButtonText: 'Si, estoy acuerdo!'
             }).then((result) => {
                 if (result.isConfirmed) {

                     TextActivity = $("#txtActivityTicket").val();
                     //TextDetalleActivity = $("#txtDetalleActivity").val();
                     IdResponsibleActivity = $('#selectorResponsableActivity').val()[0];
                     FechaEndActivity = $("#txtActivityDateEnd").val();

                     RegistrarActivity();

                 } else {



                 }
             });

         } else {

             Swal.fire({
                 icon: 'error',
                 title: 'Accion Denegada...',
                 html: '<p>Solo puede ingresar actividades el <span style="color:red"><i>responsable</i></span> del ticket!</p>'
                 //footer: '<a href="">Why do I have this issue?</a>'
             });
         }

    });

    $("#btnInvitadosPanel").click(function () {

            $('#ModalInvitados').modal('show');

        });

    $("#btnCancelarcorreoTicket").click(function () {

            $('#ModalInvitados').modal('hide');

        });

    $("#btnEnviarCorreoTicket").click(function () {

            if ($("#selectorInvitados2").val() == null || $("#selectorInvitados2").val() == "" || $("#selectorInvitados2").val() == undefined) {
                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar un invitado", tTituloError); $toastlast = $toast;
                return;
            }

            if ($("#lblDetalleCorreo").val() == null || $("#lblDetalleCorreo").val() == "" || $("#lblDetalleCorreo").val() == undefined) {
                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar un Asunto", tTituloError); $toastlast = $toast;
                return;
            }

            ReenviarDescripcionTicket();

        });

    $("#btnSaveVitacora").click(function () {

            if ($("#txtVitacoraTextSend").val() == "" || $("#txtVitacoraTextSend").val() == null || $("#txtVitacoraTextSend").val() == undefined) {

                toastr.options.timeOut = nTiempoCorto;
                toastr.options.extendedTimeOut = nTiempoCorto;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Es necesario ingresar la descripción para guardar", tTituloError); $toastlast = $toast;
                return;

            } else {

                ActualizarRegistrarVitacora();

            }

        });

    $("#btnCancelar").click(function () {

            $('#ModalTicketEdit').modal('hide');

        });

    $("#btnBuscar").click(function () {

        var IdsReponsibleTable = "";

        var TextResponsible = "";

        TextResponsible = $("#selectorResponsible").val();

        if (TextResponsible == '' || TextResponsible == null) {

            IdsReponsibleTable = '0'          

        } else {

            IdsReponsibleTable = TextResponsible;
            IdsReponsibleTable = IdsReponsibleTable.toString();

        }

        ListadoTablaTicketYResponsable(StatusTicketRadio, IdsReponsibleTable);
    });

    $("#BtnExportarExcel").click(function () {

            if (Valor == 1) {

                ExportarExcel("LstGeneralActivity");

            } else {

                ExportarExcel("LstGeneralActivity");

            }


        });

    $('#selectorInvitados2').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
            /*SelectInvitados = $('#selectorInvitados').val();*/

            SelectorInvitadosActividad = "";

            if ($('#selectorInvitados2').val()) {

                for (i = 0; i < $('#selectorInvitados2').val().length; i++) {

                    SelectorInvitadosActividad += $('#selectorInvitados2').val()[i] + ";";

                }

                SelectorInvitadosActividad = SelectorInvitadosActividad.substring(0, SelectorInvitadosActividad.length - 1);

                console.log(SelectorInvitadosActividad);
                //SelectInvitados = SelectInvitados[0];

                //console.log(SelectInvitados);
                //ComboEncargado('0');
                //console.log(IdOperatorTicket);

            } else {
                SelectorInvitadosActividad = "";
            }

        });

    $("#GrillaLstActivityAddAlertas").delegate(".BtnVerInfo", "click", function (e) {

         var grid = $("#GrillaLstActivityAddAlertas").data("kendoGrid");
         var myVar = grid.dataItem($(this).closest("tr"));
         var IdValidation = myVar.ValidationButton;

         var UserWebPage = "@User.Identity.Name.ToUpper().ToString()";
         UserWebPage = UserWebPage.split(',')[0];

         idActivity = myVar.IdActivity;
         IdResponsibleCritizity = myVar.IdResponsible;

         var usuarioRegistradorNombre = "@User.Identity.Name.ToUpper().ToString()";
         usuarioRegistradorNombre = usuarioRegistradorNombre.split(',')[4];

         var TxtQuienFormato;
         TxtQuienFormato = document.getElementById("lblDeQuienFormato");
         TxtQuienFormato.innerHTML = usuarioRegistradorNombre;

         var TxtOperacionActividad;
         TxtOperacionActividad = document.getElementById("lblOperacionFormato");
         TxtOperacionActividad.innerHTML = OperacionTicket;

         var TxtActivityTitle;
         TxtActivityTitle = document.getElementById("lblNameActivityText");
         TxtActivityTitle.innerHTML = myVar.ActivityText;

         ListadoDetalleActividadInforme();

         //ListadoDetalleActividadInforme()
         LimpiarEtiquetasActivityInform();
         ListadoDescripcionVitacoraActivityDetail(idActivity);

         document.getElementById("txtPorcentajeIngresado").value = "";
         document.getElementById("txtVitacoraTextSend").value = "";

         document.getElementById("flArchivoSubirAdjunto").value = "";

         //console.log();
         EditarPercentage();

         if (UserWebPage == UserResponsibleId) {

             $("#chkValidationResponsible").prop('disabled', false);
             $("#chkValidationJefeArea").prop('disabled', false);
             $("#btValidationResponsible").prop('disabled', false);

         } else {

             $("#chkValidationResponsible").prop('disabled', true);
             $("#chkValidationJefeArea").prop('disabled', true);
             $("#btValidationResponsible").prop('disabled', true);

         }

         //if (IdValidation == '0') {

         //    $("#btnFinalizar").prop('disabled', true);

         //} else {

         //    $("#btnFinalizar").prop('disabled', false);

         //}

         if (myVar.Estado == 'COMPLETADO') {

             //$("#btnFinalizar").prop('disabled', true);
             $("#btnSaveInforme").prop('disabled', true);
             $("#btnRegisterPercentage").prop('disabled', true);
             $("#btnSaveVitacoraActivityDetail").prop('disabled', true);
             $("#btnSubirFormato").prop('disabled', true);
             $("#btValidationResponsible").prop('disabled', true);
             //$("#btnFinalizar").prop('disabled', true);

             document.getElementById("chkValidationResponsible").checked = true;
             document.getElementById("chkValidationJefeArea").checked = false;
         } else {

             $("#btnSaveInforme").prop('disabled', false);
             $("#btnRegisterPercentage").prop('disabled', false);
             $("#btnSaveVitacoraActivityDetail").prop('disabled', false);
             $("#btnSubirFormato").prop('disabled', false);
             //$("#btValidationResponsible").prop('disabled', true);
             //$("#btnFinalizar").prop('disabled', true);
             /*$("#btnFinalizar").prop('disabled', false);*/

             document.getElementById("chkValidationResponsible").checked = false;
             document.getElementById("chkValidationJefeArea").checked = false;

         }

         $('#ModalActivityDetail').modal('show');
    });

    $("#GrillaLstActivityAddAlertas").delegate(".BtnEdit", "click", function (e) {

       var grid = $("#GrillaLstActivityAddAlertas").data("kendoGrid");
       var myVar = grid.dataItem($(this).closest("tr"));

       var UserWebPage = "@User.Identity.Name.ToUpper().ToString()";
       UserWebPage = UserWebPage.split(',')[0];

       Swal.fire({
            title: 'Estas seguro de mostrar los datos de la actividad para editarla ?',
            //text: "Estar seguro !",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, deseo editar!'
       }).then((result) => {

           if (result.isConfirmed) {

               $("#CargaTemporal").removeClass("hidden");

               idActivity = myVar.IdActivity;

               document.getElementById("txtActivityTicket").value = myVar.ActivityText;
               document.getElementById("txtActivityDateEnd").value = myVar.FechaCierre;
               $("#selectorResponsableActivity").val(myVar.IdResponsibleActivity).change();

               $("#btnAgregarActivity").addClass("hidden");
               $("#btnAgregarEditar").removeClass("hidden");


               $("#CargaTemporal").addClass("hidden");

           } else {



           }

        });

            //$('#ModalActivityDetail').modal('show');
    });

    $("#LstGeneralActivity").delegate(".BtnVerInfo", "click", function (e) {

           var grid = $("#LstGeneralActivity").data("kendoGrid");
           var myVar = grid.dataItem($(this).closest("tr"));

           var UserRegister = "@User.Identity.Name.ToUpper().ToString()";
           //console.log(UserRegister);
           UserRegister = UserRegister.split(',')[2];

           var UserRegister2 = "@User.Identity.Name.ToUpper().ToString()";
           //console.log(UserRegister);
           UserRegister2 = UserRegister2.split(',')[0];

           IdTicketLst = myVar.IdTicket;

           if (UserRegister == "1" || UserRegister == "2") {

               //console.log('Responsable o Tiassac');

               ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>" + " " +
                                     "<button class='btn-grid btn-xs BtnEdit' type='button' title='Editar'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>";

               //$("#btnAgregarActivity").prop('disabled', false);

           } else {

               //console.log('Usuario normal');
                //$("#btnAgregarActivity").prop('disabled', true);
                ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

           }

           NroTicket = 0;
           FechaRegistroTicket = "";
           CallTicket = "";
           RegisterTicket = "";
           ResponsibleTicket = "";
           OperacionTicket = "";
           RazonTicket = "";
           LocationTicket = "";
           CriticidadTicket = "";
           DetalleTicket = "";

           NroTicketActivity = myVar.NroTicket;
           NroTicket = myVar.NroTicket;
           FechaRegistroTicket = myVar.StartDate;
           CallTicket = myVar.FullNameTicket;
           RegisterTicket = myVar.UsuarioNameTicket;
           ResponsibleTicket = myVar.ResponsibleNameTicket;
           OperacionTicket = myVar.OperationName;
           RazonTicket = myVar.ReasonName;
           LocationTicket = myVar.LocationNameTicket;
           CriticidadTicket = myVar.CriticalityName;
           DetalleTicket = myVar.DetalleText;

           UserResponsibleId = myVar.ResponsibleId;

           var lblOperacion;
           lblOperacion = document.getElementById("lblOperationTicket");
           lblOperacion.innerHTML = OperacionTicket;

           var lblQuienLlama;
           lblQuienLlama = document.getElementById("lblWhoCallTicket");
           lblQuienLlama.innerHTML = CallTicket;

           var lblQuienRegistra;
           lblQuienRegistra = document.getElementById("lblWhoRegisterTicket");
           lblQuienRegistra.innerHTML = RegisterTicket;

           var lblResponsable;
           lblResponsable = document.getElementById("lblResponsibleTicket");
           lblResponsable.innerHTML = ResponsibleTicket;

           var lblRason;
           lblRason = document.getElementById("lblReasonTicket");
           lblRason.innerHTML = RazonTicket;

           var lblCriticidad;
           lblCriticidad = document.getElementById("lblCritiziedTicket");
           lblCriticidad.innerHTML = CriticidadTicket;

           var lblLocacion;
           lblLocacion = document.getElementById("lblLocationTicket");
           lblLocacion.innerHTML = LocationTicket;

           var lblFechaFin;
           lblFechaFin = document.getElementById("lblEndDateTicket");
           lblFechaFin.innerHTML = FechaRegistroTicket;

           var lblTitleTicket;
           lblTitleTicket = document.getElementById("lblTitleTicket");
           lblTitleTicket.innerHTML = myVar.TitleDescription;

           var lblDescripcion;
           lblDescripcion = document.getElementById("lblDetallerTicket");
           lblDescripcion.innerHTML = DetalleTicket;

           //document.getElementById("txtNroTicket").value = NroTicket;
           //document.getElementById("txtOperacionTicket").value = OperacionTicket;
           //document.getElementById("txtWhoCall").value = CallTicket;
           //document.getElementById("txtWhoRegister").value = RegisterTicket;
           //document.getElementById("txtWhoResponsible").value = ResponsibleTicket;
           //document.getElementById("txtTicketDate").value = FechaRegistroTicket;
           //document.getElementById("txtRazonTicket").value = RazonTicket;
           //document.getElementById("txtLocationTicket").value = LocationTicket;
           //document.getElementById("lblDetallerTicket").value = DetalleTicket;

           let FechaInicioModificado = document.querySelector("#lblFechaInicioAlertas");
           FechaInicioModificado.innerHTML = "";
           FechaInicioModificado.innerHTML = FechaRegistroTicket;

           var titulo;
           titulo = document.getElementById("lblModelTicketEditAlertas");

           if (myVar.MigrationStatus == 'C') {

               titulo.innerHTML = NroTicket + " - " + "<span style='color:green'>COMPLETADO</span>";

           } else {

               titulo.innerHTML = NroTicket + " - " + "<span style='color:#dada27f7'>PENDIENTE</span>";

           }

           //console.log(NroTicket);
           //console.log(FechaRegistroTicket);
           //console.log(EncargadoTicket);
           //console.log(OperacionTicket);
           //console.log(RazonTicket);
           //console.log(CriticidadTicket);
           //console.log(DetalleTicket);

           if (UserRegister2 == UserResponsibleId) {

               if (myVar.MigrationStatus == 'C') {

                    $("#btnCerrarTicket").prop('disabled', true);
                    $("#btnSubirFormatoTicket").prop('disabled', true);
                    $("#btnSaveVitacora").prop('disabled', true);
                    $("#btnAgregarActivity").prop('disabled', true);

                    ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

               } else {

                   ValidarStatusActividades();

               }

           } else {

               $("#btnCerrarTicket").prop('disabled', true);

               var UserRegister3 = "@User.Identity.Name.ToUpper().ToString()";
               //console.log(UserRegister);
               UserRegister3 = UserRegister3.split(',')[2];

               if (myVar.MigrationStatus == 'C') {

                    $("#btnCerrarTicket").prop('disabled', true);
                    $("#btnSubirFormatoTicket").prop('disabled', true);
                    $("#btnSaveVitacora").prop('disabled', true);
                    $("#btnAgregarActivity").prop('disabled', true);

                    if (UserRegister3 == 1 || UserRegister3 == 2) {

                        ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                        //$("#btnAgregarActivity").prop('disabled', false);

                    } else {

                         ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                         //$("#btnAgregarActivity").prop('disabled', true);

                    }


               } else {

                    $("#btnCerrarTicket").prop('disabled', true);
                    $("#btnSubirFormatoTicket").prop('disabled', false);
                    $("#btnSaveVitacora").prop('disabled', false);
                    $("#btnAgregarActivity").prop('disabled', false);

                    if (UserRegister3 == 1 || UserRegister3 == 2) {

                        ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>" + " " +
                        "<button class='btn-grid btn-xs BtnEdit' type='button' title='Editar'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>";

                        //$("#btnAgregarActivity").prop('disabled', false);

                    } else {

                        //$("#btnAgregarActivity").prop('disabled', true);

                         ButtonsGridActivity = "<button class='btn-grid btn-xs BtnVerInfo' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-eye'></i></button>";

                    }

               }

           }

           ListadoDescripcionVitacora(NroTicketActivity);
           GrillaListadoActividadAlertas();
           GrillaListadoArchivoTicket();

         $('#ModalTicketEdit').modal('show');

        });

    /*------- ADJUNTAR ARCHIVO ---- LISTADO TICKET --------*/

    function SubirArchivoTicketPanel() {

        var fileData = new FormData();
        var fileUpload = $("#flArchivoSubirAdjuntoTicket2").get(0);
        var files = fileUpload.files;

        for (var i = 0; i < files.length; i++) {
            fileData.append(files[i].name, files[i]);
        }
        //$("#GrillaArchivos").addClass("hidden");
        //$("#ContenedorTablaAdjuntos").addClass("hidden");
        //$("#ImagenCargaListArchivo").removeClass("hidden");
        //$("#MensajeErrorListArchivo").addClass("hidden");
        //$("#MensajeVacioListArchivo").addClass("hidden");
        //$("#MensajeErrorListarListArchivo").addClass("hidden");

        $.ajax({
            type: "POST",
            url: tRutaServidor + "/PathFile/SubirArchivoTicket?FileType=" + "P" + "&IdRegister=" + IdTicketLst + "&TableAbrev=" + "TCK" + "&NombreCarpeta=" + "TicketArchivo" + "&OperacionName=" + "OPERACION",
            data: fileData,
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            success: function (resultado) {

                if (resultado.length > 0) {

                    if (resultado[0].ValorConsulta == "1") {

                        $("#flArchivoSubirAdjuntoTicket2").filestyle('clear');

                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                        //idsPathFileTicketDoc.push(resultado[0].IdPathFile);

                        //if (idsPathFileTicketDoc.length > 4) {
                        idsPathFileTicketDoc = [];
                        arrayArchivosHistoricos = [];


                        GrillaListadoArchivoTicket();
                        //}
                        //ListadoDetalleActividadInforme();
                        //ListadoDetalleActividadInforme();
                        //GrillaArchivosCargados();

                    } else if (resultado[0].ValorConsulta == "102") {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tValidacionTipoArchivo, tTituloError); $toastlast = $toast;

                        //$("#CargaTemporal").addClass("hidden");
                        //$("#ContenedorTablaAdjuntos").removeClass("hidden");
                        //$("#ImagenCargaListArchivo").addClass("hidden");
                        //$("#MensajeErrorListArchivo").addClass("hidden");
                        //$("#MensajeVacioListArchivo").addClass("hidden");
                        //$("#MensajeErrorListarListArchivo").addClass("hidden");
                        //document.getElementById('btnSubirFormato').disabled = false;

                    } else if (resultado[0].ValorConsulta == "101") {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tValidacionPesoArchivo, tTituloError); $toastlast = $toast;

                        //$("#CargaTemporal").addClass("hidden");
                        //$("#ContenedorTablaAdjuntos").removeClass("hidden");
                        //$("#ImagenCargaListArchivo").addClass("hidden");
                        //$("#MensajeErrorListArchivo").addClass("hidden");
                        //$("#MensajeVacioListArchivo").addClass("hidden");
                        //$("#MensajeErrorListarListArchivo").addClass("hidden");
                        //document.getElementById('btnSubirFormato').disabled = false;

                    } else {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado)
                        //$("#CargaTemporal").addClass("hidden");
                        //$("#ContenedorTablaAdjuntos").removeClass("hidden");
                        //$("#ImagenCargaListArchivo").addClass("hidden");
                        //$("#MensajeErrorListArchivo").addClass("hidden");
                        //$("#MensajeVacioListArchivo").addClass("hidden");
                        //$("#MensajeErrorListarListArchivo").addClass("hidden");
                        //document.getElementById('btnSubirFormato').disabled = false;
                    }
                } else {

                }
                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {

                //$("#CargaTemporal").addClass("hidden");
                //$("#ContenedorTablaAdjuntos").removeClass("hidden");
                //$("#ImagenCargaListArchivo").addClass("hidden");
                //$("#MensajeErrorListArchivo").addClass("hidden");
                //$("#MensajeVacioListArchivo").addClass("hidden");
                //$("#MensajeErrorListarListArchivo").addClass("hidden");
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    };

    $("#btnSubirFormatoTicket2").click(function () {

        if (idsPathFileTicketDocTicket.length >= 0) {

            if ($('#flArchivoSubirAdjuntoTicket2').val() != "") {

                var TamañoArchivo = $("#flArchivoSubirAdjuntoTicket2")[0].files[0].size;

                if (TamañoArchivo > 5000000) {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tValidacionExcedeTamanioArchivoError, tTituloError); $toastlast = $toast;
                    return;
                }

                //Swal.fire({
                //    title: 'Estas seguro de guardar este archivo?',
                //    text: "Ya no podras revertirlo!",
                //    icon: 'warning',
                //    showCancelButton: true,
                //    confirmButtonColor: '#3085d6',
                //    cancelButtonColor: '#d33',
                //    confirmButtonText: 'Si, deseo guardar!'
                //}).then((result) => {
                //    if (result.isConfirmed) {

                SubirArchivoTicketPanel();

                //    } else {



                //    }
                //});

            } else {
                toastr.options.timeOut = nTiempoMedio;
                toastr.options.extendedTimeOut = nTiempoMedio;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tValidacionSeleccionaArchivoError, tTituloError); $toastlast = $toast;
            }
        }
        else {
            toastr.options.timeOut = nTiempoMedio;
            toastr.options.extendedTimeOut = nTiempoMedio;
            /*success - info - warning - error*/
            var $toast = toastr["error"]("Solo se puede ingresar " + "1 archivo.", tTituloError); $toastlast = $toast;
        }
    });

    function GrillaListadoArchivoTicket() {

        $("#CargaTemporal").removeClass("hidden");

        $("#GrillaLstArchivoTicket").addClass("hidden");
        $("#imgCargaLstArchivoTicket").removeClass("hidden");
        $("#msjErrorLstArchivoTicket").addClass("hidden");
        $("#msjVacioLstArchivoTicket").addClass("hidden");
        $("#msjErrorListarLstArchivoTicket").addClass("hidden");
        $("#msjSuperaLimiteLstArchivoTicket").addClass("hidden");

        var dataSource = new kendo.data.DataSource({
            transport: {
                read: function (options) {
                    $.ajax({
                        type: "GET",
                        url: tRutaServidor + "/Ticket/ListarArchivoTicket", /* es importante poner los .. delante*/
                        data: {
                            IdTicket: IdTicketLst
                        },
                        dataType: "json",
                        /*async: false,*/
                        success: function (resultado) {
                            /*exitosamente*/
                            if (resultado.length > 0) {
                                /* proceso exitoso con datos*/

                                if (resultado[0].ValorConsulta == "1") {

                                    $("#GrillaLstArchivoTicket").removeClass("hidden");
                                    $("#imgCargaLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorLstArchivoTicket").addClass("hidden");
                                    $("#msjVacioLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorListarLstArchivoTicket").addClass("hidden");
                                    $("#msjSuperaLimiteLstArchivoTicket").addClass("hidden");

                                    $("#CargaTemporal").addClass("hidden");

                                } else if (resultado[0].ValorConsulta == "-1") {

                                    $("#GrillaLstArchivoTicket").addClass("hidden");
                                    $("#imgCargaLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorLstArchivoTicket").addClass("hidden");
                                    $("#msjVacioLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorListarLstArchivoTicket").addClass("hidden");
                                    $("#msjSuperaLimiteLstArchivoTicket").removeClass("hidden");

                                }
                                else {
                                    /* proceso fallido catch listado datos*/
                                    $("#GrillaLstArchivoTicket").addClass("hidden");
                                    $("#imgCargaLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorLstArchivoTicket").addClass("hidden");
                                    $("#msjVacioLstArchivoTicket").addClass("hidden");
                                    $("#msjErrorListarLstArchivoTicket").removeClass("hidden");
                                    $("#msjSuperaLimiteLstArchivoTicket").addClass("hidden");

                                    console.log(resultado);
                                }

                            } else {
                                $("#GrillaLstArchivoTicket").addClass("hidden");
                                $("#imgCargaLstArchivoTicket").addClass("hidden");
                                $("#msjErrorLstArchivoTicket").addClass("hidden");
                                $("#msjVacioLstArchivoTicket").removeClass("hidden");
                                $("#msjErrorListarLstArchivoTicket").addClass("hidden");
                                $("#msjSuperaLimiteLstArchivoTicket").addClass("hidden");


                                $("#CargaTemporal").addClass("hidden");
                            }

                            $("#CargaTemporal").addClass("hidden");

                            options.success(resultado);
                            var grid = $("#GrillaLstArchivoTicket").data("kendoGrid");
                            if (grid.dataSource.total() > 0) {
                                grid.setDataSource(dataSource);
                            }

                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            /*fallo al llamar a la funcion ajax*/
                            $("#GrillaLstArchivoTicket").addClass("hidden");
                            $("#imgCargaLstArchivoTicket").addClass("hidden");
                            $("#msjErrorLstArchivoTicket").removeClass("hidden");
                            $("#msjVacioLstArchivoTicket").addClass("hidden");
                            $("#msjErrorListarLstArchivoTicket").addClass("hidden");
                            $("#msjSuperaLimiteLstArchivoTicket").addClass("hidden");

                            console.log("ERROR AJAX : " + ajaxOptions);
                            console.log("ERROR AJAX : " + thrownError);
                            console.log(xhr.responseText);
                            console.log(xhr);

                        }
                    });
                },
                parameterMap: function (data, operation) {
                    if (operation !== "read" && data.models) {
                        return JSON.stringify({ JSONparam: data.models });
                    }
                }
            },
            error: function (e) {
                alert("Status: " + e.status + "; Error message: " + e.errorThrown);
            },
            batch: false,
            pageSize: PaginationKendoGrid,
            schema: {
                model: {
                    fields: {
                        IdPathFile: { type: "number" },
                        FileTableAbbreviation: { type: "string" },
                        IdRegister: { type: "number" },
                        PathFile: { type: "string" },
                        FileNameRegister: { type: "string" },
                        FileSize: { type: "string" },
                        FullName: { type: "string" },
                        RegistrationDateString: { type: "string" }
                    }
                }
            },
            //aggregate: [
            //    {
            //        field: "TicketNumber",
            //        aggregate: "count"
            //    },
            //    {
            //        field: "FuelQuantity",
            //        aggregate: "sum"
            //    }
            //]
        });

        $("#GrillaLstArchivoTicket").kendoGrid({
            dataSource: dataSource,
            sortable: true,
            pageable: true,
            columnMenu: true,
            columnMenu: {
                sortable: true,
                filterable: true,
                columns: true,
                messages: {
                    columns: KendoMsjColumnMenuColumns,
                    filter: KendoMsjColumnMenuFilter,
                    sortAscending: KendoMsjColumnMenuSortAscending,
                    sortDescending: KendoMsjColumnMenuSortDescending,
                    settings: KendoMsjSettings
                }
            },
            columnMenuInit: function (e) {
                var menu = e.container.find(".k-menu").data("kendoMenu");
                menu.bind("select", function (e) {
                    var EtiquetaInput = $(".k-animation-container > .k-menu-group > .k-item > .k-content > .k-filter-menu > .k-textbox :input");
                    EtiquetaInput.focus();
                });
            },
            groupable: false,
            reorderable: true,
            selectable: "row",
            scrollable: true,
            resizable: true,
            filterable: {
                multi: true,
                checkAll: true,
                search: true,
                messages: {
                    clear: KendoMsjClear,
                    filter: KendoMsjFilter,
                    selectedItemsFormat: KendoMsjSelectedItemsFormat,
                    checkAll: KendoMsjCheckAll,
                    search: KendoMsjSearch
                }
            },
            //groupable: {
            //    info: true,
            //    messages: {
            //        empty: "<b style='font-style:italic';>Arrastre una cabecera aquí para agrupar su información por esa columna</b>"
            //    }
            //},
            pageable: {
                messages: {
                    empty: KendoMsjEmpty,
                    page: kendoMsjPage,
                    of: KendoMsjOf,
                    itemsPerPage: KendoMsjItemsPerPage,
                    first: KendoMsjFirst,
                    last: KendoMsjLast,
                    next: KendoMsjNext,
                    previous: KendoMsjPrevious,
                    refresh: KendoMsjRefresh,
                    morePages: KendoMsjMorePages,
                    display: KendoMsjDisplay
                },
                refresh: false,
                pageSizes: true,
                pageSizes: [5, 10, 15],
                /*para la cantidad de paginas se sugieren 5*/
                buttonCount: 5,
                /*Posicion de la pagina*/
                pageSize: 5
            },
            //excel: { fileName: "Listado de Acta de Reunión.xlsx", filterable: true, allPages: true },
            columns: [
                {
                    width: 100,
                    command: {
                        template:
                            "<button class='btn-grid btn-xs BtnDescargarArchivo' type='button' title='Descargar'><i class='fa fa-lg fa-fw fas fa-cloud-download'></i></button>"
                            + " " + "<button class='btn-grid btn-xs BtnAnular' type='button' title='Eliminar'><i class='fa fa-trash-o fa-lg'></i></button>"
                    },
                    attributes: { "class": "text-center" },
                    title: ""
                },
                { field: "IdPathFile", title: "IdPath", hidden: true, width: 120, attributes: { "class": "text-center" } },
                { field: "IdRegister", title: "IdRegister", hidden: true, width: 120, attributes: { "class": "text-center" } },
                { field: "PathFile", title: "PathFile", hidden: true, width: 120, attributes: { "class": "text-center" } },
                { field: "FileNameRegister", title: "Nombre Archivo", width: 200, attributes: { "class": "text-left" } },
                { field: "FileSize", title: "Tamaño Archivo", width: 150, attributes: { "class": "text-left" } },
                { field: "FullName", title: "Registrado por", width: 200, attributes: { "class": "text-left" } },
                { field: "RegistrationDateString", title: "Registrado", width: 160, attribute: { "class": "text-center" } }
            ],
            dataBound: function () {


            }
        });


    }

    $("#GrillaLstArchivoTicket").delegate(".BtnDescargarArchivo", "click", function (e) {

        var grid = $("#GrillaLstArchivoTicket").data("kendoGrid");
        var myVar = grid.dataItem($(this).closest("tr"));
        //idRutaArchivo = myVar.IdPathFile;

        //$("#ImagenCargaListArchivo").addClass("hidden");

        //e.preventDefault();  //stop the browser from following
        //window.location.href = myVar.PathFile;

        window.open(myVar.PathFile, '_blank');
    });

    $("#GrillaLstArchivoTicket").delegate(".BtnAnular", "click", function (e) {

        var grid = $("#GrillaLstArchivoTicket").data("kendoGrid");
        var myVar = grid.dataItem($(this).closest("tr"));

        var IdArchivoTicket = myVar.IdPathFile;

        Swal.fire({
            title: 'Estas seguro de eliminar este archivo?',
            text: "Ya no podras revertirlo!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, estoy seguro!'
        }).then((result) => {
            if (result.isConfirmed) {

                AnularArchivoTicket(IdArchivoTicket);

            } else {

            }
        });


    });

    function AnularArchivoTicket(ValorArchivoTicket) {

        //$("#CargaTemporal").removeClass("hidden");

        $.ajax({
            type: "POST",
            url: tRutaServidor + "/Ticket/AnularArchivoTicket",
            dataType: "json",
            data: {
                IdTicketFile: ValorArchivoTicket,
            },
            success: function (resultado) {

                //if (resultado.length > 0) {

                if (resultado != '0') {

                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["success"]("Se ha eliminado el archivo con exito", tTituloExito); $toastlast = $toast;

                    GrillaListadoArchivoTicket();

                } else {

                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                    console.log("Mensaje del error : " + resultado);

                }

                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    };

    /*------- ADJUNTAR ARCHIVO ---- EDITAR ACTIVIDAD --------*/

    function SubirArchivo() {

        var fileData = new FormData();
        var fileUpload = $("#flArchivoSubirAdjunto").get(0);
        var files = fileUpload.files;

        for (var i = 0; i < files.length; i++) {
            fileData.append(files[i].name, files[i]);
        }

        $("#GrillaArchivos").addClass("hidden");
        $("#ContenedorTablaAdjuntos").addClass("hidden");
        $("#ImagenCargaListArchivo").removeClass("hidden");
        $("#MensajeErrorListArchivo").addClass("hidden");
        $("#MensajeVacioListArchivo").addClass("hidden");
        $("#MensajeErrorListarListArchivo").addClass("hidden");

        $.ajax({
            type: "POST",
            url: tRutaServidor + "/PathFile/SubirArchivoActivity?FileType=" + "P" + "&IdRegister=" + idActivity + "&TableAbrev=" + "ACTV" + "&NombreCarpeta=" + "ActividadTicket" + "&OperacionName=" + OperacionTicket,
            data: fileData,
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            success: function (resultado) {
                if (resultado.length > 0) {

                    if (resultado[0].ValorConsulta == "1") {

                        $("#flArchivoSubirAdjunto").filestyle('clear');
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["success"](tMensajeCreadoExito, tTituloExito); $toastlast = $toast;

                        //idsPathFileTicketDoc.push(resultado[0].IdPathFile);

                        //if (idsPathFileTicketDoc.length > 4) {
                        //    document.getElementById('flArchivoSubirAdjunto').disabled = true;
                        //    document.getElementById('btnSubirFormato').disabled = true;
                        //}
                        ListadoDetalleActividadInforme();
                        //ListadoDetalleActividadInforme();
                        //GrillaArchivosCargados();

                    } else if (resultado[0].ValorConsulta == "102") {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tValidacionTipoArchivo, tTituloError); $toastlast = $toast;

                        $("#CargaTemporal").addClass("hidden");
                        $("#ContenedorTablaAdjuntos").removeClass("hidden");
                        $("#ImagenCargaListArchivo").addClass("hidden");
                        $("#MensajeErrorListArchivo").addClass("hidden");
                        $("#MensajeVacioListArchivo").addClass("hidden");
                        $("#MensajeErrorListarListArchivo").addClass("hidden");
                        document.getElementById('btnSubirFormato').disabled = false;

                    } else if (resultado[0].ValorConsulta == "101") {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tValidacionPesoArchivo, tTituloError); $toastlast = $toast;

                        $("#CargaTemporal").addClass("hidden");
                        $("#ContenedorTablaAdjuntos").removeClass("hidden");
                        $("#ImagenCargaListArchivo").addClass("hidden");
                        $("#MensajeErrorListArchivo").addClass("hidden");
                        $("#MensajeVacioListArchivo").addClass("hidden");
                        $("#MensajeErrorListarListArchivo").addClass("hidden");
                        document.getElementById('btnSubirFormato').disabled = false;

                    } else {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        console.log("Mensaje del error : " + resultado)
                        $("#CargaTemporal").addClass("hidden");
                        $("#ContenedorTablaAdjuntos").removeClass("hidden");
                        $("#ImagenCargaListArchivo").addClass("hidden");
                        $("#MensajeErrorListArchivo").addClass("hidden");
                        $("#MensajeVacioListArchivo").addClass("hidden");
                        $("#MensajeErrorListarListArchivo").addClass("hidden");
                        document.getElementById('btnSubirFormato').disabled = false;
                    }
                } else {

                }
                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {

                $("#CargaTemporal").addClass("hidden");
                $("#ContenedorTablaAdjuntos").removeClass("hidden");
                $("#ImagenCargaListArchivo").addClass("hidden");
                $("#MensajeErrorListArchivo").addClass("hidden");
                $("#MensajeVacioListArchivo").addClass("hidden");
                $("#MensajeErrorListarListArchivo").addClass("hidden");
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    };

    $("#btnSubirFormato").click(function () {

        var UserRegisterSave = "@User.Identity.Name.ToUpper().ToString()";
        UserRegisterSave = UserRegisterSave.split(',')[0];

            if (idsPathFileTicketDoc.length == 0) {
                if ($('#flArchivoSubirAdjunto').val() != "") {
                    var TamañoArchivo = $("#flArchivoSubirAdjunto")[0].files[0].size;
                    if (TamañoArchivo > 5000000) {
                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["error"](tValidacionExcedeTamanioArchivoError, tTituloError); $toastlast = $toast;
                        return;
                    }

                    //if (idsPathFileAnexoAct.length > 0) {
                    //    for (i = 0; i < $("#GrillaArchivos2").data("kendoGrid").dataSource.total(); i++) {
                    //        if ($("#GrillaArchivos2").data("kendoGrid").dataSource._data[i].FileNameRegister == $("#flArchivoSubirAdjunto")[0].files[0].name) {
                    //            toastr.options.timeOut = nTiempoMedio;
                    //            toastr.options.extendedTimeOut = nTiempoMedio;
                    //            /*success - info - warning - error*/
                    //            var $toast = toastr["error"](tMensajeErrorArchivoCargado, tTituloError); $toastlast = $toast;
                    //            return;
                    //        }
                    //    }
                    //}

                    //document.getElementById('btnSubirFormato').disabled = true;

                    Swal.fire({
                        title: 'Estas seguro de guardar este archivo?',
                        text: "Ya no podras revertirlo!",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Si, deseo guardar!'
                    }).then((result) => {
                        if (result.isConfirmed) {

                            if (UserRegisterSave == IdResponsibleCritizity) {

                                 SubirArchivo();

                            } else {

                                 Swal.fire({
                                     icon: 'error',
                                     title: 'Esta actividad no te pertenece',
                                     text: 'Solo el responsable de la actividad puede registrar!'
                                     //footer: '<a href="">Comunicarse con ?</a>'
                                 });

                            }

                        } else {



                        }
                    });

                } else {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tValidacionSeleccionaArchivoError, tTituloError); $toastlast = $toast;
                }
            }
            else {
                toastr.options.timeOut = nTiempoMedio;
                toastr.options.extendedTimeOut = nTiempoMedio;
                /*success - info - warning - error*/
                var $toast = toastr["error"]("Solo se puede ingresar " + "1 archivo.", tTituloError); $toastlast = $toast;
            }

        });

    function ListadoDetalleActividadInforme() {

        var dataSource = new kendo.data.DataSource({
            transport: {
                read: function (options) {
                    $.ajax({
                        type: "GET",
                        url: tRutaServidor + "/Activity/ListarInformeDetalleActivity", /* es importante poner los .. delante*/
                        data: {
                            IdActivity: idActivity,
                        },
                        dataType: "json",
                        /*async: false,*/
                        success: function (resultado) {
                            /*exitosamente*/
                            if (resultado.length > 0) {
                                /* proceso exitoso con datos*/
                                if (resultado[0].ValorConsulta == "1") {

                                    console.log(resultado);

                                    $("#GrillaArchivos").removeClass("hidden");
                                    $("#ImagenCargaListArchivo").addClass("hidden");
                                    $("#MensajeErrorListArchivo").addClass("hidden");
                                    $("#MensajeVacioListArchivo").addClass("hidden");
                                    $("#MensajeErrorListarListArchivo").addClass("hidden");

                                } else if (resultado[0].ValorConsulta == "-1") {

                                    $("#GrillaArchivos").addClass("hidden");
                                    $("#ImagenCargaListArchivo").addClass("hidden");
                                    $("#MensajeErrorListArchivo").removeClass("hidden");
                                    $("#MensajeVacioListArchivo").addClass("hidden");
                                    $("#MensajeErrorListarListArchivo").addClass("hidden");
                                }
                                else {
                                    /* proceso fallido catch listado datos*/
                                    $("#GrillaArchivos").addClass("hidden");
                                    $("#ImagenCargaListArchivo").addClass("hidden");
                                    $("#MensajeErrorListArchivo").addClass("hidden");
                                    $("#MensajeVacioListArchivo").addClass("hidden");
                                    $("#MensajeErrorListarListArchivo").removeClass("hidden");

                                    console.log(resultado);
                                }

                            } else {
                                $("#GrillaArchivos").addClass("hidden");
                                $("#ImagenCargaListArchivo").addClass("hidden");
                                $("#MensajeErrorListArchivo").addClass("hidden");
                                $("#MensajeVacioListArchivo").removeClass("hidden");
                                $("#MensajeErrorListarListArchivo").addClass("hidden");
                            }

                            options.success(resultado);
                            var grid = $("#GrillaArchivos").data("kendoGrid");
                            if (grid.dataSource.total() > 0) {
                                grid.setDataSource(dataSource);
                            }

                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            /*fallo al llamar a la funcion ajax*/
                            $("#GrillaArchivos").addClass("hidden");
                            $("#ImagenCargaListArchivo").addClass("hidden");
                            $("#MensajeErrorListArchivo").addClass("hidden");
                            $("#MensajeVacioListArchivo").addClass("hidden");
                            $("#MensajeErrorListarListArchivo").removeClass("hidden");

                            console.log("ERROR AJAX : " + ajaxOptions);
                            console.log("ERROR AJAX : " + thrownError);
                            console.log(xhr.responseText);
                            console.log(xhr);

                        }
                    });
                },
                parameterMap: function (data, operation) {
                    if (operation !== "read" && data.models) {
                        return JSON.stringify({ JSONparam: data.models });
                    }
                }
            },
            error: function (e) {
                alert("Status: " + e.status + "; Error message: " + e.errorThrown);
            },
            batch: false,
            pageSize: PaginationKendoGrid,
            schema: {
                model: {
                    fields: {
                        IdActivityDetail: { type: "number" },
                        TituloInforme: { type: "string" },
                        IdParaQuienInforme: { type: "number" },
                        NameParaQuienInforme: { type: "string" },
                        AsuntoInforme: { type: "string" },
                        OperacionNombre: { type: "string" },
                        FechaRegistroInforme: { type: "string" },
                        AntecedentesInforme: { type: "string" },
                        ConclusionesInforme: { type: "string" },
                        RecomendacionesInforme: { type: "string" },
                        FileNameRegister: { type: "string" },
                        PathFile: { type: "string" },
                        FileSize: { type: "string" },
                        //RegistrationUserName: { type: "string" },
                        TipoArchivo: { type: "string" },
                    }
                }
            },
            //aggregate: [
            //    {
            //        field: "TicketNumber",
            //        aggregate: "count"
            //    },
            //    {
            //        field: "FuelQuantity",
            //        aggregate: "sum"
            //    }
            //]
        });

        $("#GrillaArchivos").kendoGrid({
            dataSource: dataSource,
            sortable: true,
            pageable: true,
            columnMenu: true,
            columnMenu: {
                sortable: true,
                filterable: true,
                columns: true,
                messages: {
                    columns: KendoMsjColumnMenuColumns,
                    filter: KendoMsjColumnMenuFilter,
                    sortAscending: KendoMsjColumnMenuSortAscending,
                    sortDescending: KendoMsjColumnMenuSortDescending,
                    settings: KendoMsjSettings
                }
            },
            columnMenuInit: function (e) {
                var menu = e.container.find(".k-menu").data("kendoMenu");
                menu.bind("select", function (e) {
                    var EtiquetaInput = $(".k-animation-container > .k-menu-group > .k-item > .k-content > .k-filter-menu > .k-textbox :input");
                    EtiquetaInput.focus();
                });
            },
            groupable: false,
            reorderable: true,
            selectable: "row",
            scrollable: true,
            resizable: true,
            filterable: {
                multi: true,
                checkAll: true,
                search: true,
                messages: {
                    clear: KendoMsjClear,
                    filter: KendoMsjFilter,
                    selectedItemsFormat: KendoMsjSelectedItemsFormat,
                    checkAll: KendoMsjCheckAll,
                    search: KendoMsjSearch
                }
            },
            //groupable: {
            //    info: true,
            //    messages: {
            //        empty: "<b style='font-style:italic';>Arrastre una cabecera aquí para agrupar su información por esa columna</b>"
            //    }
            //},
            pageable: {
                messages: {
                    empty: KendoMsjEmpty,
                    page: kendoMsjPage,
                    of: KendoMsjOf,
                    itemsPerPage: KendoMsjItemsPerPage,
                    first: KendoMsjFirst,
                    last: KendoMsjLast,
                    next: KendoMsjNext,
                    previous: KendoMsjPrevious,
                    refresh: KendoMsjRefresh,
                    morePages: KendoMsjMorePages,
                    display: KendoMsjDisplay
                },
                refresh: false,
                pageSizes: true,
                pageSizes: [5, 10, 15],
                /*para la cantidad de paginas se sugieren 5*/
                buttonCount: 5,
                /*Posicion de la pagina*/
                pageSize: 5
            },
            excel: { fileName: "Listado de Acta de Reunión.xlsx", filterable: true, allPages: true },
            columns: [
                {
                    width: 100,
                    command: {
                        template:
                            "<button class='btn-grid btn-xs BtnEdit' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-edit'></i></button>" + " " +
                            "<button class='btn-grid btn-xs BtnDescargar' type='button' title='Ver datos'><i class='fa fa-lg fa-fw fas fa-cloud-download'></i></button>"
                            + " " + "<button class='btn-grid btn-xs BtnDelete' type='button' title='Ver datos'><i class='fa fa-trash-o fa-lg'></i></button>"
                    },
                    attributes: { "class": "text-center" },
                    title: ""
                },
                { field: "TituloInforme", title: "Titulo Informe", width: 140, attributes: { "class": "text-center" } },
                //{ field: "NameParaQuienInforme", title: "Para", width: 150, attributes: { "class": "text-center" } },
                //{ field: "AsuntoInforme", title: "Asunto", width: 120, attributes: { "class": "text-center" } },
                //{ field: "OperacionNombre", title: "Operación", width: 150, attributes: { "class": "text-center" } },
                //{ field: "FechaRegistroInforme", title: "Fecha Registro",  width: 150, attributes: { "class": "text-center" } },
                //{ field: "AntecedentesInforme", title: "Antecendete", width: 150, attributes: { "class": "text-center" } },
                //{ field: "ConclusionesInforme", title: "Conclusión", width: 120, attributes: { "class": "text-center" } },
                //{ field: "RecomendacionesInforme", title: "Recomendacione", width: 120, attributes: { "class": "text-center" } },
                //{ field: "FileNameRegister", title: "Nombre Archivo", width: 140, attributes: { "class": "text-center" } },
                //{ field: "FileSize", title: "Tamaño Archivo", width: 120, attributes: { "class": "text-center" } },
                //{ field: "RegistrationUserName", title: "Registrado Por", width: 120, attributes: { "class": "text-center" } },
                { field: "TipoArchivo", title: "TipoArchivo", hidden: true, width: 120, attributes: { "class": "text-center" } },

            ],
            dataBound: function () {

                //var Grilla = this;

                //Grilla.tbody.find("tr[role='row']").each(function () {
                //    var model = Grilla.dataItem(this);
                //    //var estadoOrden = model.bE_Purchase_Order.PurchaseOrderStatus;

                //    //if (estadoOrden == 'Z') {
                //    //    $(this).find("td > button.BtnRegistrar").remove();
                //    //}

                //    //if (model.BillingCompleted == 'Z') {
                //    //    $(this).find("td > button.BtnRegistrar").remove();
                //    //}
                //});


                //for (i = 0; i < Grilla.dataSource._view.length; i++) {
                //    var estadoActual = Grilla.tbody.children()[i].children[9].textContent;
                //    if (estadoActual == 'BAJA') {
                //        $($("#LstCreateTicket").data("kendoGrid").tbody.children()[i]).addClass('colorVerde');
                //    }
                //    else if (estadoActual == 'MEDIA') {
                //        $($("#LstCreateTicket").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                //    }
                //    else {
                //        $($("#LstCreateTicket").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                //    }
                //}

                //    for (i = 0; i < $("#LstCotizacion").data("kendoGrid").dataSource._view.length; i++) {
                //        var diasRestantes = $("#LstCotizacion").data("kendoGrid").tbody.children()[i].children[2].textContent;

                //        if (diasRestantes < 11) {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                //        }
                //        else if (diasRestantes > 10 && diasRestantes < 21) {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                //        }
                //        else if (diasRestantes > 20) {
                //          $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorAmarillo');
                //        }
                //        else {
                //            $($("#LstCotizacion").data("kendoGrid").tbody.children()[i]).addClass('colorRojo');
                //        }
                //    }

                //    var Grilla = this;
                //    Grilla.tbody.find("tr[role='row']").each(function () {
                //        var model = Grilla.dataItem(this);
                //        if (model.QuotationStatus != "C") {
                //            $(this).find("td > button.BtnVerInfo").remove();
                //        }

                //    });

            }
        });


    }

    $("#GrillaArchivos").delegate(".BtnEdit", "click", function (e) {

            var grid = $("#GrillaArchivos").data("kendoGrid");
            var myVar = grid.dataItem($(this).closest("tr"));

            var UserRegisterSave = "@User.Identity.Name.ToUpper().ToString()";
            UserRegisterSave = UserRegisterSave.split(',')[0];

            var TipoArchivo = "";
            var TituloInforme = "";
            //var ParaQuienInforme = "";
            var IdParaQuienInforme = 0;
            var AsuntoInforme = "";
            //var OperacionInforme = "";
            var FechaInforme = "";
            var AntecedentesInforme = "";
            var ConclusionesInforme = "";
            var ActivityInforme = "";
            var RecomendacionesInforme = "";

            Swal.fire({
                 title: 'Estas seguro de guardar los datos de este informe?',
                 text: "Estar seguro de lo que se registra!",
                 icon: 'warning',
                 showCancelButton: true,
                 confirmButtonColor: '#3085d6',
                 cancelButtonColor: '#d33',
                 confirmButtonText: 'Si, deseo guardar!'
            }).then((result) => {
                if (result.isConfirmed) {

                    if (UserRegisterSave == IdResponsibleCritizity) {

                        IdActivityDetail = myVar.IdActivityDetail;
                        TipoArchivo = myVar.TipoArchivo;
                        TituloInforme = myVar.TituloInforme;
                        AsuntoInforme = myVar.AsuntoInforme;
                        FechaInforme = myVar.FechaRegistroInforme;
                        AntecedentesInforme = myVar.AntecedentesInforme;
                        ConclusionesInforme = myVar.ConclusionesInforme;
                        ActivityInforme = myVar.ActivityDevelopInforme;
                        RecomendacionesInforme = myVar.RecomendacionesInforme;
                        IdParaQuienInforme = myVar.IdParaQuienInforme;

                        console.log(IdActivityDetail);

                        if (TipoArchivo == "INF") {

                            Swal.fire({
                                title: 'Estas seguro de mostrar el informe a editar?',
                                text: "Solo se puede editar informes generador por plataforma!",
                                icon: 'warning',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Si, deseo ver!'
                            }).then((result) => {
                                if (result.isConfirmed) {

                                    document.getElementById("txtTitleInforme").value = TituloInforme;
                                    document.getElementById("txtAsuntoInforme").value = AsuntoInforme;
                                    document.getElementById("txtFechaActividad").value = FechaInforme;
                                    document.getElementById("txtAntecedentesActividad").value = AntecedentesInforme;
                                    document.getElementById("txtConclusionesActividad").value = ConclusionesInforme;
                                    document.getElementById("txtRecomendacionesActividad").value = RecomendacionesInforme;
                                    document.getElementById("txtActivityDevelop").value = ActivityInforme;

                                    $("#txtParaQuienFormato").val(IdParaQuienInforme).change();

                                    $("#btnSaveInforme").addClass("hidden");
                                    $("#btnEditarInforme").removeClass("hidden");

                                } else {



                                }
                            });

                        } else if (TipoArchivo == "ACTV") {

                            toastr.options.timeOut = nTiempoCorto;
                            toastr.options.extendedTimeOut = nTiempoCorto;
                            /*success - info - warning - error*/
                            var $toast = toastr["error"]("No se puede Editar un Documento subido, solo informes generado por plataforma", tTituloError); $toastlast = $toast;
                            return;

                        }


                    }
                    else {

                        Swal.fire({
                           icon: 'error',
                           title: 'Esta actividad no te pertenece',
                           text: 'Solo el responsable de la actividad puede registrar!'
                           //footer: '<a href="">Comunicarse con ?</a>'
                       });

                    }

                } else {

                }
            });

        });

    $("#GrillaArchivos").delegate(".BtnDescargar", "click", function (e) {

        var grid = $("#GrillaArchivos").data("kendoGrid");
        var myVar = grid.dataItem($(this).closest("tr"));
        //idRutaArchivo = myVar.IdPathFile;

        var TipoArchivo = "";
        TipoArchivo = myVar.TipoArchivo;

        if (TipoArchivo == "INF") {

            var TituloInfo = "";
            var ParaQuienInfo = "";
            var AsuntoInfo = "";
            var OperacionInfo = "";
            var FechaRegistroInfo = "";
            var AntecedenteInfo = "";
            var ConclusionesInfo = "";
            var RecomendacionesInfo = "";
            var ActivityDevelop = "";

            TituloInfo = myVar.TituloInforme;
            ParaQuienInfo = myVar.NameParaQuienInforme;
            AsuntoInfo = myVar.AsuntoInforme;
            OperacionInfo = myVar.OperacionNombre;
            FechaRegistroInfo = myVar.FechaRegistroInforme;
            AntecedenteInfo = myVar.AntecedentesInforme;
            ConclusionesInfo = myVar.ConclusionesInforme;
            RecomendacionesInfo = myVar.RecomendacionesInforme;
            ActivityDevelop = myVar.ActivityDevelopInforme;
            //toastr.options.timeOut = nTiempoCorto;
            //toastr.options.extendedTimeOut = nTiempoCorto;
            ///*success - info - warning - error*/
            //var $toast = toastr["error"]("No se puede Descargar un informe generado por plataforma, solo archivos cargados", tTituloError); $toastlast = $toast;
            //return;

            DesgarcarPDFInforme(TituloInfo,ParaQuienInfo,AsuntoInfo,OperacionInfo,FechaRegistroInfo,AntecedenteInfo,ConclusionesInfo,RecomendacionesInfo,ActivityDevelop);

             //var options = {};

             //$('.cmd').click(function () {
               //var doc = new jsPDF();
               // doc.fromHTML(document.getElementById("ContenedorInforme"), // page element which you want to print as PDF
               // 15,
               // 15,
               // {
               //   'width': 170
               // },
               // function(a)
               //  {
               //   doc.save("HTML2PDF.pdf");
               // });

               //pdf.save('sample-file.pdf');
             //});

            //$('#ModalPDF').modal('show');
        } else if (TipoArchivo == "ACTV") {

             window.open(myVar.PathFile, '_blank');

        }


    });

    $("#GrillaArchivos").delegate(".BtnDelete", "click", function (e) {

        var grid = $("#GrillaArchivos").data("kendoGrid");
        var myVar = grid.dataItem($(this).closest("tr"));

        var IdActivityDetail = "";
        IdActivityDetail = myVar.IdActivityDetail;

        var UserRegisterSave = "@User.Identity.Name.ToUpper().ToString()";
        UserRegisterSave = UserRegisterSave.split(',')[0];


        Swal.fire({
            title: 'Estas seguro de eliminar este archivo?',
            text: "Ya no podras revertirlo!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, estoy seguro!'
        }).then((result) => {
            if (result.isConfirmed) {

                if (UserRegisterSave == IdResponsibleCritizity) {

                    EliminarActividadDetalle(IdActivityDetail);

                } else {

                    Swal.fire({
                       icon: 'error',
                       title: 'Esta actividad no te pertenece',
                       text: 'Solo el responsable de la actividad puede registrar!'
                       //footer: '<a href="">Comunicarse con ?</a>'
                    });

                }


            } else {

            }
        });

    });

    function EliminarActividadDetalle(ArchivoActivityDetalle) {

        $.ajax({
            type: "POST",
            url: tRutaServidor + "/Activity/EliminarActivityDetail",
            dataType: "json",
            data: {
                IdActivityDetail: ArchivoActivityDetalle,
            },
            success: function (resultado) {

                if (resultado.length > 0) {

                    if (resultado == '1') {

                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["success"](tMensajeEliminadoExito, tTituloExito); $toastlast = $toast;

                        ListadoDetalleActividadInforme();

                    } else {

                        toastr.options.timeOut = nTiempoMedio;
                        toastr.options.extendedTimeOut = nTiempoMedio;
                        /*success - info - warning - error*/
                        var $toast = toastr["warning"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                        return;
                    }

                } else if (resultado == 2) {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tValidacionNroCotizacionExiste, tTituloError); $toastlast = $toast;
                    document.getElementById('btnGrabar').disabled = false;

                } else if (resultado == 3) {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorActualizarRutas, tTituloError); $toastlast = $toast;
                    document.getElementById('btnGrabar').disabled = false;
                } else {
                    toastr.options.timeOut = nTiempoMedio;
                    toastr.options.extendedTimeOut = nTiempoMedio;
                    /*success - info - warning - error*/
                    var $toast = toastr["error"](tMensajeErrorDesconocido, tTituloError); $toastlast = $toast;
                    console.log("Mensaje del error : " + resultado);
                }
                $("#CargaTemporal").addClass("hidden");

            },
            error: function (xhr, ajaxOptions, thrownError) {
                /*fallo al llamar a la funcion ajax*/
                toastr.options.timeOut = nTiempoLargo;
                toastr.options.extendedTimeOut = nTiempoLargo;
                /*success - info - warning - error*/
                var $toast = toastr["error"](tMensajeErrorConexion, tTituloErrorConexion); $toastlast = $toast;
                console.log("ERROR AJAX : " + ajaxOptions);
                console.log("ERROR AJAX : " + thrownError);
                console.log(xhr.responseText);
                console.log(xhr);

            }
        });

    };

    $('input[type=radio][name=rdoRadioFilterStatusTicket]').change(function (e) {

        if (e.target.id == 'rdoPendiente') {

            StatusTicketRadio = 'P';

        } else if (e.target.id == 'rdoCompletado') {

            StatusTicketRadio = 'C';

        } else if (e.target.id == 'rdoAmbos') {

            StatusTicketRadio = 'B';
            
        }
    });


    $.validator.addMethod("regx", function (value, element, regexpr) {
            return regexpr.test(value);
        }, "");

 
    FormatoFechas();
    ComboResponsable();
    /*GrillaListado();*/
    ComboEncargadoAll2();
    ComboEncargadoInforme("1");
    listadoTicketYResponsable("1");
    ListadoTablaTicketYResponsable('P', '0');

</script>
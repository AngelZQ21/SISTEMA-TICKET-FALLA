CREATE PROCEDURE [dbo].[SPR_LUBRICANT_GENERAL_CONSUMPTION]        
@StartDate VARCHAR(10),          
@EndDate VARCHAR(10),          
@IdStation VARCHAR(MAX),          
@IdCompany VARCHAR(MAX),        
@IdArea VARCHAR(MAX),        
@IdCosteCenter VARCHAR(MAX),        
@IdProduct VARCHAR(MAX),        
-------------------------        
@TicketNumber VARCHAR(MAX)        
--@QueryValue  CHAR(1) --1: LISTADO SÓLO CON FILTRO DE FECHA, 2: LISTADO CON FILTRO DE ESTACIÓN Y TICKET          
AS          
/*============================================ SEPARAR DATOS*/        
        
DECLARE @SEPARADORPRINCIPAL VARCHAR(10) = ','            
        
--============================================ ESTACION        
        
DECLARE @StationTable AS TABLE            
(            
V1 INT            
)         
        
DECLARE @StationLENG INT = LEN(@IdStation)            
DECLARE @StationSUBS VARCHAR(100)          
        
IF(@IdStation != '0')            
    BEGIN            
    ---            
    WHILE (@StationLENG >0)            
     BEGIN            
     ---            
     --PRINT ('==============INICIO ==========')            
     DECLARE @StationA INT = CHARINDEX(@SEPARADORPRINCIPAL, @IdStation)            
     --PRINT CONCAT('CHARINDEX : ', @A)            
     --PRINT CONCAT('TAMAÑO INICIAL: ', @LENG)            
     IF(@StationA > 0)            
      BEGIN            
      ---            
      SET @StationSUBS = SUBSTRING(@IdStation,1,@StationA)            
      --PRINT CONCAT('SUBS IF: ', @SUBS)            
      ----------------------            
      DECLARE @StationSUBSTEMP VARCHAR(100) = REPLACE(@StationSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMP)            
      ----------------------            
      INSERT INTO @StationTable            
      SELECT @StationSUBSTEMP           
      ----------------------            
      --SET @IdVehicle = REPLACE(@IdVehicle,@SUBS,'')            
      SET @IdStation = SUBSTRING(@IdStation,(@StationA+1),LEN(@IdStation))            
      SET @StationLENG = LEN(@IdStation)            
      --PRINT CONCAT('CADENA NUEVA IF: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO IF: ', @LENG)            
      ---            
      END            
     ELSE            
      BEGIN            
      ---            
      SET @StationSUBS = SUBSTRING(@IdStation,1,LEN(@IdStation))            
      --PRINT CONCAT('SUBS ELSE: ', @SUBS)            
      ----------------------            
      DECLARE @StationSUBSTEMPX VARCHAR(100) = REPLACE(@StationSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMPX)            
      ----------------------            
      INSERT INTO @StationTable           
      SELECT @StationSUBSTEMPX            
      ----------------------            
      SET @IdStation = ''            
      SET @StationLENG = LEN(@IdStation)            
      --PRINT CONCAT('CADENA NUEVA ELSE: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO ELSE: ', @LENG)            
      ---            
      END            
               
                 
    ---            
    END            
    ---            
    END           
--============================================ COMPAÑIA        
        
DECLARE @CompanyTable AS TABLE            
(            
V1 INT           
)         
        
DECLARE @CompanyLENG INT = LEN(@IdCompany)            
DECLARE @CompanySUBS VARCHAR(100)          
        
IF(@IdCompany != '0')            
    BEGIN            
    ---            
    WHILE (@CompanyLENG >0)            
     BEGIN            
     ---            
     --PRINT ('==============INICIO ==========')            
     DECLARE @CompanyA INT = CHARINDEX(@SEPARADORPRINCIPAL, @IdCompany)            
     --PRINT CONCAT('CHARINDEX : ', @A)            
     --PRINT CONCAT('TAMAÑO INICIAL: ', @LENG)            
     IF(@CompanyA > 0)            
      BEGIN            
      ---            
      SET @CompanySUBS = SUBSTRING(@IdCompany,1,@CompanyA)            
      --PRINT CONCAT('SUBS IF: ', @SUBS)            
      ----------------------            
      DECLARE @CompanySUBSTEMP VARCHAR(100) = REPLACE(@CompanySUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMP)            
      ----------------------            
      INSERT INTO @CompanyTable            
      SELECT @CompanySUBSTEMP        
      ----------------------            
      --SET @IdVehicle = REPLACE(@IdVehicle,@SUBS,'')         
      SET @IdCompany = SUBSTRING(@IdCompany,(@CompanyA+1),LEN(@IdCompany))            
      SET @CompanyLENG = LEN(@IdCompany)            
      --PRINT CONCAT('CADENA NUEVA IF: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO IF: ', @LENG)            
      ---            
      END            
     ELSE            
      BEGIN            
      ---            
      SET @CompanySUBS = SUBSTRING(@IdCompany,1,LEN(@IdCompany))            
      --PRINT CONCAT('SUBS ELSE: ', @SUBS)            
      ----------------------            
      DECLARE @CompanySUBSTEMPX VARCHAR(100) = REPLACE(@CompanySUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMPX)            
      ----------------------            
      INSERT INTO @CompanyTable           
      SELECT @CompanySUBSTEMPX        
      ----------------------            
      SET @IdCompany = ''            
      SET @CompanyLENG = LEN(@IdCompany)            
      --PRINT CONCAT('CADENA NUEVA ELSE: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO ELSE: ', @LENG)            
      ---            
      END            
               
                 
    ---            
    END            
    ---            
    END         
        
--============================================ AREA        
        
DECLARE @AreaTable AS TABLE            
(            
V1 INT            
)         
        
DECLARE @AreaLENG INT = LEN(@IdArea)            
DECLARE @AreaSUBS VARCHAR(100)          
        
IF(@IdArea != '0')            
    BEGIN            
    ---            
    WHILE (@AreaLENG >0)            
     BEGIN            
     ---            
     --PRINT ('==============INICIO ==========')            
     DECLARE @AreaA INT = CHARINDEX(@SEPARADORPRINCIPAL, @IdArea)            
     --PRINT CONCAT('CHARINDEX : ', @A)            
     --PRINT CONCAT('TAMAÑO INICIAL: ', @LENG)            
     IF(@AreaA > 0)            
      BEGIN            
      ---            
      SET @AreaSUBS = SUBSTRING(@IdArea,1,@AreaA)            
      --PRINT CONCAT('SUBS IF: ', @SUBS)            
      ----------------------            
      DECLARE @AreaSUBSTEMP VARCHAR(100) = REPLACE(@AreaSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMP)            
      ----------------------            
      INSERT INTO @AreaTable            
      SELECT @AreaSUBSTEMP        
      ----------------------            
      --SET @IdVehicle = REPLACE(@IdVehicle,@SUBS,'')            
      SET @IdArea = SUBSTRING(@IdArea,(@AreaA+1),LEN(@IdArea))            
      SET @AreaLENG = LEN(@IdArea)            
      --PRINT CONCAT('CADENA NUEVA IF: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO IF: ', @LENG)            
      ---            
      END            
     ELSE            
      BEGIN            
      ---            
      SET @AreaSUBS = SUBSTRING(@IdArea,1,LEN(@IdArea))            
      --PRINT CONCAT('SUBS ELSE: ', @SUBS)            
      ----------------------            
      DECLARE @AreaSUBSTEMPX VARCHAR(100) = REPLACE(@AreaSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMPX)            
      ----------------------            
      INSERT INTO @AreaTable           
      SELECT @AreaSUBSTEMPX        
      ----------------------            
      SET @IdArea = ''            
      SET @AreaLENG = LEN(@IdArea)            
      --PRINT CONCAT('CADENA NUEVA ELSE: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO ELSE: ', @LENG)            
      ---            
      END            
               
                 
    ---            
    END            
    ---            
    END         
        
--============================================ CENTRO COSTO        
        
DECLARE @CentroCostoTable AS TABLE            
(            
V1 INT           
)         
        
DECLARE @CosteCenterLENG INT = LEN(@IdCosteCenter)            
DECLARE @CosteCenterSUBS VARCHAR(100)         
        
IF(@IdCosteCenter != '0')      
    BEGIN            
    ---            
    WHILE (@CosteCenterLENG >0)            
     BEGIN            
     ---            
     --PRINT ('==============INICIO ==========')            
     DECLARE @CosteCenterA INT = CHARINDEX(@SEPARADORPRINCIPAL, @IdCosteCenter)            
     --PRINT CONCAT('CHARINDEX : ', @A)            
     --PRINT CONCAT('TAMAÑO INICIAL: ', @LENG)            
     IF(@CosteCenterA > 0)            
      BEGIN            
      ---            
      SET @CosteCenterSUBS = SUBSTRING(@IdCosteCenter,1,@CosteCenterA)            
      --PRINT CONCAT('SUBS IF: ', @SUBS)            
      ----------------------            
      DECLARE @CosteCenterSUBSTEMP VARCHAR(100) = REPLACE(@CosteCenterSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMP)            
      ----------------------            
      INSERT INTO @CentroCostoTable            
      SELECT @CosteCenterSUBSTEMP        
      ----------------------            
      --SET @IdVehicle = REPLACE(@IdVehicle,@SUBS,'')            
      SET @IdCosteCenter = SUBSTRING(@IdCosteCenter,(@CosteCenterA+1),LEN(@IdCosteCenter))            
      SET @CosteCenterLENG = LEN(@IdCosteCenter)            
      --PRINT CONCAT('CADENA NUEVA IF: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO IF: ', @LENG)            
      ---            
      END            
     ELSE            
      BEGIN            
      ---            
      SET @CosteCenterSUBS = SUBSTRING(@IdCosteCenter,1,LEN(@IdCosteCenter))            
      --PRINT CONCAT('SUBS ELSE: ', @SUBS)            
      ----------------------            
      DECLARE @CosteCenterSUBSTEMPX VARCHAR(100) = REPLACE(@CosteCenterSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMPX)            
      ----------------------            
      INSERT INTO @CentroCostoTable          
      SELECT @CosteCenterSUBSTEMPX        
      ----------------------            
      SET @IdCosteCenter = ''            
      SET @CosteCenterLENG = LEN(@IdCosteCenter)            
      --PRINT CONCAT('CADENA NUEVA ELSE: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO ELSE: ', @LENG)            
      ---            
      END            
               
                 
    ---            
    END            
    ---            
    END         
--============================================ PRODUCTO        
        
DECLARE @ProductTable AS TABLE            
(            
V1 INT            
)         
        
DECLARE @ProductLENG INT = LEN(@IdProduct)            
DECLARE @ProductSUBS VARCHAR(100)        
        
IF(@IdProduct != '0')            
    BEGIN            
    ---            
    WHILE (@ProductLENG >0)            
     BEGIN            
     ---            
     --PRINT ('==============INICIO ==========')            
     DECLARE @ProductA INT = CHARINDEX(@SEPARADORPRINCIPAL, @IdProduct)            
     --PRINT CONCAT('CHARINDEX : ', @A)            
     --PRINT CONCAT('TAMAÑO INICIAL: ', @LENG)            
     IF(@ProductA > 0)            
      BEGIN            
      ---            
      SET @ProductSUBS = SUBSTRING(@IdProduct,1,@ProductA)            
      --PRINT CONCAT('SUBS IF: ', @SUBS)            
      ----------------------            
      DECLARE @ProductSUBSTEMP VARCHAR(100) = REPLACE(@ProductSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMP)            
      ----------------------            
      INSERT INTO @ProductTable            
      SELECT @ProductSUBSTEMP        
      ----------------------       
      --SET @IdVehicle = REPLACE(@IdVehicle,@SUBS,'')            
      SET @IdProduct = SUBSTRING(@IdProduct,(@ProductA+1),LEN(@IdProduct))            
      SET @ProductLENG = LEN(@IdProduct)            
      --PRINT CONCAT('CADENA NUEVA IF: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO IF: ', @LENG)            
      ---            
      END            
     ELSE            
      BEGIN            
      ---            
      SET @ProductSUBS = SUBSTRING(@IdProduct,1,LEN(@IdProduct))            
      --PRINT CONCAT('SUBS ELSE: ', @SUBS)            
      ----------------------            
      DECLARE @ProductSUBSTEMPX VARCHAR(100) = REPLACE(@ProductSUBS,@SEPARADORPRINCIPAL,'')            
      --PRINT CONCAT('@SUBSTEMP: ', @SUBSTEMPX)            
      ----------------------            
      INSERT INTO @ProductTable         
      SELECT @ProductSUBSTEMPX        
      ----------------------            
      SET @IdProduct = ''            
      SET @ProductLENG = LEN(@IdProduct)            
      --PRINT CONCAT('CADENA NUEVA ELSE: ', @IdVehicle)            
      --PRINT CONCAT('TAMAÑO NUEVO ELSE: ', @LENG)            
      ---            
      END            
               
                 
    ---            
    END            
    ---            
    END         
        
--================================================ TICKET        
        
DECLARE @TicketNumberS INT = CONVERT(INT,@TicketNumber)         
--------=======================================        
        
--================================================        
SET LANGUAGE spanish          
SET DATEFORMAT dmy          
DECLARE @RowCount INT, @MaxRowCount INT          
SET @MaxRowCount = (SELECT TOP 1 MaxRowsReport FROM TB_CONFIGURATION)  -- RESULTADO DE EL -- MaxRowsReport = 15000        
        
          
DECLARE @Result VARCHAR(500)          
SET @Result=0          
BEGIN          
 SET @RowCount = (SELECT COUNT(*) FROM           
       VW_LUBRICANT_TRANSACTION TR          
    WHERE TR.StartDateTransaction >= @StartDate + ' 00:00:00' AND TR.StartDateTransaction <= @EndDate + ' 23:59:59'           
    AND TR.RegistrationStatus != 'D')          
             
   IF(@RowCount >@MaxRowCount)          
     BEGIN       
       ---          
       /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
    SELECT 0 AS 'IdTransaction', 0 AS 'TicketNumber', '' AS 'ManualTicketNumber', '01/01/2000' AS 'StartDateTransaction', '01/01/2000' AS 'EndDateTransaction',           
    '' AS 'StartDateTransactionString','' AS 'EndDateTransactionString','' AS 'StartOnlyDateTransaction','' AS 'EndOnlyDateTransaction','' AS 'StartOnlyTimeTransaction',          
    '' AS 'EndOnlyTimeTransaction','' AS 'TransactionType', '' AS 'TransactionTypeDescription', '' AS 'DispatchType', '' AS 'DispatchTypeDescription',           
    0 AS 'lubricantQuantity',0 AS 'CorrectionFactor',0 AS 'API', 0 AS 'ConverterQuantity', 0 AS 'LubricantTemperature', '' AS 'OperationName', 0 AS 'GPM', '' AS 'SupplyingTime', '' AS 'NozzleId', '' AS 'ERPMigrationStatus','' AS 'VidId',0 AS 'KeyTime',  
  
    
      
         
    0 AS 'WorkShiftId', '' AS 'ShiftName', 0 AS 'ShiftNumber','' AS 'MonthValueTransaction', '' AS 'YearValueTransaction', '' AS 'MonthValueNumberTransaction',           
    '' AS 'VehicleKey', '' AS 'VehicleCodeEmbedded',0 AS 'IdLot', '' AS 'LotName', '' AS 'DebugTransactionComment',          
    '' AS 'RegistrationStatus', '' AS 'MigrationStatus', 0 AS 'RegistrationUser', '' AS 'RegistrationDate', 0 AS 'UpdateUser', '' AS 'UpdateDate',          
    '' AS 'RegistrationUserString',0 AS 'UpdateUserString','' AS 'RegistrationDateString','' AS 'UpdateDateString','' AS 'RegistrationStatusString',          
    0 AS 'lubricantPriceByQuantity', 0 AS 'ProductPrice',          
    '' AS 'TransactionComment', '' AS 'TransactionComment2', '' AS 'TransactionComment3', '' AS 'AndroidDevice', '' AS 'Origin',          
    /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
    0 AS 'IdCompartmentMantenanceType', '' AS 'CompartmentMantenanceTypeName',          
    /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
    0 AS 'VehicleId','' AS 'VehicleCodePlate','' AS 'VehicleExternalCodeA','' AS 'VehicleExternalCodeB','' AS 'TR.VehicleDescription',           
    '' AS 'VehicleIdDevice', 0 AS 'VehicleKilometer', 0 AS 'VehicleHorometer', '' AS 'VehicleStartDate', '' AS 'VehicleExpiryDate',          
    '' AS 'VehicleOwnFlag',          
    /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
    0 AS 'FleetId', '' AS 'FleetName', '' AS 'FleetType',          
    /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
    0 AS 'VehicleTypeId', '' AS 'VehicleTypeName', 0 AS 'MarkId', '' AS 'MarkName', 0 AS 'ModelId', '' AS 'ModelName', 0 AS 'CompartmentId', '' AS 'CompartmentName',          
    '' AS 'PerformanceType', '' AS 'PerformanceTypeDescription',           
    /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
    0 AS 'CompanyId', '' AS 'CompanyRUC', '' AS 'BusinessName', '' AS 'VendorCode', '' AS 'CompanyType', '' AS 'CompanyTypeDescription',           
    0 AS 'SponsorId', '' AS 'SponsorRUC', '' AS 'SponsorBusinessName', '' AS 'SponsorVendorCode', 0 AS 'IdAgreement', '' AS 'AgreementCode', '' AS 'AgreementDescription',          
    0 AS 'IdServiceOrder', '' AS 'ServiceOrderCode', '' AS 'ServiceOrderDescription',          
    /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
    0 AS 'CosteCenterId', '' AS 'CosteCenterCode','' AS 'CosteCenterDescription', 0 AS 'AreaId', '' AS 'AreaName', '' AS 'AreaCode',          
    /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
    0 AS 'DriverId', '' AS 'DriverKey', '' AS 'DriverFullName', 0 AS 'DriverDocumentId', '' AS 'DriverDocumentDescription', '' AS 'DriverPhotocheck',          
    '' AS 'DriverDocumentNumber', '' AS 'DriverLicense', 0 AS 'OperatorId', '' AS 'OperatorKey', '' AS 'OperatorFullName', '' AS 'OperatorDocumentId', '' AS 'OperatorDocumentDescription',           
    '' AS 'OperatorDocumentNumber', '' AS 'OperatorPhotocheck',          
    /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
    0 AS 'OperatorIdInSession', '' AS 'OperatorKeyInSession', '' AS 'OperatorFullNameInSession', 0 AS 'OperatorDocumentIdInSession', '' AS 'OperatorDocumentDescriptionInSession',          
    '' AS 'OperatorDocumentNumberInSession', '' AS 'OperatorPhotocheckInSession',          
    /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
    0 AS 'StationId', '' AS 'StationCode', '' AS 'StationName', '' AS 'StationTypeId', '' AS 'StationTypeDescription', '' AS 'StationTypeServiceId', '' AS 'StationTypeService', 0 AS 'TankId', '' AS 'TankCode',           
    '' AS 'TankName', 0 AS 'ContometerId', '' AS 'Contometer', 0 AS 'HoseId', '' AS 'HoseName', 0 AS 'HoseNumber', 0 AS 'ProductId', '' AS 'ProductName', 0 AS 'ProductNumber', '' AS 'ProductType',          
    '' AS 'MeasurementUnit', '' AS 'ElipseCode',          
    '-1' AS 'ValorConsulta'          
       ---          
     END         
  ELSE        
    BEGIN        
       --- TODOS EN TOTAL         
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,    
   TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction    
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.StationId IN (SELECT IdStation FROM TB_STATION)         
            AND TR.RegistrationStatus != 'D'        
            AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
            AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
            AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
            AND TR.ProductId IN (SELECT IdProduct FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       -----TODOS SELECCIONADOS         
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND  @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction         
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    -----STATION -COMPANY - AREA - CENTRO COSTO - TICKET - 1        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.RegistrationStatus != 'D'        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END           
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction       
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END          
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
        FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction            
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.RegistrationStatus != 'D'        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END         
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
  /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
/*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction         
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    -----STATION - 2        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,                       TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
            -- AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
           ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,         
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   AND TR.StationId IN (SELECT IdStation FROM TB_STATION)         
            --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND  @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
           TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
    /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,         
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END            
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND  @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
         TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         -- AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND  @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
   -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
            -- AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   -- AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       -----COMPANY - 2        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
        TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction         
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction         
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         -- AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
           /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
            -- AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       -----AREA - 2           
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
    TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
      /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            --AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            -- AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
       -- AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
   TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   -- AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   -- AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
   ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END            
       -----CENTRO DE COSTO - 2        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber= '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber!= '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,                    TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   -- AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    -----PRODUCTO - 2        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber!= '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         -- AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
            -- AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    -----TICKET - 2        
    -------------------        
    -----STATION - 3        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,          
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
            --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       -----COMPANY - 3        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND  @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction         
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'      
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND  @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
    /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
       AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       -----AREA - 3        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
   TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
            -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   -- AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
    AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   -- AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)          
            -- AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    ------COSTECENTER - 3        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --         AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)          
   --         AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END           
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
        /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.StationId IN (SELECT * FROM @StationTable)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    ---        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,       
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
         --AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   AND TR.StationId IN (SELECT * FROM @StationTable)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END               
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,    
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,                    TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   --      AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END          
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
   --      AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
   --      AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
        TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)         
   --AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    --TICKET -----        
    --------------------        
    ---STATION 4        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND  @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)          
            AND TR.TicketNumber = @TicketNumberS        
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   --AND TR.CosteCenterId IN (SELECT CosteCenterId FROM TB_COST_CENTER)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END            
    ----        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,                 TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.CompanyId IN (SELECT CompanyId FROM TB_COMPANY)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.AreaId IN (SELECT AreaId FROM TB_AREA)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
           TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
   FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT StationId FROM TB_STATION)        
   --AND TR.ProductId IN (SELECT ProductId FROM TB_PRODUCT)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
       --        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,         
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            --AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
 TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'           
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
         --AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         --AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         --AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
      /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.TicketNumber = @TicketNumberS          
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         --AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
         --AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   AND TR.StationId IN (SELECT * FROM @StationTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,    
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'    
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT IdStation FROM TB_STATION)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
         --AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT IdStation FROM TB_STATION)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS          
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
         --AND TR.CompanyId IN (SELECT IdCompany FROM TB_COMPANY)        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   --AND TR.StationId IN (SELECT IdStation FROM TB_STATION)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
   AND TR.TicketNumber = @TicketNumberS          
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
  ---STATION 5 -> BIEN        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber = '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,         
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct = '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
             TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
   AND TR.TicketNumber = @TicketNumberS          
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter = '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
  TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
 TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
   AND TR.TicketNumber = @TicketNumberS          
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
   AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany != '0' AND @IdArea = '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
/*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
           TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
   AND TR.TicketNumber = @TicketNumberS          
         AND TR.CosteCenterId IN (SELECT * FROM @CentroCostoTable)        
   AND TR.CompanyId IN (SELECT * FROM @CompanyTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation != '0' AND @IdCompany = '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction       
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
         AND TR.StationId IN (SELECT * FROM @StationTable)        
            AND TR.RegistrationStatus != 'D'        
   AND TR.TicketNumber = @TicketNumberS          
         AND TR.AreaId IN (SELECT * FROM @AreaTable)        
         AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
    IF(@IdStation = '0' AND @IdCompany != '0' AND @IdArea != '0' AND @IdCosteCenter != '0' AND @IdProduct != '0' AND @TicketNumber != '0')        
    BEGIN        
      SELECT          
            /*---------------------------------TRANSACCIÓN------------------------------------------------------------------------------------*/          
            TR.IdTransaction, TR.TicketNumber, TR.ManualTicketNumber, TR.StartDateTransaction, TR.EndDateTransaction,           
            TR.StartDateTransactionString,TR.EndDateTransactionString,TR.StartOnlyDateTransaction,TR.EndOnlyDateTransaction,TR.StartOnlyTimeTransaction,          
            TR.EndOnlyTimeTransaction,TR.TransactionType, TR.TransactionTypeDescription, TR.DispatchType, TR.DispatchTypeDescription,           
            TR.lubricantQuantity,TR.CorrectionFactor,TR.API, TR.ConverterQuantity, TR.LubricantTemperature, TR.OperationName, TR.GPM, TR.SupplyingTime, TR.NozzleId, TR.ERPMigrationStatus,TR.VidId,TR.KeyTime,           
            TR.WorkShiftId, TR.ShiftName, TR.ShiftNumber,TR.MonthValueTransaction, TR.YearValueTransaction, TR.MonthValueNumberTransaction,           
            TR.VehicleKey, TR.VehicleCodeEmbedded,TR.IdLot, TR.LotName, TR.DebugTransactionComment,          
            TR.RegistrationStatus, TR.MigrationStatus, TR.RegistrationUser, TR.RegistrationDate, TR.UpdateUser, TR.UpdateDate,          
            TR.RegistrationUserString,TR.UpdateUserString,TR.RegistrationDateString,TR.UpdateDateString,TR.RegistrationStatusString,          
            TR.lubricantPriceByQuantity, TR.ProductPrice,          
            TR.TransactionComment, TR.TransactionComment2, TR.TransactionComment3,TR.AndroidDevice, TR.Origin,          
            /*----------------------------------TIPO MANTENIMIENTO-----------------------------------------------------------------------------------*/          
            TR.IdCompartmentMantenanceType, TR.CompartmentMantenanceTypeName,          
            /*----------------------------------VEHÍCULO-----------------------------------------------------------------------------------*/          
            TR.VehicleId,TR.VehicleCodePlate,TR.VehicleExternalCodeA,TR.VehicleExternalCodeB,TR.VehicleDescription,           
            TR.VehicleIdDevice, TR.VehicleKilometer, TR.VehicleHorometer, TR.VehicleStartDate, TR.VehicleExpiryDate,          
            TR.VehicleOwnFlag,          
            /*-----------------------------------FLOTA----------------------------------------------------------------------------------*/          
            TR.FleetId, TR.FleetName, TR.FleetType,          
            /*-----------------------------------TIPO/MARCA/MODELO----------------------------------------------------------------------------------*/          
            TR.VehicleTypeId, TR.VehicleTypeName, TR.MarkId, TR.MarkName, TR.ModelId, TR.ModelName, TR.CompartmentId, TR.CompartmentName,          
            TR.PerformanceType, TR.PerformanceTypeDescription,           
            /*-----------------------------------COMPAÑÍA/PATROCINADOR/CONTRATO/ORDEN_SERVICIO----------------------------------------------------------------------------------*/          
            TR.CompanyId, TR.CompanyRUC, TR.BusinessName, TR.VendorCode, TR.CompanyType, TR.CompanyTypeDescription,           
            /*-----------------------------------ÁREA/CC/PEP/ORDEN----------------------------------------------------------------------------------*/          
            TR.CosteCenterId, TR.CosteCenterCode,TR.CosteCenterDescription, TR.AreaId, TR.AreaName, TR.AreaCode,          
            /*-----------------------------------DRIVER/OPERADOR----------------------------------------------------------------------------------*/          
            TR.DriverId, TR.DriverKey, TR.DriverFullName, TR.DriverDocumentId, TR.DriverDocumentDescription, TR.DriverPhotocheck,          
            TR.DriverDocumentNumber, TR.DriverLicense, TR.OperatorId, TR.OperatorKey, TR.OperatorFullName, TR.OperatorDocumentId, TR.OperatorDocumentDescription,           
            TR.OperatorDocumentNumber, TR.OperatorPhotocheck,          
            /*-----------------------------------OPERADOR EN SESIÓN----------------------------------------------------------------------------------*/          
            TR.OperatorIdInSession, TR.OperatorKeyInSession, TR.OperatorFullNameInSession, TR.OperatorDocumentIdInSession, TR.OperatorDocumentDescriptionInSession,          
            TR.OperatorDocumentNumberInSession, TR.OperatorPhotocheckInSession,          
            /*-----------------------------------ESTACIÓN/TANQUE/CONTÓMETRO/MANGUERA/PRODUCTO----------------------------------------------------------------------------------*/          
            TR.StationId, TR.StationCode, TR.StationName, TR.StationTypeId, TR.StationTypeDescription, TR.StationTypeServiceId, TR.StationTypeService, TR.TankId, TR.TankCode,           
            TR.TankName, TR.ContometerId, TR.Contometer, TR.HoseId, TR.HoseName, TR.HoseNumber, TR.ProductId, TR.ProductName, TR.ProductNumber, TR.ProductType,           
            TR.MeasurementUnit, TR.ElipseCode,          
            TTR.Turno,    
   ISNULL(TTR.Reason, '') as 'Reason',         
            ISNULL(TTR.PlanPNP, '') as 'PlanPNP',        
            ISNULL(TTR.CodProduct,'') as 'CodProduct',    
   ISNULL(TTR.CodeSAP,'') as 'CodeSAP',        
            '1' AS 'ValorConsulta'          
            FROM  VW_LUBRICANT_TRANSACTION TR INNER JOIN TB_TRANSACTION TTR ON TR.IdTransaction = TTR.IdTransaction          
            WHERE TR.StartDateTransaction >= +@StartDate+ + ' 00:00:00'            
            AND TR.StartDateTransaction <= +@EndDate+ + ' 23:59:59'         
            AND TR.RegistrationStatus != 'D'        
   AND TR.TicketNumber = @TicketNumberS          
         AND TR.AreaId IN (SELECT IdArea FROM TB_AREA)        
         AND TR.CosteCenterId IN (SELECT IdCosteCenter FROM TB_COST_CENTER)        
   AND TR.CompanyId IN (SELECT *FROM @CompanyTable)        
   AND TR.ProductId IN (SELECT * FROM @ProductTable)        
            ORDER BY TR.StationName DESC, TR.TicketNumber DESC         
    END        
   END        
END      